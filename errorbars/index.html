<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lovely Error Bars · NeXLSpectrum.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
<script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js" type="text/javascript" defer="defer"></script>
<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
</head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">NeXLSpectrum.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../spectrum/">Spectrum Methods</a></li><li><a class="tocitem" href="../k412refs/">Fitting K412 (simple API)</a></li><li><a class="tocitem" href="../K412fit/">Fitting K412 (flexible API)</a></li><li><a class="tocitem" href="../K412quick/">Fitting K412 (quick fit)</a></li><li><a class="tocitem" href="../XRFspectra/">Fitting XRF Spectra</a></li><li class="is-active"><a class="tocitem" href>Lovely Error Bars</a></li><li><a class="tocitem" href="../continuummodel/">Modeling the Continuum</a></li><li><a class="tocitem" href="../methods/">Methods</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Lovely Error Bars</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lovely Error Bars</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/master/docs/src/errorbars.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h3 id="How-good-are-the-fit-uncertainty-estimates?"><a class="docs-heading-anchor" href="#How-good-are-the-fit-uncertainty-estimates?">How good are the fit uncertainty estimates?</a><a id="How-good-are-the-fit-uncertainty-estimates?-1"></a><a class="docs-heading-anchor-permalink" href="#How-good-are-the-fit-uncertainty-estimates?" title="Permalink"></a></h3><p>This document looks at two different sets of measured spectra to evaluate how well, the estimated fit uncertainties match the observed uncertainties.  We are using two materials known to be highly homogeneous - K412 and ADM-6006a glasses.  To produce a set of spectra that differ only in count statistics, we will subdivide a spectrum into 100 spectra with an effective live-time of 0.01 of the original spectrum livetime.  We expect that we should be able to compare the &quot;fit-predicted&quot; uncertainties with the &quot;observed distribution&quot; of measured values.</p><p>To be clear:</p><ul><li>&quot;fit-predicted&quot; - Comes from the covariance matrix output from the linear least squares fit</li><li>&quot;observed distribution&quot; - Calculated as the standard-deviation of the 100 fit values.</li></ul><p>We want the ratio of the (observed distribution) / (fit predicted) to be unity or close.  We will call this ratio the &quot;heterogeneity&quot; (or &quot;hetero&quot; in the fourth column of the <code>describe(....)</code> table.)</p><p>We then repeat the process on the multiple measured unknown spectra. (4 for K412 and 15 for ADM-6005a)  We expect the heterogeneity to be one or larger - larger than unity when the sample is not perfectly homogeneous.</p><pre><code class="language-julia hljs">using NeXLSpectrum              # Provides spectrum reading and fitting tools
using NeXLMatrixCorrection      # Provides `quant` to convert k-ratios to mass fraction.
using DataFrames                # Tables
using Latexify
using BenchmarkTools</code></pre><h6 id="K412"><a class="docs-heading-anchor" href="#K412">K412</a><a id="K412-1"></a><a class="docs-heading-anchor-permalink" href="#K412" title="Permalink"></a></h6><p>Load the spectra, define the fit model and apply it.</p><pre><code class="language-julia hljs">path = joinpath(@__DIR__,&quot;K412 spectra&quot;)
unks = map(0:4) do i 
  loadspectrum(joinpath(path, &quot;III-E K412[$i][4].msa&quot;))
end
det = matching(unks[1], 132.0, 10)
frs = references( [
  reference(n&quot;Al&quot;, joinpath(path, &quot;Al2O3 std.msa&quot;), mat&quot;Al2O3&quot;),
  reference(n&quot;Mg&quot;, joinpath(path, &quot;MgO std.msa&quot;), mat&quot;MgO&quot;),
  reference(n&quot;Fe&quot;, joinpath(path, &quot;Fe std.msa&quot;), mat&quot;Fe&quot;),
  reference(n&quot;Si&quot;, joinpath(path, &quot;SiO2 std.msa&quot;), mat&quot;SiO2&quot;),
  reference(n&quot;O&quot;, joinpath(path, &quot;SiO2 std.msa&quot;), mat&quot;SiO2&quot;),
  reference(n&quot;Ca&quot;, joinpath(path, &quot;CaF2 std.msa&quot;) ,mat&quot;CaF2&quot;)
], det)
# frs is now a FilteredReference[] used to fit the unknowns.

# Split the counts in unks[1] into 100 randomized spectra which will sum to unks[1] then fit them
res = map(subdivide(unks[1], 100)) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">100-element Vector{FilterFitResult}:
 Sub[III-E K412[0][all],1 of 100]
 Sub[III-E K412[0][all],2 of 100]
 Sub[III-E K412[0][all],3 of 100]
 Sub[III-E K412[0][all],4 of 100]
 Sub[III-E K412[0][all],5 of 100]
 Sub[III-E K412[0][all],6 of 100]
 Sub[III-E K412[0][all],7 of 100]
 Sub[III-E K412[0][all],8 of 100]
 Sub[III-E K412[0][all],9 of 100]
 Sub[III-E K412[0][all],10 of 100]
 ⋮
 Sub[III-E K412[0][all],92 of 100]
 Sub[III-E K412[0][all],93 of 100]
 Sub[III-E K412[0][all],94 of 100]
 Sub[III-E K412[0][all],95 of 100]
 Sub[III-E K412[0][all],96 of 100]
 Sub[III-E K412[0][all],97 of 100]
 Sub[III-E K412[0][all],98 of 100]
 Sub[III-E K412[0][all],99 of 100]
 Sub[III-E K412[0][all],100 of 100]</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 11 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 11 others, Fe]</th><th style="text-align: right">k[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">Δk[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">k[Al K-L3 + 1 other, Al2O3]</th><th style="text-align: right">Δk[Al K-L3 + 1 other, Al2O3]</th><th style="text-align: right">k[Si K-L3 + 2 others, SiO2]</th><th style="text-align: right">Δk[Si K-L3 + 2 others, SiO2]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],1 of 100]</td><td style="text-align: right">0.6748</td><td style="text-align: right">0.00822</td><td style="text-align: right">0.0424</td><td style="text-align: right">0.004349</td><td style="text-align: right">0.1514</td><td style="text-align: right">0.001842</td><td style="text-align: right">0.06846</td><td style="text-align: right">0.001589</td><td style="text-align: right">0.3565</td><td style="text-align: right">0.002897</td><td style="text-align: right">0.1913</td><td style="text-align: right">0.002319</td><td style="text-align: right">0.06467</td><td style="text-align: right">0.001582</td><td style="text-align: right">0.07057</td><td style="text-align: right">0.006762</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],2 of 100]</td><td style="text-align: right">0.6604</td><td style="text-align: right">0.008164</td><td style="text-align: right">0.04532</td><td style="text-align: right">0.004484</td><td style="text-align: right">0.1486</td><td style="text-align: right">0.001835</td><td style="text-align: right">0.06516</td><td style="text-align: right">0.001578</td><td style="text-align: right">0.3517</td><td style="text-align: right">0.002895</td><td style="text-align: right">0.1958</td><td style="text-align: right">0.002333</td><td style="text-align: right">0.06691</td><td style="text-align: right">0.001586</td><td style="text-align: right">0.0557</td><td style="text-align: right">0.006552</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],3 of 100]</td><td style="text-align: right">0.6565</td><td style="text-align: right">0.00815</td><td style="text-align: right">0.04216</td><td style="text-align: right">0.004421</td><td style="text-align: right">0.1489</td><td style="text-align: right">0.001834</td><td style="text-align: right">0.06665</td><td style="text-align: right">0.001577</td><td style="text-align: right">0.3509</td><td style="text-align: right">0.002887</td><td style="text-align: right">0.1938</td><td style="text-align: right">0.002336</td><td style="text-align: right">0.06571</td><td style="text-align: right">0.001583</td><td style="text-align: right">0.07296</td><td style="text-align: right">0.00688</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],4 of 100]</td><td style="text-align: right">0.6508</td><td style="text-align: right">0.008108</td><td style="text-align: right">0.04698</td><td style="text-align: right">0.004361</td><td style="text-align: right">0.1499</td><td style="text-align: right">0.00184</td><td style="text-align: right">0.0645</td><td style="text-align: right">0.00158</td><td style="text-align: right">0.3528</td><td style="text-align: right">0.002898</td><td style="text-align: right">0.1904</td><td style="text-align: right">0.002324</td><td style="text-align: right">0.06695</td><td style="text-align: right">0.00159</td><td style="text-align: right">0.07885</td><td style="text-align: right">0.006839</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],5 of 100]</td><td style="text-align: right">0.6448</td><td style="text-align: right">0.00812</td><td style="text-align: right">0.03851</td><td style="text-align: right">0.004386</td><td style="text-align: right">0.1463</td><td style="text-align: right">0.001825</td><td style="text-align: right">0.06591</td><td style="text-align: right">0.001583</td><td style="text-align: right">0.3489</td><td style="text-align: right">0.002885</td><td style="text-align: right">0.198</td><td style="text-align: right">0.002353</td><td style="text-align: right">0.06596</td><td style="text-align: right">0.0016</td><td style="text-align: right">0.05634</td><td style="text-align: right">0.006519</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],6 of 100]</td><td style="text-align: right">0.6596</td><td style="text-align: right">0.008152</td><td style="text-align: right">0.04042</td><td style="text-align: right">0.00431</td><td style="text-align: right">0.1456</td><td style="text-align: right">0.001831</td><td style="text-align: right">0.06973</td><td style="text-align: right">0.001604</td><td style="text-align: right">0.3455</td><td style="text-align: right">0.002874</td><td style="text-align: right">0.1935</td><td style="text-align: right">0.002345</td><td style="text-align: right">0.06748</td><td style="text-align: right">0.001595</td><td style="text-align: right">0.07399</td><td style="text-align: right">0.006583</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],7 of 100]</td><td style="text-align: right">0.6591</td><td style="text-align: right">0.008191</td><td style="text-align: right">0.04252</td><td style="text-align: right">0.00448</td><td style="text-align: right">0.1461</td><td style="text-align: right">0.001826</td><td style="text-align: right">0.0651</td><td style="text-align: right">0.001581</td><td style="text-align: right">0.3507</td><td style="text-align: right">0.002893</td><td style="text-align: right">0.1929</td><td style="text-align: right">0.002332</td><td style="text-align: right">0.06596</td><td style="text-align: right">0.001589</td><td style="text-align: right">0.06905</td><td style="text-align: right">0.006863</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],8 of 100]</td><td style="text-align: right">0.6639</td><td style="text-align: right">0.008128</td><td style="text-align: right">0.04862</td><td style="text-align: right">0.004391</td><td style="text-align: right">0.1505</td><td style="text-align: right">0.001843</td><td style="text-align: right">0.06503</td><td style="text-align: right">0.001578</td><td style="text-align: right">0.3584</td><td style="text-align: right">0.002907</td><td style="text-align: right">0.1909</td><td style="text-align: right">0.002314</td><td style="text-align: right">0.07027</td><td style="text-align: right">0.001597</td><td style="text-align: right">0.07</td><td style="text-align: right">0.006679</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],9 of 100]</td><td style="text-align: right">0.6707</td><td style="text-align: right">0.008188</td><td style="text-align: right">0.0377</td><td style="text-align: right">0.004229</td><td style="text-align: right">0.1506</td><td style="text-align: right">0.001841</td><td style="text-align: right">0.0671</td><td style="text-align: right">0.001586</td><td style="text-align: right">0.3548</td><td style="text-align: right">0.002896</td><td style="text-align: right">0.191</td><td style="text-align: right">0.002329</td><td style="text-align: right">0.06825</td><td style="text-align: right">0.001591</td><td style="text-align: right">0.0596</td><td style="text-align: right">0.006701</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],10 of 100]</td><td style="text-align: right">0.6561</td><td style="text-align: right">0.008129</td><td style="text-align: right">0.04088</td><td style="text-align: right">0.004414</td><td style="text-align: right">0.1478</td><td style="text-align: right">0.001832</td><td style="text-align: right">0.06643</td><td style="text-align: right">0.001585</td><td style="text-align: right">0.3547</td><td style="text-align: right">0.002891</td><td style="text-align: right">0.1934</td><td style="text-align: right">0.002321</td><td style="text-align: right">0.06916</td><td style="text-align: right">0.001611</td><td style="text-align: right">0.07996</td><td style="text-align: right">0.006835</td></tr></table><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.6556</td><td style="text-align: right">0.009753</td><td style="text-align: right">1.199</td><td style="text-align: right">0.6316</td><td style="text-align: right">0.649</td><td style="text-align: right">0.6562</td><td style="text-align: right">0.6616</td><td style="text-align: right">0.6821</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 11 others, Fe]</td><td style="text-align: right">0.04192</td><td style="text-align: right">0.003241</td><td style="text-align: right">0.7399</td><td style="text-align: right">0.03419</td><td style="text-align: right">0.03977</td><td style="text-align: right">0.04208</td><td style="text-align: right">0.04389</td><td style="text-align: right">0.05339</td></tr><tr><td style="text-align: right">k[Mg K-L3 + 1 other, MgO]</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.001981</td><td style="text-align: right">1.08</td><td style="text-align: right">0.1426</td><td style="text-align: right">0.1463</td><td style="text-align: right">0.1473</td><td style="text-align: right">0.1487</td><td style="text-align: right">0.1523</td></tr><tr><td style="text-align: right">k[Al K-L3 + 1 other, Al2O3]</td><td style="text-align: right">0.06703</td><td style="text-align: right">0.00143</td><td style="text-align: right">0.8996</td><td style="text-align: right">0.06323</td><td style="text-align: right">0.06602</td><td style="text-align: right">0.06692</td><td style="text-align: right">0.06798</td><td style="text-align: right">0.07039</td></tr><tr><td style="text-align: right">k[Si K-L3 + 2 others, SiO2]</td><td style="text-align: right">0.351</td><td style="text-align: right">0.002946</td><td style="text-align: right">1.019</td><td style="text-align: right">0.3452</td><td style="text-align: right">0.3487</td><td style="text-align: right">0.351</td><td style="text-align: right">0.3526</td><td style="text-align: right">0.3584</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.002592</td><td style="text-align: right">1.114</td><td style="text-align: right">0.1858</td><td style="text-align: right">0.1905</td><td style="text-align: right">0.1925</td><td style="text-align: right">0.194</td><td style="text-align: right">0.198</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.06684</td><td style="text-align: right">0.001379</td><td style="text-align: right">0.8657</td><td style="text-align: right">0.06393</td><td style="text-align: right">0.06599</td><td style="text-align: right">0.0667</td><td style="text-align: right">0.06772</td><td style="text-align: right">0.07054</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.0669</td><td style="text-align: right">0.00783</td><td style="text-align: right">1.165</td><td style="text-align: right">0.04417</td><td style="text-align: right">0.06172</td><td style="text-align: right">0.06707</td><td style="text-align: right">0.07214</td><td style="text-align: right">0.08567</td></tr></table><p>Repeat the fit for the 4 measured unknowns.</p><pre><code class="language-julia hljs">res= map(unks) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">5-element Vector{FilterFitResult}:
 III-E K412[0][all]
 III-E K412[1][all]
 III-E K412[2][all]
 III-E K412[3][all]
 III-E K412[4][all]</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 11 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 11 others, Fe]</th><th style="text-align: right">k[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">Δk[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">k[Al K-L3 + 1 other, Al2O3]</th><th style="text-align: right">Δk[Al K-L3 + 1 other, Al2O3]</th><th style="text-align: right">k[Si K-L3 + 2 others, SiO2]</th><th style="text-align: right">Δk[Si K-L3 + 2 others, SiO2]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th></tr><tr><td style="text-align: right">III-E K412[0][all]</td><td style="text-align: right">0.6556</td><td style="text-align: right">0.0008134</td><td style="text-align: right">0.04191</td><td style="text-align: right">0.0004382</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.0001834</td><td style="text-align: right">0.06703</td><td style="text-align: right">0.000159</td><td style="text-align: right">0.351</td><td style="text-align: right">0.000289</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002326</td><td style="text-align: right">0.06683</td><td style="text-align: right">0.0001593</td><td style="text-align: right">0.06684</td><td style="text-align: right">0.0006722</td></tr><tr><td style="text-align: right">III-E K412[1][all]</td><td style="text-align: right">0.6574</td><td style="text-align: right">0.0008141</td><td style="text-align: right">0.04157</td><td style="text-align: right">0.0004372</td><td style="text-align: right">0.1475</td><td style="text-align: right">0.0001835</td><td style="text-align: right">0.06679</td><td style="text-align: right">0.000159</td><td style="text-align: right">0.3502</td><td style="text-align: right">0.0002888</td><td style="text-align: right">0.1916</td><td style="text-align: right">0.0002324</td><td style="text-align: right">0.06708</td><td style="text-align: right">0.0001595</td><td style="text-align: right">0.06738</td><td style="text-align: right">0.0006721</td></tr><tr><td style="text-align: right">III-E K412[2][all]</td><td style="text-align: right">0.658</td><td style="text-align: right">0.0008157</td><td style="text-align: right">0.04192</td><td style="text-align: right">0.0004381</td><td style="text-align: right">0.1479</td><td style="text-align: right">0.0001838</td><td style="text-align: right">0.06713</td><td style="text-align: right">0.0001594</td><td style="text-align: right">0.3514</td><td style="text-align: right">0.0002896</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002329</td><td style="text-align: right">0.06688</td><td style="text-align: right">0.0001596</td><td style="text-align: right">0.06704</td><td style="text-align: right">0.0006737</td></tr><tr><td style="text-align: right">III-E K412[3][all]</td><td style="text-align: right">0.6624</td><td style="text-align: right">0.0008188</td><td style="text-align: right">0.04146</td><td style="text-align: right">0.0004379</td><td style="text-align: right">0.1481</td><td style="text-align: right">0.0001841</td><td style="text-align: right">0.0672</td><td style="text-align: right">0.0001596</td><td style="text-align: right">0.3522</td><td style="text-align: right">0.00029</td><td style="text-align: right">0.1925</td><td style="text-align: right">0.0002333</td><td style="text-align: right">0.06682</td><td style="text-align: right">0.0001598</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.0006746</td></tr><tr><td style="text-align: right">III-E K412[4][all]</td><td style="text-align: right">0.6608</td><td style="text-align: right">0.0008182</td><td style="text-align: right">0.04082</td><td style="text-align: right">0.0004383</td><td style="text-align: right">0.1482</td><td style="text-align: right">0.0001841</td><td style="text-align: right">0.06732</td><td style="text-align: right">0.0001597</td><td style="text-align: right">0.3521</td><td style="text-align: right">0.00029</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002333</td><td style="text-align: right">0.06694</td><td style="text-align: right">0.0001598</td><td style="text-align: right">0.06648</td><td style="text-align: right">0.0006739</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.6588</td><td style="text-align: right">0.002724</td><td style="text-align: right">3.338</td><td style="text-align: right">0.6556</td><td style="text-align: right">0.6574</td><td style="text-align: right">0.658</td><td style="text-align: right">0.6608</td><td style="text-align: right">0.6624</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 11 others, Fe]</td><td style="text-align: right">0.04153</td><td style="text-align: right">0.0004496</td><td style="text-align: right">1.027</td><td style="text-align: right">0.04082</td><td style="text-align: right">0.04146</td><td style="text-align: right">0.04157</td><td style="text-align: right">0.04191</td><td style="text-align: right">0.04192</td></tr><tr><td style="text-align: right">k[Mg K-L3 + 1 other, MgO]</td><td style="text-align: right">0.1478</td><td style="text-align: right">0.0003026</td><td style="text-align: right">1.647</td><td style="text-align: right">0.1475</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.1479</td><td style="text-align: right">0.1481</td><td style="text-align: right">0.1482</td></tr><tr><td style="text-align: right">k[Al K-L3 + 1 other, Al2O3]</td><td style="text-align: right">0.06709</td><td style="text-align: right">0.0002022</td><td style="text-align: right">1.269</td><td style="text-align: right">0.06679</td><td style="text-align: right">0.06703</td><td style="text-align: right">0.06713</td><td style="text-align: right">0.0672</td><td style="text-align: right">0.06732</td></tr><tr><td style="text-align: right">k[Si K-L3 + 2 others, SiO2]</td><td style="text-align: right">0.3514</td><td style="text-align: right">0.0008301</td><td style="text-align: right">2.867</td><td style="text-align: right">0.3502</td><td style="text-align: right">0.351</td><td style="text-align: right">0.3514</td><td style="text-align: right">0.3521</td><td style="text-align: right">0.3522</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1921</td><td style="text-align: right">0.000318</td><td style="text-align: right">1.365</td><td style="text-align: right">0.1916</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1925</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.06691</td><td style="text-align: right">0.0001063</td><td style="text-align: right">0.6661</td><td style="text-align: right">0.06682</td><td style="text-align: right">0.06683</td><td style="text-align: right">0.06688</td><td style="text-align: right">0.06694</td><td style="text-align: right">0.06708</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.06711</td><td style="text-align: right">0.0005071</td><td style="text-align: right">0.7531</td><td style="text-align: right">0.06648</td><td style="text-align: right">0.06684</td><td style="text-align: right">0.06704</td><td style="text-align: right">0.06738</td><td style="text-align: right">0.0678</td></tr></table><pre><code class="language-julia hljs">@btime fit_spectrum(unks[1], frs)</code></pre><pre><code class="nohighlight hljs">1.021 ms (3083 allocations: 514.52 KiB)
III-E K412[0][all]</code></pre><h6 id="AMM-6005a"><a class="docs-heading-anchor" href="#AMM-6005a">AMM-6005a</a><a id="AMM-6005a-1"></a><a class="docs-heading-anchor-permalink" href="#AMM-6005a" title="Permalink"></a></h6><p>Repeat using the ADM glass.  Fe is not present in ADM-6005a but we fit it to see what a null result looks like.</p><pre><code class="language-julia hljs">path = normpath(joinpath(@__DIR__, &quot;..&quot;,&quot;test&quot;,&quot;ADM6005a spectra&quot;))
unks = map(i-&gt;loadspectrum(joinpath(path,&quot;ADM-6005a_$i.msa&quot;)),1:15)
al, caf2, fe, ge, si, sio2, ti, zn = map(f-&gt;loadspectrum(joinpath(path,&quot;$f.msa&quot;)), (&quot;Al std&quot;, &quot;CaF2 std&quot;, &quot;Fe std&quot;, &quot;Ge std&quot;, &quot;Si std&quot;, &quot;SiO2 std&quot;, &quot;Ti trimmed&quot;,&quot;Zn std&quot;))

det = matching(unks[1], 132.0, 10)

frs = references( [
  reference(n&quot;Al&quot;, al, mat&quot;Al&quot; ), #
  reference(n&quot;Ca&quot;, caf2, mat&quot;CaF2&quot; ),   #
  reference(n&quot;Fe&quot;, fe, mat&quot;Fe&quot; ),    #
  reference(n&quot;Ge&quot;, ge, mat&quot;Ge&quot; ),    #
  reference(n&quot;Si&quot;, si, mat&quot;Si&quot; ),  #
  reference(n&quot;O&quot;, sio2, mat&quot;SiO2&quot; ),  #
  reference(n&quot;Ti&quot;, ti, mat&quot;Ti&quot; ),
  reference(n&quot;Zn&quot;, zn, mat&quot;Zn&quot; ) 
], det)

ss = 
res= map(subdivide(unks[1], 100)) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">100-element Vector{FilterFitResult}:
 Sub[ADM-6005a_1,1 of 100]
 Sub[ADM-6005a_1,2 of 100]
 Sub[ADM-6005a_1,3 of 100]
 Sub[ADM-6005a_1,4 of 100]
 Sub[ADM-6005a_1,5 of 100]
 Sub[ADM-6005a_1,6 of 100]
 Sub[ADM-6005a_1,7 of 100]
 Sub[ADM-6005a_1,8 of 100]
 Sub[ADM-6005a_1,9 of 100]
 Sub[ADM-6005a_1,10 of 100]
 ⋮
 Sub[ADM-6005a_1,92 of 100]
 Sub[ADM-6005a_1,93 of 100]
 Sub[ADM-6005a_1,94 of 100]
 Sub[ADM-6005a_1,95 of 100]
 Sub[ADM-6005a_1,96 of 100]
 Sub[ADM-6005a_1,97 of 100]
 Sub[ADM-6005a_1,98 of 100]
 Sub[ADM-6005a_1,99 of 100]
 Sub[ADM-6005a_1,100 of 100]</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[Ti L3-M1 + 6 others, Ti]</th><th style="text-align: right">Δk[Ti L3-M1 + 6 others, Ti]</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 11 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 11 others, Fe]</th><th style="text-align: right">k[Zn L3-M5 + 11 others, Zn]</th><th style="text-align: right">Δk[Zn L3-M5 + 11 others, Zn]</th><th style="text-align: right">k[Ge L3-M5 + 11 others, Ge]</th><th style="text-align: right">Δk[Ge L3-M5 + 11 others, Ge]</th><th style="text-align: right">k[Al K-L3 + 1 other, Al]</th><th style="text-align: right">Δk[Al K-L3 + 1 other, Al]</th><th style="text-align: right">k[Si K-L3 + 2 others, Si]</th><th style="text-align: right">Δk[Si K-L3 + 2 others, Si]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">Δk[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">k[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">Δk[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">k[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">Δk[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">k[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">Δk[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">k[Ge K-M3 + 3 others, Ge]</th><th style="text-align: right">Δk[Ge K-M3 + 3 others, Ge]</th></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,1 of 100]</td><td style="text-align: right">0.03979</td><td style="text-align: right">0.01847</td><td style="text-align: right">0.4911</td><td style="text-align: right">0.006699</td><td style="text-align: right">0</td><td style="text-align: right">0.05178</td><td style="text-align: right">0.06633</td><td style="text-align: right">0.001464</td><td style="text-align: right">0.1789</td><td style="text-align: right">0.001768</td><td style="text-align: right">0.02762</td><td style="text-align: right">0.0005026</td><td style="text-align: right">0.02149</td><td style="text-align: right">0.0004995</td><td style="text-align: right">0.1231</td><td style="text-align: right">0.001687</td><td style="text-align: right">0.06298</td><td style="text-align: right">0.001038</td><td style="text-align: right">0.00235</td><td style="text-align: right">0.0006933</td><td style="text-align: right">0</td><td style="text-align: right">0.0721</td><td style="text-align: right">0.1108</td><td style="text-align: right">0.002723</td><td style="text-align: right">0.1382</td><td style="text-align: right">0.01576</td><td style="text-align: right">0.2633</td><td style="text-align: right">0.005289</td><td style="text-align: right">0.2784</td><td style="text-align: right">0.01904</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,2 of 100]</td><td style="text-align: right">0.03466</td><td style="text-align: right">0.0181</td><td style="text-align: right">0.5047</td><td style="text-align: right">0.006812</td><td style="text-align: right">0.005932</td><td style="text-align: right">0.002824</td><td style="text-align: right">0.06779</td><td style="text-align: right">0.001479</td><td style="text-align: right">0.1762</td><td style="text-align: right">0.001755</td><td style="text-align: right">0.02882</td><td style="text-align: right">0.0004978</td><td style="text-align: right">0.02152</td><td style="text-align: right">0.0005032</td><td style="text-align: right">0.12</td><td style="text-align: right">0.001693</td><td style="text-align: right">0.06505</td><td style="text-align: right">0.001033</td><td style="text-align: right">0.0007142</td><td style="text-align: right">0.000703</td><td style="text-align: right">0</td><td style="text-align: right">0.07099</td><td style="text-align: right">0.1068</td><td style="text-align: right">0.002742</td><td style="text-align: right">0.1364</td><td style="text-align: right">0.01595</td><td style="text-align: right">0.2593</td><td style="text-align: right">0.005218</td><td style="text-align: right">0.2675</td><td style="text-align: right">0.0192</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,3 of 100]</td><td style="text-align: right">0.0119</td><td style="text-align: right">0.01812</td><td style="text-align: right">0.4964</td><td style="text-align: right">0.006833</td><td style="text-align: right">0</td><td style="text-align: right">0.05351</td><td style="text-align: right">0.0687</td><td style="text-align: right">0.001476</td><td style="text-align: right">0.1769</td><td style="text-align: right">0.001754</td><td style="text-align: right">0.02769</td><td style="text-align: right">0.0004955</td><td style="text-align: right">0.02186</td><td style="text-align: right">0.0005054</td><td style="text-align: right">0.1221</td><td style="text-align: right">0.00169</td><td style="text-align: right">0.06324</td><td style="text-align: right">0.001027</td><td style="text-align: right">0.0007645</td><td style="text-align: right">0.000715</td><td style="text-align: right">0.002875</td><td style="text-align: right">0.005064</td><td style="text-align: right">0.1075</td><td style="text-align: right">0.002706</td><td style="text-align: right">0.1247</td><td style="text-align: right">0.01565</td><td style="text-align: right">0.282</td><td style="text-align: right">0.005385</td><td style="text-align: right">0.2553</td><td style="text-align: right">0.01876</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,4 of 100]</td><td style="text-align: right">0.003213</td><td style="text-align: right">0.01808</td><td style="text-align: right">0.4844</td><td style="text-align: right">0.006751</td><td style="text-align: right">0.0004915</td><td style="text-align: right">0.00285</td><td style="text-align: right">0.06675</td><td style="text-align: right">0.001475</td><td style="text-align: right">0.1777</td><td style="text-align: right">0.001768</td><td style="text-align: right">0.028</td><td style="text-align: right">0.0005002</td><td style="text-align: right">0.02092</td><td style="text-align: right">0.0004986</td><td style="text-align: right">0.1234</td><td style="text-align: right">0.001682</td><td style="text-align: right">0.06524</td><td style="text-align: right">0.001027</td><td style="text-align: right">0.000916</td><td style="text-align: right">0.0007002</td><td style="text-align: right">0.006976</td><td style="text-align: right">0.005102</td><td style="text-align: right">0.115</td><td style="text-align: right">0.002737</td><td style="text-align: right">0.1355</td><td style="text-align: right">0.01588</td><td style="text-align: right">0.2642</td><td style="text-align: right">0.005256</td><td style="text-align: right">0.2675</td><td style="text-align: right">0.01848</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,5 of 100]</td><td style="text-align: right">0.01945</td><td style="text-align: right">0.01773</td><td style="text-align: right">0.4877</td><td style="text-align: right">0.006754</td><td style="text-align: right">0.0002066</td><td style="text-align: right">0.002809</td><td style="text-align: right">0.06641</td><td style="text-align: right">0.001472</td><td style="text-align: right">0.1794</td><td style="text-align: right">0.001766</td><td style="text-align: right">0.0274</td><td style="text-align: right">0.0004981</td><td style="text-align: right">0.02071</td><td style="text-align: right">0.0005004</td><td style="text-align: right">0.121</td><td style="text-align: right">0.001683</td><td style="text-align: right">0.05966</td><td style="text-align: right">0.001018</td><td style="text-align: right">0</td><td style="text-align: right">0.02621</td><td style="text-align: right">0.004308</td><td style="text-align: right">0.005043</td><td style="text-align: right">0.1089</td><td style="text-align: right">0.002674</td><td style="text-align: right">0.1653</td><td style="text-align: right">0.01593</td><td style="text-align: right">0.2763</td><td style="text-align: right">0.005334</td><td style="text-align: right">0.2649</td><td style="text-align: right">0.01935</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,6 of 100]</td><td style="text-align: right">0</td><td style="text-align: right">0.1343</td><td style="text-align: right">0.4792</td><td style="text-align: right">0.006389</td><td style="text-align: right">0.004669</td><td style="text-align: right">0.002829</td><td style="text-align: right">0.06909</td><td style="text-align: right">0.001474</td><td style="text-align: right">0.1777</td><td style="text-align: right">0.001777</td><td style="text-align: right">0.02765</td><td style="text-align: right">0.0005016</td><td style="text-align: right">0.02151</td><td style="text-align: right">0.000504</td><td style="text-align: right">0.12</td><td style="text-align: right">0.00169</td><td style="text-align: right">0.062</td><td style="text-align: right">0.001022</td><td style="text-align: right">0.0005552</td><td style="text-align: right">0.0006844</td><td style="text-align: right">0</td><td style="text-align: right">0.07149</td><td style="text-align: right">0.1137</td><td style="text-align: right">0.002747</td><td style="text-align: right">0.1324</td><td style="text-align: right">0.01579</td><td style="text-align: right">0.2605</td><td style="text-align: right">0.005209</td><td style="text-align: right">0.2353</td><td style="text-align: right">0.01892</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,7 of 100]</td><td style="text-align: right">0.02144</td><td style="text-align: right">0.01817</td><td style="text-align: right">0.4946</td><td style="text-align: right">0.006747</td><td style="text-align: right">0.002012</td><td style="text-align: right">0.002769</td><td style="text-align: right">0.06663</td><td style="text-align: right">0.001487</td><td style="text-align: right">0.1805</td><td style="text-align: right">0.001785</td><td style="text-align: right">0.0264</td><td style="text-align: right">0.0004901</td><td style="text-align: right">0.02145</td><td style="text-align: right">0.0005001</td><td style="text-align: right">0.1258</td><td style="text-align: right">0.001709</td><td style="text-align: right">0.06547</td><td style="text-align: right">0.001032</td><td style="text-align: right">0.0005266</td><td style="text-align: right">0.0007202</td><td style="text-align: right">0.003074</td><td style="text-align: right">0.005004</td><td style="text-align: right">0.1124</td><td style="text-align: right">0.002693</td><td style="text-align: right">0.1375</td><td style="text-align: right">0.01578</td><td style="text-align: right">0.2689</td><td style="text-align: right">0.005244</td><td style="text-align: right">0.2434</td><td style="text-align: right">0.01832</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,8 of 100]</td><td style="text-align: right">0.03785</td><td style="text-align: right">0.01833</td><td style="text-align: right">0.497</td><td style="text-align: right">0.006791</td><td style="text-align: right">0.002617</td><td style="text-align: right">0.002876</td><td style="text-align: right">0.06656</td><td style="text-align: right">0.001454</td><td style="text-align: right">0.1783</td><td style="text-align: right">0.001759</td><td style="text-align: right">0.02873</td><td style="text-align: right">0.000502</td><td style="text-align: right">0.02111</td><td style="text-align: right">0.0005014</td><td style="text-align: right">0.1228</td><td style="text-align: right">0.001692</td><td style="text-align: right">0.06354</td><td style="text-align: right">0.001023</td><td style="text-align: right">0.0005336</td><td style="text-align: right">0.0006994</td><td style="text-align: right">0</td><td style="text-align: right">0.07004</td><td style="text-align: right">0.1088</td><td style="text-align: right">0.002742</td><td style="text-align: right">0.1109</td><td style="text-align: right">0.01583</td><td style="text-align: right">0.2602</td><td style="text-align: right">0.005269</td><td style="text-align: right">0.2961</td><td style="text-align: right">0.01938</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,9 of 100]</td><td style="text-align: right">0.01875</td><td style="text-align: right">0.0183</td><td style="text-align: right">0.5004</td><td style="text-align: right">0.006772</td><td style="text-align: right">0.003413</td><td style="text-align: right">0.002895</td><td style="text-align: right">0.06436</td><td style="text-align: right">0.001461</td><td style="text-align: right">0.1785</td><td style="text-align: right">0.001753</td><td style="text-align: right">0.02797</td><td style="text-align: right">0.0004975</td><td style="text-align: right">0.02132</td><td style="text-align: right">0.0004992</td><td style="text-align: right">0.1217</td><td style="text-align: right">0.001691</td><td style="text-align: right">0.06725</td><td style="text-align: right">0.001047</td><td style="text-align: right">3.557e-05</td><td style="text-align: right">0.0006965</td><td style="text-align: right">0</td><td style="text-align: right">0.07085</td><td style="text-align: right">0.11</td><td style="text-align: right">0.002724</td><td style="text-align: right">0.0934</td><td style="text-align: right">0.01596</td><td style="text-align: right">0.2512</td><td style="text-align: right">0.005277</td><td style="text-align: right">0.2859</td><td style="text-align: right">0.01921</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,10 of 100]</td><td style="text-align: right">0.04406</td><td style="text-align: right">0.0181</td><td style="text-align: right">0.5025</td><td style="text-align: right">0.006808</td><td style="text-align: right">0</td><td style="text-align: right">0.05165</td><td style="text-align: right">0.0696</td><td style="text-align: right">0.001484</td><td style="text-align: right">0.1803</td><td style="text-align: right">0.00176</td><td style="text-align: right">0.02744</td><td style="text-align: right">0.0004936</td><td style="text-align: right">0.02074</td><td style="text-align: right">0.0004955</td><td style="text-align: right">0.1243</td><td style="text-align: right">0.001706</td><td style="text-align: right">0.066</td><td style="text-align: right">0.001035</td><td style="text-align: right">0</td><td style="text-align: right">0.02608</td><td style="text-align: right">0.01174</td><td style="text-align: right">0.005274</td><td style="text-align: right">0.1124</td><td style="text-align: right">0.002761</td><td style="text-align: right">0.08306</td><td style="text-align: right">0.01569</td><td style="text-align: right">0.2532</td><td style="text-align: right">0.005189</td><td style="text-align: right">0.2533</td><td style="text-align: right">0.01868</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[Ti L3-M1 + 6 others, Ti]</td><td style="text-align: right">0.02125</td><td style="text-align: right">0.01765</td><td style="text-align: right">0.4972</td><td style="text-align: right">0</td><td style="text-align: right">0.006676</td><td style="text-align: right">0.0199</td><td style="text-align: right">0.03005</td><td style="text-align: right">0.07814</td></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.4877</td><td style="text-align: right">0.009816</td><td style="text-align: right">1.469</td><td style="text-align: right">0.46</td><td style="text-align: right">0.4813</td><td style="text-align: right">0.4881</td><td style="text-align: right">0.4945</td><td style="text-align: right">0.5122</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 11 others, Fe]</td><td style="text-align: right">0.001311</td><td style="text-align: right">0.001875</td><td style="text-align: right">0.07139</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0002671</td><td style="text-align: right">0.00204</td><td style="text-align: right">0.007958</td></tr><tr><td style="text-align: right">k[Zn L3-M5 + 11 others, Zn]</td><td style="text-align: right">0.06813</td><td style="text-align: right">0.00184</td><td style="text-align: right">1.247</td><td style="text-align: right">0.06364</td><td style="text-align: right">0.06674</td><td style="text-align: right">0.06821</td><td style="text-align: right">0.06914</td><td style="text-align: right">0.07305</td></tr><tr><td style="text-align: right">k[Ge L3-M5 + 11 others, Ge]</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.002352</td><td style="text-align: right">1.331</td><td style="text-align: right">0.1743</td><td style="text-align: right">0.1777</td><td style="text-align: right">0.1789</td><td style="text-align: right">0.1808</td><td style="text-align: right">0.1852</td></tr><tr><td style="text-align: right">k[Al K-L3 + 1 other, Al]</td><td style="text-align: right">0.02803</td><td style="text-align: right">0.0007543</td><td style="text-align: right">1.508</td><td style="text-align: right">0.02608</td><td style="text-align: right">0.02753</td><td style="text-align: right">0.02798</td><td style="text-align: right">0.02848</td><td style="text-align: right">0.03013</td></tr><tr><td style="text-align: right">k[Si K-L3 + 2 others, Si]</td><td style="text-align: right">0.02145</td><td style="text-align: right">0.000687</td><td style="text-align: right">1.37</td><td style="text-align: right">0.01983</td><td style="text-align: right">0.02106</td><td style="text-align: right">0.02141</td><td style="text-align: right">0.0219</td><td style="text-align: right">0.02346</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.002496</td><td style="text-align: right">1.48</td><td style="text-align: right">0.1148</td><td style="text-align: right">0.1199</td><td style="text-align: right">0.1209</td><td style="text-align: right">0.123</td><td style="text-align: right">0.1274</td></tr><tr><td style="text-align: right">k[Ti K-L3 + 3 others, Ti]</td><td style="text-align: right">0.06433</td><td style="text-align: right">0.001472</td><td style="text-align: right">1.426</td><td style="text-align: right">0.05966</td><td style="text-align: right">0.06341</td><td style="text-align: right">0.06427</td><td style="text-align: right">0.06525</td><td style="text-align: right">0.06874</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.0004357</td><td style="text-align: right">0.0004932</td><td style="text-align: right">0.05111</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0004093</td><td style="text-align: right">0.0006618</td><td style="text-align: right">0.00235</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.003286</td><td style="text-align: right">0.004442</td><td style="text-align: right">0.1231</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0009466</td><td style="text-align: right">0.005763</td><td style="text-align: right">0.019</td></tr><tr><td style="text-align: right">k[Zn K-L3 + 1 other, Zn]</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.00389</td><td style="text-align: right">1.428</td><td style="text-align: right">0.1027</td><td style="text-align: right">0.1088</td><td style="text-align: right">0.1121</td><td style="text-align: right">0.1146</td><td style="text-align: right">0.1206</td></tr><tr><td style="text-align: right">k[Zn K-M3 + 3 others, Zn]</td><td style="text-align: right">0.1244</td><td style="text-align: right">0.01707</td><td style="text-align: right">1.087</td><td style="text-align: right">0.0724</td><td style="text-align: right">0.1152</td><td style="text-align: right">0.1227</td><td style="text-align: right">0.1364</td><td style="text-align: right">0.1661</td></tr><tr><td style="text-align: right">k[Ge K-L3 + 1 other, Ge]</td><td style="text-align: right">0.2634</td><td style="text-align: right">0.007557</td><td style="text-align: right">1.438</td><td style="text-align: right">0.2441</td><td style="text-align: right">0.2585</td><td style="text-align: right">0.263</td><td style="text-align: right">0.268</td><td style="text-align: right">0.282</td></tr><tr><td style="text-align: right">k[Ge K-M3 + 3 others, Ge]</td><td style="text-align: right">0.2712</td><td style="text-align: right">0.02233</td><td style="text-align: right">1.17</td><td style="text-align: right">0.2221</td><td style="text-align: right">0.2537</td><td style="text-align: right">0.2684</td><td style="text-align: right">0.2894</td><td style="text-align: right">0.33</td></tr></table><p>Repeat for the 15 measured spectra.</p><pre><code class="language-julia hljs">res= map(unks) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">15-element Vector{FilterFitResult}:
 ADM-6005a_1
 ADM-6005a_2
 ADM-6005a_3
 ADM-6005a_4
 ADM-6005a_5
 ADM-6005a_6
 ADM-6005a_7
 ADM-6005a_8
 ADM-6005a_9
 ADM-6005a_10
 ADM-6005a_11
 ADM-6005a_12
 ADM-6005a_13
 ADM-6005a_14
 ADM-6005a_15</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[Ti L3-M1 + 6 others, Ti]</th><th style="text-align: right">Δk[Ti L3-M1 + 6 others, Ti]</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 11 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 11 others, Fe]</th><th style="text-align: right">k[Zn L3-M5 + 11 others, Zn]</th><th style="text-align: right">Δk[Zn L3-M5 + 11 others, Zn]</th><th style="text-align: right">k[Ge L3-M5 + 11 others, Ge]</th><th style="text-align: right">Δk[Ge L3-M5 + 11 others, Ge]</th><th style="text-align: right">k[Al K-L3 + 1 other, Al]</th><th style="text-align: right">Δk[Al K-L3 + 1 other, Al]</th><th style="text-align: right">k[Si K-L3 + 2 others, Si]</th><th style="text-align: right">Δk[Si K-L3 + 2 others, Si]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">Δk[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">k[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">Δk[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">k[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">Δk[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">k[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">Δk[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">k[Ge K-M3 + 3 others, Ge]</th><th style="text-align: right">Δk[Ge K-M3 + 3 others, Ge]</th></tr><tr><td style="text-align: right">ADM-6005a_1</td><td style="text-align: right">0.01961</td><td style="text-align: right">0.001806</td><td style="text-align: right">0.4876</td><td style="text-align: right">0.0006731</td><td style="text-align: right">0.0001192</td><td style="text-align: right">0.0002801</td><td style="text-align: right">0.06814</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.0001767</td><td style="text-align: right">0.02803</td><td style="text-align: right">5.002e-05</td><td style="text-align: right">0.02145</td><td style="text-align: right">5.015e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06433</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002048</td><td style="text-align: right">6.966e-05</td><td style="text-align: right">0.001265</td><td style="text-align: right">0.0005064</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.0002725</td><td style="text-align: right">0.1242</td><td style="text-align: right">0.00157</td><td style="text-align: right">0.2634</td><td style="text-align: right">0.0005252</td><td style="text-align: right">0.271</td><td style="text-align: right">0.001901</td></tr><tr><td style="text-align: right">ADM-6005a_2</td><td style="text-align: right">0.02049</td><td style="text-align: right">0.001807</td><td style="text-align: right">0.4863</td><td style="text-align: right">0.000673</td><td style="text-align: right">0</td><td style="text-align: right">0.01666</td><td style="text-align: right">0.06796</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.0001767</td><td style="text-align: right">0.02796</td><td style="text-align: right">5.001e-05</td><td style="text-align: right">0.02148</td><td style="text-align: right">5.01e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06393</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003342</td><td style="text-align: right">6.935e-05</td><td style="text-align: right">0.001418</td><td style="text-align: right">0.0005071</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.0002728</td><td style="text-align: right">0.1242</td><td style="text-align: right">0.001569</td><td style="text-align: right">0.264</td><td style="text-align: right">0.0005255</td><td style="text-align: right">0.2779</td><td style="text-align: right">0.001906</td></tr><tr><td style="text-align: right">ADM-6005a_3</td><td style="text-align: right">0.02104</td><td style="text-align: right">0.001806</td><td style="text-align: right">0.4894</td><td style="text-align: right">0.0006739</td><td style="text-align: right">0.0002456</td><td style="text-align: right">0.0002783</td><td style="text-align: right">0.06801</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.0001767</td><td style="text-align: right">0.02808</td><td style="text-align: right">5.002e-05</td><td style="text-align: right">0.02139</td><td style="text-align: right">5.009e-05</td><td style="text-align: right">0.1216</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06404</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002986</td><td style="text-align: right">6.974e-05</td><td style="text-align: right">0.0006342</td><td style="text-align: right">0.0005059</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1171</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2622</td><td style="text-align: right">0.0005249</td><td style="text-align: right">0.2805</td><td style="text-align: right">0.001906</td></tr><tr><td style="text-align: right">ADM-6005a_4</td><td style="text-align: right">0.01925</td><td style="text-align: right">0.001807</td><td style="text-align: right">0.488</td><td style="text-align: right">0.0006739</td><td style="text-align: right">0</td><td style="text-align: right">0.01669</td><td style="text-align: right">0.06843</td><td style="text-align: right">0.0001479</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.0001768</td><td style="text-align: right">0.02804</td><td style="text-align: right">5.007e-05</td><td style="text-align: right">0.02151</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1211</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003314</td><td style="text-align: right">6.985e-05</td><td style="text-align: right">0.001286</td><td style="text-align: right">0.0005073</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002729</td><td style="text-align: right">0.1219</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2635</td><td style="text-align: right">0.0005251</td><td style="text-align: right">0.2763</td><td style="text-align: right">0.001907</td></tr><tr><td style="text-align: right">ADM-6005a_5</td><td style="text-align: right">0.01979</td><td style="text-align: right">0.001807</td><td style="text-align: right">0.488</td><td style="text-align: right">0.0006736</td><td style="text-align: right">0</td><td style="text-align: right">0.01668</td><td style="text-align: right">0.0679</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.0001767</td><td style="text-align: right">0.02819</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.02135</td><td style="text-align: right">5.011e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001689</td><td style="text-align: right">0.06406</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002726</td><td style="text-align: right">6.967e-05</td><td style="text-align: right">0.001403</td><td style="text-align: right">0.000506</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002724</td><td style="text-align: right">0.1223</td><td style="text-align: right">0.001563</td><td style="text-align: right">0.2624</td><td style="text-align: right">0.000525</td><td style="text-align: right">0.2739</td><td style="text-align: right">0.001902</td></tr><tr><td style="text-align: right">ADM-6005a_6</td><td style="text-align: right">0.02261</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.4892</td><td style="text-align: right">0.0006731</td><td style="text-align: right">0</td><td style="text-align: right">0.01667</td><td style="text-align: right">0.06812</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1792</td><td style="text-align: right">0.0001767</td><td style="text-align: right">0.02817</td><td style="text-align: right">5.009e-05</td><td style="text-align: right">0.02144</td><td style="text-align: right">5.015e-05</td><td style="text-align: right">0.1209</td><td style="text-align: right">0.0001686</td><td style="text-align: right">0.06397</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002285</td><td style="text-align: right">6.936e-05</td><td style="text-align: right">0.001213</td><td style="text-align: right">0.0005055</td><td style="text-align: right">0.1111</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1236</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2619</td><td style="text-align: right">0.000525</td><td style="text-align: right">0.2785</td><td style="text-align: right">0.001901</td></tr><tr><td style="text-align: right">ADM-6005a_7</td><td style="text-align: right">0.02161</td><td style="text-align: right">0.001812</td><td style="text-align: right">0.4897</td><td style="text-align: right">0.0006748</td><td style="text-align: right">0</td><td style="text-align: right">0.01668</td><td style="text-align: right">0.06787</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.0001768</td><td style="text-align: right">0.02798</td><td style="text-align: right">5.003e-05</td><td style="text-align: right">0.0215</td><td style="text-align: right">5.011e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.0642</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0003133</td><td style="text-align: right">6.951e-05</td><td style="text-align: right">0</td><td style="text-align: right">0.02247</td><td style="text-align: right">0.1111</td><td style="text-align: right">0.0002731</td><td style="text-align: right">0.123</td><td style="text-align: right">0.001573</td><td style="text-align: right">0.2635</td><td style="text-align: right">0.0005264</td><td style="text-align: right">0.2731</td><td style="text-align: right">0.001902</td></tr><tr><td style="text-align: right">ADM-6005a_8</td><td style="text-align: right">0.01965</td><td style="text-align: right">0.001808</td><td style="text-align: right">0.4884</td><td style="text-align: right">0.0006735</td><td style="text-align: right">8.944e-05</td><td style="text-align: right">0.0002781</td><td style="text-align: right">0.06805</td><td style="text-align: right">0.0001477</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.0001768</td><td style="text-align: right">0.02812</td><td style="text-align: right">5.011e-05</td><td style="text-align: right">0.02156</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06411</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002939</td><td style="text-align: right">6.953e-05</td><td style="text-align: right">0.0003189</td><td style="text-align: right">0.0005084</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002722</td><td style="text-align: right">0.1239</td><td style="text-align: right">0.001571</td><td style="text-align: right">0.2639</td><td style="text-align: right">0.0005259</td><td style="text-align: right">0.2782</td><td style="text-align: right">0.001909</td></tr><tr><td style="text-align: right">ADM-6005a_9</td><td style="text-align: right">0.02078</td><td style="text-align: right">0.00181</td><td style="text-align: right">0.4885</td><td style="text-align: right">0.0006736</td><td style="text-align: right">0</td><td style="text-align: right">0.01669</td><td style="text-align: right">0.06835</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1791</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02814</td><td style="text-align: right">5.007e-05</td><td style="text-align: right">0.02154</td><td style="text-align: right">5.016e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.000302</td><td style="text-align: right">6.967e-05</td><td style="text-align: right">0.001483</td><td style="text-align: right">0.0005078</td><td style="text-align: right">0.111</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1197</td><td style="text-align: right">0.001571</td><td style="text-align: right">0.2614</td><td style="text-align: right">0.0005256</td><td style="text-align: right">0.2768</td><td style="text-align: right">0.001902</td></tr><tr><td style="text-align: right">ADM-6005a_10</td><td style="text-align: right">0.02461</td><td style="text-align: right">0.001806</td><td style="text-align: right">0.4877</td><td style="text-align: right">0.0006734</td><td style="text-align: right">0.0001256</td><td style="text-align: right">0.000279</td><td style="text-align: right">0.06788</td><td style="text-align: right">0.0001477</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.0001768</td><td style="text-align: right">0.02816</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.0215</td><td style="text-align: right">5.016e-05</td><td style="text-align: right">0.1211</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06386</td><td style="text-align: right">0.0001031</td><td style="text-align: right">0.0001826</td><td style="text-align: right">6.964e-05</td><td style="text-align: right">0.001759</td><td style="text-align: right">0.0005073</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.0002726</td><td style="text-align: right">0.126</td><td style="text-align: right">0.001572</td><td style="text-align: right">0.2627</td><td style="text-align: right">0.0005253</td><td style="text-align: right">0.2751</td><td style="text-align: right">0.001909</td></tr><tr><td style="text-align: right">ADM-6005a_11</td><td style="text-align: right">0.02009</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.4883</td><td style="text-align: right">0.000674</td><td style="text-align: right">0.0002259</td><td style="text-align: right">0.0002791</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.0001768</td><td style="text-align: right">0.02806</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.02156</td><td style="text-align: right">5.017e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06397</td><td style="text-align: right">0.0001031</td><td style="text-align: right">0.0004916</td><td style="text-align: right">6.947e-05</td><td style="text-align: right">0.0008535</td><td style="text-align: right">0.0005053</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.0002721</td><td style="text-align: right">0.1231</td><td style="text-align: right">0.001566</td><td style="text-align: right">0.2633</td><td style="text-align: right">0.0005256</td><td style="text-align: right">0.2719</td><td style="text-align: right">0.001896</td></tr><tr><td style="text-align: right">ADM-6005a_12</td><td style="text-align: right">0.02039</td><td style="text-align: right">0.001812</td><td style="text-align: right">0.4899</td><td style="text-align: right">0.0006749</td><td style="text-align: right">0</td><td style="text-align: right">0.01669</td><td style="text-align: right">0.06789</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02801</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.02151</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1213</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06378</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003361</td><td style="text-align: right">6.939e-05</td><td style="text-align: right">0.001099</td><td style="text-align: right">0.0005068</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002729</td><td style="text-align: right">0.1182</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2624</td><td style="text-align: right">0.0005259</td><td style="text-align: right">0.2734</td><td style="text-align: right">0.001901</td></tr><tr><td style="text-align: right">ADM-6005a_13</td><td style="text-align: right">0.0167</td><td style="text-align: right">0.001813</td><td style="text-align: right">0.4893</td><td style="text-align: right">0.0006747</td><td style="text-align: right">0.0002034</td><td style="text-align: right">0.0002777</td><td style="text-align: right">0.06837</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1794</td><td style="text-align: right">0.0001768</td><td style="text-align: right">0.0281</td><td style="text-align: right">5e-05</td><td style="text-align: right">0.02145</td><td style="text-align: right">5.017e-05</td><td style="text-align: right">0.1216</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06395</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003101</td><td style="text-align: right">6.96e-05</td><td style="text-align: right">0</td><td style="text-align: right">0.02247</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002727</td><td style="text-align: right">0.126</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2632</td><td style="text-align: right">0.0005253</td><td style="text-align: right">0.2795</td><td style="text-align: right">0.001911</td></tr><tr><td style="text-align: right">ADM-6005a_14</td><td style="text-align: right">0.01852</td><td style="text-align: right">0.00181</td><td style="text-align: right">0.4895</td><td style="text-align: right">0.0006742</td><td style="text-align: right">0</td><td style="text-align: right">0.01666</td><td style="text-align: right">0.06805</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1798</td><td style="text-align: right">0.0001768</td><td style="text-align: right">0.02797</td><td style="text-align: right">5.001e-05</td><td style="text-align: right">0.02154</td><td style="text-align: right">5.013e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001689</td><td style="text-align: right">0.06388</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0003892</td><td style="text-align: right">6.958e-05</td><td style="text-align: right">0.0008041</td><td style="text-align: right">0.0005066</td><td style="text-align: right">0.1112</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1229</td><td style="text-align: right">0.001569</td><td style="text-align: right">0.2628</td><td style="text-align: right">0.0005251</td><td style="text-align: right">0.2764</td><td style="text-align: right">0.0019</td></tr><tr><td style="text-align: right">ADM-6005a_15</td><td style="text-align: right">0.01902</td><td style="text-align: right">0.001809</td><td style="text-align: right">0.4903</td><td style="text-align: right">0.0006741</td><td style="text-align: right">0</td><td style="text-align: right">0.01664</td><td style="text-align: right">0.06802</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1799</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02816</td><td style="text-align: right">5.01e-05</td><td style="text-align: right">0.02143</td><td style="text-align: right">5.015e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06409</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002762</td><td style="text-align: right">6.947e-05</td><td style="text-align: right">0.00149</td><td style="text-align: right">0.0005059</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002725</td><td style="text-align: right">0.1225</td><td style="text-align: right">0.001569</td><td style="text-align: right">0.2632</td><td style="text-align: right">0.0005255</td><td style="text-align: right">0.2724</td><td style="text-align: right">0.001903</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[Ti L3-M1 + 6 others, Ti]</td><td style="text-align: right">0.02028</td><td style="text-align: right">0.001823</td><td style="text-align: right">1.008</td><td style="text-align: right">0.0167</td><td style="text-align: right">0.01943</td><td style="text-align: right">0.02009</td><td style="text-align: right">0.02091</td><td style="text-align: right">0.02461</td></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.4887</td><td style="text-align: right">0.001071</td><td style="text-align: right">1.589</td><td style="text-align: right">0.4863</td><td style="text-align: right">0.488</td><td style="text-align: right">0.4885</td><td style="text-align: right">0.4894</td><td style="text-align: right">0.4903</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 11 others, Fe]</td><td style="text-align: right">6.728e-05</td><td style="text-align: right">9.366e-05</td><td style="text-align: right">0.009259</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0001224</td><td style="text-align: right">0.0002456</td></tr><tr><td style="text-align: right">k[Zn L3-M5 + 11 others, Zn]</td><td style="text-align: right">0.06806</td><td style="text-align: right">0.0001951</td><td style="text-align: right">1.321</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.06789</td><td style="text-align: right">0.06802</td><td style="text-align: right">0.06813</td><td style="text-align: right">0.06843</td></tr><tr><td style="text-align: right">k[Ge L3-M5 + 11 others, Ge]</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.0002331</td><td style="text-align: right">1.318</td><td style="text-align: right">0.1791</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.1799</td></tr><tr><td style="text-align: right">k[Al K-L3 + 1 other, Al]</td><td style="text-align: right">0.02808</td><td style="text-align: right">7.824e-05</td><td style="text-align: right">1.563</td><td style="text-align: right">0.02796</td><td style="text-align: right">0.02802</td><td style="text-align: right">0.02808</td><td style="text-align: right">0.02815</td><td style="text-align: right">0.02819</td></tr><tr><td style="text-align: right">k[Si K-L3 + 2 others, Si]</td><td style="text-align: right">0.02148</td><td style="text-align: right">6.205e-05</td><td style="text-align: right">1.237</td><td style="text-align: right">0.02135</td><td style="text-align: right">0.02145</td><td style="text-align: right">0.0215</td><td style="text-align: right">0.02153</td><td style="text-align: right">0.02156</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0002119</td><td style="text-align: right">1.255</td><td style="text-align: right">0.1209</td><td style="text-align: right">0.1213</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.1216</td></tr><tr><td style="text-align: right">k[Ti K-L3 + 3 others, Ti]</td><td style="text-align: right">0.06401</td><td style="text-align: right">0.0001365</td><td style="text-align: right">1.322</td><td style="text-align: right">0.06378</td><td style="text-align: right">0.06394</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.06408</td><td style="text-align: right">0.06433</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.0003043</td><td style="text-align: right">7.438e-05</td><td style="text-align: right">1.069</td><td style="text-align: right">0.0001826</td><td style="text-align: right">0.0002744</td><td style="text-align: right">0.000302</td><td style="text-align: right">0.0003328</td><td style="text-align: right">0.0004916</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.001002</td><td style="text-align: right">0.0005511</td><td style="text-align: right">0.1604</td><td style="text-align: right">0</td><td style="text-align: right">0.0007191</td><td style="text-align: right">0.001213</td><td style="text-align: right">0.001411</td><td style="text-align: right">0.001759</td></tr><tr><td style="text-align: right">k[Zn K-L3 + 1 other, Zn]</td><td style="text-align: right">0.1114</td><td style="text-align: right">0.0002374</td><td style="text-align: right">0.8712</td><td style="text-align: right">0.111</td><td style="text-align: right">0.1112</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.1117</td></tr><tr><td style="text-align: right">k[Zn K-M3 + 3 others, Zn]</td><td style="text-align: right">0.1226</td><td style="text-align: right">0.00254</td><td style="text-align: right">1.619</td><td style="text-align: right">0.1171</td><td style="text-align: right">0.1221</td><td style="text-align: right">0.123</td><td style="text-align: right">0.124</td><td style="text-align: right">0.126</td></tr><tr><td style="text-align: right">k[Ge K-L3 + 1 other, Ge]</td><td style="text-align: right">0.2629</td><td style="text-align: right">0.0007433</td><td style="text-align: right">1.415</td><td style="text-align: right">0.2614</td><td style="text-align: right">0.2624</td><td style="text-align: right">0.2632</td><td style="text-align: right">0.2634</td><td style="text-align: right">0.264</td></tr><tr><td style="text-align: right">k[Ge K-M3 + 3 others, Ge]</td><td style="text-align: right">0.2756</td><td style="text-align: right">0.00295</td><td style="text-align: right">1.55</td><td style="text-align: right">0.271</td><td style="text-align: right">0.2732</td><td style="text-align: right">0.2763</td><td style="text-align: right">0.278</td><td style="text-align: right">0.2805</td></tr></table><pre><code class="language-julia hljs">@btime fit_spectrum(unks[1], frs)</code></pre><pre><code class="nohighlight hljs">1.675 ms (6580 allocations: 1.15 MiB)
ADM-6005a_1</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../XRFspectra/">« Fitting XRF Spectra</a><a class="docs-footer-nextpage" href="../continuummodel/">Modeling the Continuum »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Wednesday 4 August 2021 11:45">Wednesday 4 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
