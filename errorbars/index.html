<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lovely Error Bars · NeXLSpectrum.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
<script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js" type="text/javascript" defer="defer"></script>
<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
</head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="NeXLSpectrum.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NeXLSpectrum.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../spectrum/">Spectrum Methods</a></li><li><a class="tocitem" href="../hyperspectrum/">HyperSpectrum Methods</a></li><li><a class="tocitem" href="../k412refs/">Fitting K412 (simple API)</a></li><li><a class="tocitem" href="../K412fit/">Fitting K412 (flexible API)</a></li><li><a class="tocitem" href="../K412quick/">Fitting K412 (quick fit)</a></li><li><a class="tocitem" href="../XRFspectra/">Fitting XRF Spectra</a></li><li class="is-active"><a class="tocitem" href>Lovely Error Bars</a></li><li><a class="tocitem" href="../continuummodel/">Modeling the Continuum</a></li><li><a class="tocitem" href="../methods/">Methods</a></li><li><a class="tocitem" href="../precompile/">Precompilation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Lovely Error Bars</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lovely Error Bars</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/master/docs/src/errorbars.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h3 id="How-good-are-the-fit-uncertainty-estimates?"><a class="docs-heading-anchor" href="#How-good-are-the-fit-uncertainty-estimates?">How good are the fit uncertainty estimates?</a><a id="How-good-are-the-fit-uncertainty-estimates?-1"></a><a class="docs-heading-anchor-permalink" href="#How-good-are-the-fit-uncertainty-estimates?" title="Permalink"></a></h3><p>This document looks at two different sets of measured spectra to evaluate how well, the estimated fit uncertainties match the observed uncertainties.  We are using two materials known to be highly homogeneous - K412 and ADM-6006a glasses.  To produce a set of spectra that differ only in count statistics, we will subdivide a spectrum into 100 spectra with an effective live-time of 0.01 of the original spectrum livetime.  We expect that we should be able to compare the &quot;fit-predicted&quot; uncertainties with the &quot;observed distribution&quot; of measured values.</p><p>To be clear:</p><ul><li>&quot;fit-predicted&quot; - Comes from the covariance matrix output from the linear least squares fit</li><li>&quot;observed distribution&quot; - Calculated as the standard-deviation of the 100 fit values.</li></ul><p>We want the ratio of the (observed distribution) / (fit predicted) to be unity or close.  We will call this ratio the &quot;heterogeneity&quot; (or &quot;hetero&quot; in the fourth column of the <code>describe(....)</code> table.)</p><p>We then repeat the process on the multiple measured unknown spectra. (4 for K412 and 15 for ADM-6005a)  We expect the heterogeneity to be one or larger - larger than unity when the sample is not perfectly homogeneous.</p><pre><code class="language-julia hljs">using NeXLSpectrum              # Provides spectrum reading and fitting tools
using NeXLMatrixCorrection      # Provides `quant` to convert k-ratios to mass fraction.
using DataFrames                # Tables
using Latexify
using BenchmarkTools</code></pre><h6 id="K412"><a class="docs-heading-anchor" href="#K412">K412</a><a id="K412-1"></a><a class="docs-heading-anchor-permalink" href="#K412" title="Permalink"></a></h6><p>Load the spectra, define the fit model and apply it.</p><pre><code class="language-julia hljs">path = joinpath(@__DIR__,&quot;K412 spectra&quot;)
unks = map(0:4) do i 
  loadspectrum(joinpath(path, &quot;III-E K412[$i][4].msa&quot;))
end
det = matching(unks[1], 132.0, 10)
frs = references( [
  reference(n&quot;Al&quot;, joinpath(path, &quot;Al2O3 std.msa&quot;), mat&quot;Al2O3&quot;),
  reference(n&quot;Mg&quot;, joinpath(path, &quot;MgO std.msa&quot;), mat&quot;MgO&quot;),
  reference(n&quot;Fe&quot;, joinpath(path, &quot;Fe std.msa&quot;), mat&quot;Fe&quot;),
  reference(n&quot;Si&quot;, joinpath(path, &quot;SiO2 std.msa&quot;), mat&quot;SiO2&quot;),
  reference(n&quot;O&quot;, joinpath(path, &quot;SiO2 std.msa&quot;), mat&quot;SiO2&quot;),
  reference(n&quot;Ca&quot;, joinpath(path, &quot;CaF2 std.msa&quot;) ,mat&quot;CaF2&quot;)
], det)
# frs is now a FilteredReference[] used to fit the unknowns.

# Split the counts in unks[1] into 100 randomized spectra which will sum to unks[1] then fit them
res = map(subdivide(unks[1], 100)) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">100-element Vector{FilterFitResult{Float64}}:
 FitResult(Sub[III-E K412[0][all],1 of 100])
 FitResult(Sub[III-E K412[0][all],2 of 100])
 FitResult(Sub[III-E K412[0][all],3 of 100])
 FitResult(Sub[III-E K412[0][all],4 of 100])
 FitResult(Sub[III-E K412[0][all],5 of 100])
 FitResult(Sub[III-E K412[0][all],6 of 100])
 FitResult(Sub[III-E K412[0][all],7 of 100])
 FitResult(Sub[III-E K412[0][all],8 of 100])
 FitResult(Sub[III-E K412[0][all],9 of 100])
 FitResult(Sub[III-E K412[0][all],10 of 100])
 ⋮
 FitResult(Sub[III-E K412[0][all],92 of 100])
 FitResult(Sub[III-E K412[0][all],93 of 100])
 FitResult(Sub[III-E K412[0][all],94 of 100])
 FitResult(Sub[III-E K412[0][all],95 of 100])
 FitResult(Sub[III-E K412[0][all],96 of 100])
 FitResult(Sub[III-E K412[0][all],97 of 100])
 FitResult(Sub[III-E K412[0][all],98 of 100])
 FitResult(Sub[III-E K412[0][all],99 of 100])
 FitResult(Sub[III-E K412[0][all],100 of 100])</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">k[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">Δk[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">k[Al K-L3 + 3 others, Al2O3]</th><th style="text-align: right">Δk[Al K-L3 + 3 others, Al2O3]</th><th style="text-align: right">k[Si K-L3 + 3 others, SiO2]</th><th style="text-align: right">Δk[Si K-L3 + 3 others, SiO2]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],1 of 100]</td><td style="text-align: right">0.6538</td><td style="text-align: right">0.008075</td><td style="text-align: right">0.04216</td><td style="text-align: right">0.004438</td><td style="text-align: right">0.1486</td><td style="text-align: right">0.001831</td><td style="text-align: right">0.06437</td><td style="text-align: right">0.001571</td><td style="text-align: right">0.3557</td><td style="text-align: right">0.002884</td><td style="text-align: right">0.1909</td><td style="text-align: right">0.002319</td><td style="text-align: right">0.0677</td><td style="text-align: right">0.001574</td><td style="text-align: right">0.07131</td><td style="text-align: right">0.00691</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],2 of 100]</td><td style="text-align: right">0.6438</td><td style="text-align: right">0.00806</td><td style="text-align: right">0.03981</td><td style="text-align: right">0.00439</td><td style="text-align: right">0.1472</td><td style="text-align: right">0.001839</td><td style="text-align: right">0.06625</td><td style="text-align: right">0.001587</td><td style="text-align: right">0.3473</td><td style="text-align: right">0.002888</td><td style="text-align: right">0.1908</td><td style="text-align: right">0.002321</td><td style="text-align: right">0.06497</td><td style="text-align: right">0.001596</td><td style="text-align: right">0.073</td><td style="text-align: right">0.006727</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],3 of 100]</td><td style="text-align: right">0.643</td><td style="text-align: right">0.008088</td><td style="text-align: right">0.04069</td><td style="text-align: right">0.004437</td><td style="text-align: right">0.1462</td><td style="text-align: right">0.001828</td><td style="text-align: right">0.06738</td><td style="text-align: right">0.001598</td><td style="text-align: right">0.3563</td><td style="text-align: right">0.002901</td><td style="text-align: right">0.1951</td><td style="text-align: right">0.002316</td><td style="text-align: right">0.06883</td><td style="text-align: right">0.001594</td><td style="text-align: right">0.05761</td><td style="text-align: right">0.006545</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],4 of 100]</td><td style="text-align: right">0.6714</td><td style="text-align: right">0.008175</td><td style="text-align: right">0.04573</td><td style="text-align: right">0.00429</td><td style="text-align: right">0.1496</td><td style="text-align: right">0.001837</td><td style="text-align: right">0.0683</td><td style="text-align: right">0.001591</td><td style="text-align: right">0.3477</td><td style="text-align: right">0.00289</td><td style="text-align: right">0.1964</td><td style="text-align: right">0.002324</td><td style="text-align: right">0.06634</td><td style="text-align: right">0.001584</td><td style="text-align: right">0.05444</td><td style="text-align: right">0.006681</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],5 of 100]</td><td style="text-align: right">0.6611</td><td style="text-align: right">0.008078</td><td style="text-align: right">0.0373</td><td style="text-align: right">0.004324</td><td style="text-align: right">0.1454</td><td style="text-align: right">0.00183</td><td style="text-align: right">0.06489</td><td style="text-align: right">0.001577</td><td style="text-align: right">0.3503</td><td style="text-align: right">0.002872</td><td style="text-align: right">0.1926</td><td style="text-align: right">0.002342</td><td style="text-align: right">0.06801</td><td style="text-align: right">0.001598</td><td style="text-align: right">0.0684</td><td style="text-align: right">0.006855</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],6 of 100]</td><td style="text-align: right">0.6523</td><td style="text-align: right">0.008134</td><td style="text-align: right">0.04701</td><td style="text-align: right">0.004395</td><td style="text-align: right">0.1464</td><td style="text-align: right">0.001825</td><td style="text-align: right">0.06598</td><td style="text-align: right">0.001587</td><td style="text-align: right">0.3478</td><td style="text-align: right">0.002876</td><td style="text-align: right">0.1954</td><td style="text-align: right">0.002336</td><td style="text-align: right">0.06984</td><td style="text-align: right">0.001604</td><td style="text-align: right">0.06209</td><td style="text-align: right">0.006645</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],7 of 100]</td><td style="text-align: right">0.6589</td><td style="text-align: right">0.008152</td><td style="text-align: right">0.04621</td><td style="text-align: right">0.004409</td><td style="text-align: right">0.1471</td><td style="text-align: right">0.001827</td><td style="text-align: right">0.06625</td><td style="text-align: right">0.001586</td><td style="text-align: right">0.3484</td><td style="text-align: right">0.002898</td><td style="text-align: right">0.1913</td><td style="text-align: right">0.002328</td><td style="text-align: right">0.06743</td><td style="text-align: right">0.001609</td><td style="text-align: right">0.06525</td><td style="text-align: right">0.006741</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],8 of 100]</td><td style="text-align: right">0.657</td><td style="text-align: right">0.008094</td><td style="text-align: right">0.04406</td><td style="text-align: right">0.00448</td><td style="text-align: right">0.146</td><td style="text-align: right">0.001827</td><td style="text-align: right">0.06533</td><td style="text-align: right">0.001585</td><td style="text-align: right">0.3493</td><td style="text-align: right">0.002896</td><td style="text-align: right">0.1936</td><td style="text-align: right">0.002331</td><td style="text-align: right">0.06969</td><td style="text-align: right">0.001604</td><td style="text-align: right">0.05916</td><td style="text-align: right">0.006705</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],9 of 100]</td><td style="text-align: right">0.6569</td><td style="text-align: right">0.00813</td><td style="text-align: right">0.03886</td><td style="text-align: right">0.004366</td><td style="text-align: right">0.1492</td><td style="text-align: right">0.001841</td><td style="text-align: right">0.0663</td><td style="text-align: right">0.00159</td><td style="text-align: right">0.351</td><td style="text-align: right">0.002908</td><td style="text-align: right">0.197</td><td style="text-align: right">0.002349</td><td style="text-align: right">0.0657</td><td style="text-align: right">0.001573</td><td style="text-align: right">0.06313</td><td style="text-align: right">0.006895</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],10 of 100]</td><td style="text-align: right">0.649</td><td style="text-align: right">0.008057</td><td style="text-align: right">0.04605</td><td style="text-align: right">0.004435</td><td style="text-align: right">0.148</td><td style="text-align: right">0.001827</td><td style="text-align: right">0.06543</td><td style="text-align: right">0.001574</td><td style="text-align: right">0.3498</td><td style="text-align: right">0.002878</td><td style="text-align: right">0.1899</td><td style="text-align: right">0.002326</td><td style="text-align: right">0.06658</td><td style="text-align: right">0.001589</td><td style="text-align: right">0.08246</td><td style="text-align: right">0.007</td></tr></table><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.6536</td><td style="text-align: right">0.008259</td><td style="text-align: right">1.02</td><td style="text-align: right">0.632</td><td style="text-align: right">0.6485</td><td style="text-align: right">0.6552</td><td style="text-align: right">0.6586</td><td style="text-align: right">0.6738</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</td><td style="text-align: right">0.04191</td><td style="text-align: right">0.003461</td><td style="text-align: right">0.7901</td><td style="text-align: right">0.03515</td><td style="text-align: right">0.03942</td><td style="text-align: right">0.04193</td><td style="text-align: right">0.04412</td><td style="text-align: right">0.05206</td></tr><tr><td style="text-align: right">k[Mg K-L3 + 1 other, MgO]</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.001911</td><td style="text-align: right">1.042</td><td style="text-align: right">0.143</td><td style="text-align: right">0.1463</td><td style="text-align: right">0.1475</td><td style="text-align: right">0.1486</td><td style="text-align: right">0.1535</td></tr><tr><td style="text-align: right">k[Al K-L3 + 3 others, Al2O3]</td><td style="text-align: right">0.06699</td><td style="text-align: right">0.0015</td><td style="text-align: right">0.9439</td><td style="text-align: right">0.06361</td><td style="text-align: right">0.06621</td><td style="text-align: right">0.06708</td><td style="text-align: right">0.06778</td><td style="text-align: right">0.07048</td></tr><tr><td style="text-align: right">k[Si K-L3 + 3 others, SiO2]</td><td style="text-align: right">0.3507</td><td style="text-align: right">0.002909</td><td style="text-align: right">1.007</td><td style="text-align: right">0.3435</td><td style="text-align: right">0.3485</td><td style="text-align: right">0.3508</td><td style="text-align: right">0.3524</td><td style="text-align: right">0.3592</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.002574</td><td style="text-align: right">1.107</td><td style="text-align: right">0.185</td><td style="text-align: right">0.1902</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1939</td><td style="text-align: right">0.1984</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.06683</td><td style="text-align: right">0.001508</td><td style="text-align: right">0.9468</td><td style="text-align: right">0.06296</td><td style="text-align: right">0.06569</td><td style="text-align: right">0.06686</td><td style="text-align: right">0.06784</td><td style="text-align: right">0.07051</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.0669</td><td style="text-align: right">0.006532</td><td style="text-align: right">0.9723</td><td style="text-align: right">0.04932</td><td style="text-align: right">0.06231</td><td style="text-align: right">0.06698</td><td style="text-align: right">0.07106</td><td style="text-align: right">0.08508</td></tr></table><p>Repeat the fit for the 4 measured unknowns.</p><pre><code class="language-julia hljs">res= map(unks) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">5-element Vector{FilterFitResult{Float64}}:
 FitResult(III-E K412[0][all])
 FitResult(III-E K412[1][all])
 FitResult(III-E K412[2][all])
 FitResult(III-E K412[3][all])
 FitResult(III-E K412[4][all])</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">k[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">Δk[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">k[Al K-L3 + 3 others, Al2O3]</th><th style="text-align: right">Δk[Al K-L3 + 3 others, Al2O3]</th><th style="text-align: right">k[Si K-L3 + 3 others, SiO2]</th><th style="text-align: right">Δk[Si K-L3 + 3 others, SiO2]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th></tr><tr><td style="text-align: right">III-E K412[0][all]</td><td style="text-align: right">0.6536</td><td style="text-align: right">0.0008101</td><td style="text-align: right">0.04191</td><td style="text-align: right">0.0004382</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.0001834</td><td style="text-align: right">0.06699</td><td style="text-align: right">0.0001589</td><td style="text-align: right">0.3507</td><td style="text-align: right">0.0002889</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002326</td><td style="text-align: right">0.06683</td><td style="text-align: right">0.0001593</td><td style="text-align: right">0.06684</td><td style="text-align: right">0.0006722</td></tr><tr><td style="text-align: right">III-E K412[1][all]</td><td style="text-align: right">0.6554</td><td style="text-align: right">0.0008108</td><td style="text-align: right">0.04156</td><td style="text-align: right">0.0004372</td><td style="text-align: right">0.1475</td><td style="text-align: right">0.0001835</td><td style="text-align: right">0.06675</td><td style="text-align: right">0.000159</td><td style="text-align: right">0.3499</td><td style="text-align: right">0.0002888</td><td style="text-align: right">0.1916</td><td style="text-align: right">0.0002325</td><td style="text-align: right">0.06708</td><td style="text-align: right">0.0001595</td><td style="text-align: right">0.06738</td><td style="text-align: right">0.0006721</td></tr><tr><td style="text-align: right">III-E K412[2][all]</td><td style="text-align: right">0.656</td><td style="text-align: right">0.0008124</td><td style="text-align: right">0.04191</td><td style="text-align: right">0.0004381</td><td style="text-align: right">0.1479</td><td style="text-align: right">0.0001838</td><td style="text-align: right">0.06709</td><td style="text-align: right">0.0001594</td><td style="text-align: right">0.3511</td><td style="text-align: right">0.0002896</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002329</td><td style="text-align: right">0.06688</td><td style="text-align: right">0.0001596</td><td style="text-align: right">0.06704</td><td style="text-align: right">0.0006737</td></tr><tr><td style="text-align: right">III-E K412[3][all]</td><td style="text-align: right">0.6604</td><td style="text-align: right">0.0008155</td><td style="text-align: right">0.04146</td><td style="text-align: right">0.000438</td><td style="text-align: right">0.1481</td><td style="text-align: right">0.0001841</td><td style="text-align: right">0.06716</td><td style="text-align: right">0.0001595</td><td style="text-align: right">0.3519</td><td style="text-align: right">0.00029</td><td style="text-align: right">0.1925</td><td style="text-align: right">0.0002333</td><td style="text-align: right">0.06682</td><td style="text-align: right">0.0001598</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.0006746</td></tr><tr><td style="text-align: right">III-E K412[4][all]</td><td style="text-align: right">0.6588</td><td style="text-align: right">0.0008149</td><td style="text-align: right">0.04081</td><td style="text-align: right">0.0004383</td><td style="text-align: right">0.1482</td><td style="text-align: right">0.0001841</td><td style="text-align: right">0.06728</td><td style="text-align: right">0.0001597</td><td style="text-align: right">0.3518</td><td style="text-align: right">0.00029</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002333</td><td style="text-align: right">0.06694</td><td style="text-align: right">0.0001598</td><td style="text-align: right">0.06648</td><td style="text-align: right">0.000674</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.6568</td><td style="text-align: right">0.002714</td><td style="text-align: right">3.339</td><td style="text-align: right">0.6536</td><td style="text-align: right">0.6554</td><td style="text-align: right">0.656</td><td style="text-align: right">0.6588</td><td style="text-align: right">0.6604</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</td><td style="text-align: right">0.04153</td><td style="text-align: right">0.0004496</td><td style="text-align: right">1.026</td><td style="text-align: right">0.04081</td><td style="text-align: right">0.04146</td><td style="text-align: right">0.04156</td><td style="text-align: right">0.04191</td><td style="text-align: right">0.04191</td></tr><tr><td style="text-align: right">k[Mg K-L3 + 1 other, MgO]</td><td style="text-align: right">0.1479</td><td style="text-align: right">0.0003027</td><td style="text-align: right">1.647</td><td style="text-align: right">0.1475</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.1479</td><td style="text-align: right">0.1481</td><td style="text-align: right">0.1482</td></tr><tr><td style="text-align: right">k[Al K-L3 + 3 others, Al2O3]</td><td style="text-align: right">0.06705</td><td style="text-align: right">0.000202</td><td style="text-align: right">1.268</td><td style="text-align: right">0.06675</td><td style="text-align: right">0.06699</td><td style="text-align: right">0.06709</td><td style="text-align: right">0.06716</td><td style="text-align: right">0.06728</td></tr><tr><td style="text-align: right">k[Si K-L3 + 3 others, SiO2]</td><td style="text-align: right">0.3511</td><td style="text-align: right">0.000829</td><td style="text-align: right">2.864</td><td style="text-align: right">0.3499</td><td style="text-align: right">0.3507</td><td style="text-align: right">0.3511</td><td style="text-align: right">0.3518</td><td style="text-align: right">0.3519</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1921</td><td style="text-align: right">0.000318</td><td style="text-align: right">1.365</td><td style="text-align: right">0.1916</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1925</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.06691</td><td style="text-align: right">0.0001063</td><td style="text-align: right">0.6661</td><td style="text-align: right">0.06682</td><td style="text-align: right">0.06683</td><td style="text-align: right">0.06688</td><td style="text-align: right">0.06694</td><td style="text-align: right">0.06708</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.06711</td><td style="text-align: right">0.0005071</td><td style="text-align: right">0.7531</td><td style="text-align: right">0.06648</td><td style="text-align: right">0.06684</td><td style="text-align: right">0.06704</td><td style="text-align: right">0.06738</td><td style="text-align: right">0.0678</td></tr></table><pre><code class="language-julia hljs">@btime fit_spectrum(unks[1], frs)</code></pre><pre><code class="nohighlight hljs">291.700 μs (566 allocations: 261.02 KiB)
FitResult(III-E K412[0][all])</code></pre><h6 id="AMM-6005a"><a class="docs-heading-anchor" href="#AMM-6005a">AMM-6005a</a><a id="AMM-6005a-1"></a><a class="docs-heading-anchor-permalink" href="#AMM-6005a" title="Permalink"></a></h6><p>Repeat using the ADM glass.  Fe is not present in ADM-6005a but we fit it to see what a null result looks like.</p><pre><code class="language-julia hljs">path = normpath(joinpath(@__DIR__, &quot;..&quot;,&quot;test&quot;,&quot;ADM6005a spectra&quot;))
unks = map(i-&gt;loadspectrum(joinpath(path,&quot;ADM-6005a_$i.msa&quot;)),1:15)
al, caf2, fe, ge, si, sio2, ti, zn = map(f-&gt;loadspectrum(joinpath(path,&quot;$f.msa&quot;)), (&quot;Al std&quot;, &quot;CaF2 std&quot;, &quot;Fe std&quot;, &quot;Ge std&quot;, &quot;Si std&quot;, &quot;SiO2 std&quot;, &quot;Ti trimmed&quot;,&quot;Zn std&quot;))

det = matching(unks[1], 132.0, 10)

frs = references( [
  reference(n&quot;Al&quot;, al, mat&quot;Al&quot; ), #
  reference(n&quot;Ca&quot;, caf2, mat&quot;CaF2&quot; ),   #
  reference(n&quot;Fe&quot;, fe, mat&quot;Fe&quot; ),    #
  reference(n&quot;Ge&quot;, ge, mat&quot;Ge&quot; ),    #
  reference(n&quot;Si&quot;, si, mat&quot;Si&quot; ),  #
  reference(n&quot;O&quot;, sio2, mat&quot;SiO2&quot; ),  #
  reference(n&quot;Ti&quot;, ti, mat&quot;Ti&quot; ),
  reference(n&quot;Zn&quot;, zn, mat&quot;Zn&quot; ) 
], det)

ss = 
res= map(subdivide(unks[1], 100)) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">100-element Vector{FilterFitResult{Float64}}:
 FitResult(Sub[ADM-6005a_1,1 of 100])
 FitResult(Sub[ADM-6005a_1,2 of 100])
 FitResult(Sub[ADM-6005a_1,3 of 100])
 FitResult(Sub[ADM-6005a_1,4 of 100])
 FitResult(Sub[ADM-6005a_1,5 of 100])
 FitResult(Sub[ADM-6005a_1,6 of 100])
 FitResult(Sub[ADM-6005a_1,7 of 100])
 FitResult(Sub[ADM-6005a_1,8 of 100])
 FitResult(Sub[ADM-6005a_1,9 of 100])
 FitResult(Sub[ADM-6005a_1,10 of 100])
 ⋮
 FitResult(Sub[ADM-6005a_1,92 of 100])
 FitResult(Sub[ADM-6005a_1,93 of 100])
 FitResult(Sub[ADM-6005a_1,94 of 100])
 FitResult(Sub[ADM-6005a_1,95 of 100])
 FitResult(Sub[ADM-6005a_1,96 of 100])
 FitResult(Sub[ADM-6005a_1,97 of 100])
 FitResult(Sub[ADM-6005a_1,98 of 100])
 FitResult(Sub[ADM-6005a_1,99 of 100])
 FitResult(Sub[ADM-6005a_1,100 of 100])</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[Ti L3-M5 + 13 others, Ti]</th><th style="text-align: right">Δk[Ti L3-M5 + 13 others, Ti]</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">k[Zn L3-M5 + 13 others, Zn]</th><th style="text-align: right">Δk[Zn L3-M5 + 13 others, Zn]</th><th style="text-align: right">k[Ge L3-M5 + 15 others, Ge]</th><th style="text-align: right">Δk[Ge L3-M5 + 15 others, Ge]</th><th style="text-align: right">k[Al K-L3 + 3 others, Al]</th><th style="text-align: right">Δk[Al K-L3 + 3 others, Al]</th><th style="text-align: right">k[Si K-L3 + 3 others, Si]</th><th style="text-align: right">Δk[Si K-L3 + 3 others, Si]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">Δk[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">k[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">Δk[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">k[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">Δk[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">k[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">Δk[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">k[Ge K-M3 + 5 others, Ge]</th><th style="text-align: right">Δk[Ge K-M3 + 5 others, Ge]</th></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,1 of 100]</td><td style="text-align: right">0.01715</td><td style="text-align: right">0.01819</td><td style="text-align: right">0.4763</td><td style="text-align: right">0.006686</td><td style="text-align: right">0.000985</td><td style="text-align: right">0.002787</td><td style="text-align: right">0.06969</td><td style="text-align: right">0.001486</td><td style="text-align: right">0.1757</td><td style="text-align: right">0.001765</td><td style="text-align: right">0.02775</td><td style="text-align: right">0.0005049</td><td style="text-align: right">0.02201</td><td style="text-align: right">0.0005003</td><td style="text-align: right">0.115</td><td style="text-align: right">0.001682</td><td style="text-align: right">0.06554</td><td style="text-align: right">0.001036</td><td style="text-align: right">0.0007427</td><td style="text-align: right">0.0006747</td><td style="text-align: right">0.003487</td><td style="text-align: right">0.005247</td><td style="text-align: right">0.1109</td><td style="text-align: right">0.002677</td><td style="text-align: right">0.1094</td><td style="text-align: right">0.01578</td><td style="text-align: right">0.2538</td><td style="text-align: right">0.005234</td><td style="text-align: right">0.268</td><td style="text-align: right">0.01881</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,2 of 100]</td><td style="text-align: right">0.01827</td><td style="text-align: right">0.01828</td><td style="text-align: right">0.4875</td><td style="text-align: right">0.006735</td><td style="text-align: right">0</td><td style="text-align: right">0.002702</td><td style="text-align: right">0.06966</td><td style="text-align: right">0.001475</td><td style="text-align: right">0.1821</td><td style="text-align: right">0.00177</td><td style="text-align: right">0.0287</td><td style="text-align: right">0.0004998</td><td style="text-align: right">0.02128</td><td style="text-align: right">0.0005</td><td style="text-align: right">0.1241</td><td style="text-align: right">0.001674</td><td style="text-align: right">0.06443</td><td style="text-align: right">0.001028</td><td style="text-align: right">0.0005619</td><td style="text-align: right">0.000684</td><td style="text-align: right">0.004611</td><td style="text-align: right">0.005194</td><td style="text-align: right">0.112</td><td style="text-align: right">0.002762</td><td style="text-align: right">0.1619</td><td style="text-align: right">0.01567</td><td style="text-align: right">0.2827</td><td style="text-align: right">0.005347</td><td style="text-align: right">0.2444</td><td style="text-align: right">0.01864</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,3 of 100]</td><td style="text-align: right">0.0322</td><td style="text-align: right">0.01842</td><td style="text-align: right">0.4923</td><td style="text-align: right">0.00674</td><td style="text-align: right">0.002764</td><td style="text-align: right">0.00292</td><td style="text-align: right">0.06944</td><td style="text-align: right">0.001476</td><td style="text-align: right">0.1761</td><td style="text-align: right">0.001764</td><td style="text-align: right">0.02897</td><td style="text-align: right">0.0005068</td><td style="text-align: right">0.02227</td><td style="text-align: right">0.0005062</td><td style="text-align: right">0.1194</td><td style="text-align: right">0.001682</td><td style="text-align: right">0.06353</td><td style="text-align: right">0.001033</td><td style="text-align: right">0.0001854</td><td style="text-align: right">0.0007012</td><td style="text-align: right">0.01708</td><td style="text-align: right">0.005114</td><td style="text-align: right">0.1142</td><td style="text-align: right">0.002699</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.01569</td><td style="text-align: right">0.2502</td><td style="text-align: right">0.00515</td><td style="text-align: right">0.2289</td><td style="text-align: right">0.01861</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,4 of 100]</td><td style="text-align: right">0.0524</td><td style="text-align: right">0.01805</td><td style="text-align: right">0.4837</td><td style="text-align: right">0.006707</td><td style="text-align: right">0.003455</td><td style="text-align: right">0.002792</td><td style="text-align: right">0.06469</td><td style="text-align: right">0.001468</td><td style="text-align: right">0.1799</td><td style="text-align: right">0.001769</td><td style="text-align: right">0.02651</td><td style="text-align: right">0.0004925</td><td style="text-align: right">0.02136</td><td style="text-align: right">0.0004991</td><td style="text-align: right">0.122</td><td style="text-align: right">0.001686</td><td style="text-align: right">0.06291</td><td style="text-align: right">0.001025</td><td style="text-align: right">0.0004902</td><td style="text-align: right">0.0007035</td><td style="text-align: right">0.01035</td><td style="text-align: right">0.00508</td><td style="text-align: right">0.1069</td><td style="text-align: right">0.002743</td><td style="text-align: right">0.121</td><td style="text-align: right">0.01569</td><td style="text-align: right">0.2541</td><td style="text-align: right">0.005246</td><td style="text-align: right">0.2524</td><td style="text-align: right">0.01896</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,5 of 100]</td><td style="text-align: right">0.0002562</td><td style="text-align: right">0.01767</td><td style="text-align: right">0.487</td><td style="text-align: right">0.006768</td><td style="text-align: right">0</td><td style="text-align: right">0.002727</td><td style="text-align: right">0.07283</td><td style="text-align: right">0.001479</td><td style="text-align: right">0.1827</td><td style="text-align: right">0.00178</td><td style="text-align: right">0.02866</td><td style="text-align: right">0.0005074</td><td style="text-align: right">0.02227</td><td style="text-align: right">0.0005078</td><td style="text-align: right">0.1234</td><td style="text-align: right">0.001689</td><td style="text-align: right">0.06352</td><td style="text-align: right">0.001038</td><td style="text-align: right">0</td><td style="text-align: right">0.0006952</td><td style="text-align: right">0</td><td style="text-align: right">0.004966</td><td style="text-align: right">0.1189</td><td style="text-align: right">0.002716</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.01565</td><td style="text-align: right">0.2709</td><td style="text-align: right">0.005318</td><td style="text-align: right">0.2589</td><td style="text-align: right">0.01958</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,6 of 100]</td><td style="text-align: right">0.02306</td><td style="text-align: right">0.0181</td><td style="text-align: right">0.4812</td><td style="text-align: right">0.006723</td><td style="text-align: right">0</td><td style="text-align: right">0.002734</td><td style="text-align: right">0.06618</td><td style="text-align: right">0.001462</td><td style="text-align: right">0.1806</td><td style="text-align: right">0.001764</td><td style="text-align: right">0.02709</td><td style="text-align: right">0.0004969</td><td style="text-align: right">0.02083</td><td style="text-align: right">0.0004982</td><td style="text-align: right">0.1226</td><td style="text-align: right">0.001685</td><td style="text-align: right">0.0649</td><td style="text-align: right">0.001027</td><td style="text-align: right">0</td><td style="text-align: right">0.0006779</td><td style="text-align: right">0.0002667</td><td style="text-align: right">0.004972</td><td style="text-align: right">0.1194</td><td style="text-align: right">0.002748</td><td style="text-align: right">0.0954</td><td style="text-align: right">0.01498</td><td style="text-align: right">0.2641</td><td style="text-align: right">0.005218</td><td style="text-align: right">0.278</td><td style="text-align: right">0.01916</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,7 of 100]</td><td style="text-align: right">0.005544</td><td style="text-align: right">0.01804</td><td style="text-align: right">0.485</td><td style="text-align: right">0.006674</td><td style="text-align: right">0</td><td style="text-align: right">0.002763</td><td style="text-align: right">0.06924</td><td style="text-align: right">0.001466</td><td style="text-align: right">0.1786</td><td style="text-align: right">0.001756</td><td style="text-align: right">0.0283</td><td style="text-align: right">0.000503</td><td style="text-align: right">0.021</td><td style="text-align: right">0.000503</td><td style="text-align: right">0.1219</td><td style="text-align: right">0.001695</td><td style="text-align: right">0.06693</td><td style="text-align: right">0.001034</td><td style="text-align: right">0.001133</td><td style="text-align: right">0.0006931</td><td style="text-align: right">0.006329</td><td style="text-align: right">0.005147</td><td style="text-align: right">0.1143</td><td style="text-align: right">0.00276</td><td style="text-align: right">0.1483</td><td style="text-align: right">0.0159</td><td style="text-align: right">0.2708</td><td style="text-align: right">0.005258</td><td style="text-align: right">0.2378</td><td style="text-align: right">0.01838</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,8 of 100]</td><td style="text-align: right">0.01364</td><td style="text-align: right">0.01792</td><td style="text-align: right">0.486</td><td style="text-align: right">0.006724</td><td style="text-align: right">0.001811</td><td style="text-align: right">0.002872</td><td style="text-align: right">0.0682</td><td style="text-align: right">0.001485</td><td style="text-align: right">0.1767</td><td style="text-align: right">0.001759</td><td style="text-align: right">0.0273</td><td style="text-align: right">0.0004987</td><td style="text-align: right">0.02101</td><td style="text-align: right">0.0004993</td><td style="text-align: right">0.1235</td><td style="text-align: right">0.001689</td><td style="text-align: right">0.06345</td><td style="text-align: right">0.001028</td><td style="text-align: right">0.001232</td><td style="text-align: right">0.0007136</td><td style="text-align: right">0.007105</td><td style="text-align: right">0.005165</td><td style="text-align: right">0.1097</td><td style="text-align: right">0.002725</td><td style="text-align: right">0.1297</td><td style="text-align: right">0.01582</td><td style="text-align: right">0.2737</td><td style="text-align: right">0.005364</td><td style="text-align: right">0.2913</td><td style="text-align: right">0.01914</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,9 of 100]</td><td style="text-align: right">0.03225</td><td style="text-align: right">0.01788</td><td style="text-align: right">0.4848</td><td style="text-align: right">0.006746</td><td style="text-align: right">0</td><td style="text-align: right">0.00279</td><td style="text-align: right">0.06824</td><td style="text-align: right">0.001487</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.001774</td><td style="text-align: right">0.02782</td><td style="text-align: right">0.0004993</td><td style="text-align: right">0.02068</td><td style="text-align: right">0.0004981</td><td style="text-align: right">0.1235</td><td style="text-align: right">0.001698</td><td style="text-align: right">0.06417</td><td style="text-align: right">0.001031</td><td style="text-align: right">0</td><td style="text-align: right">0.0006982</td><td style="text-align: right">0</td><td style="text-align: right">0.004931</td><td style="text-align: right">0.1138</td><td style="text-align: right">0.002688</td><td style="text-align: right">0.1068</td><td style="text-align: right">0.01582</td><td style="text-align: right">0.2705</td><td style="text-align: right">0.005279</td><td style="text-align: right">0.2545</td><td style="text-align: right">0.01895</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,10 of 100]</td><td style="text-align: right">0.006674</td><td style="text-align: right">0.01835</td><td style="text-align: right">0.4837</td><td style="text-align: right">0.006785</td><td style="text-align: right">0.003991</td><td style="text-align: right">0.002899</td><td style="text-align: right">0.06693</td><td style="text-align: right">0.001468</td><td style="text-align: right">0.182</td><td style="text-align: right">0.001776</td><td style="text-align: right">0.02971</td><td style="text-align: right">0.0005091</td><td style="text-align: right">0.02143</td><td style="text-align: right">0.0005028</td><td style="text-align: right">0.1245</td><td style="text-align: right">0.0017</td><td style="text-align: right">0.06301</td><td style="text-align: right">0.001039</td><td style="text-align: right">0</td><td style="text-align: right">0.0006824</td><td style="text-align: right">0</td><td style="text-align: right">0.005233</td><td style="text-align: right">0.1128</td><td style="text-align: right">0.002765</td><td style="text-align: right">0.1246</td><td style="text-align: right">0.01561</td><td style="text-align: right">0.2642</td><td style="text-align: right">0.005274</td><td style="text-align: right">0.2996</td><td style="text-align: right">0.01969</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[Ti L3-M5 + 13 others, Ti]</td><td style="text-align: right">0.02107</td><td style="text-align: right">0.01601</td><td style="text-align: right">0.8875</td><td style="text-align: right">0</td><td style="text-align: right">0.006446</td><td style="text-align: right">0.01928</td><td style="text-align: right">0.03279</td><td style="text-align: right">0.05741</td></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.4877</td><td style="text-align: right">0.0102</td><td style="text-align: right">1.524</td><td style="text-align: right">0.4636</td><td style="text-align: right">0.4812</td><td style="text-align: right">0.4865</td><td style="text-align: right">0.4949</td><td style="text-align: right">0.5095</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</td><td style="text-align: right">0.001105</td><td style="text-align: right">0.001439</td><td style="text-align: right">0.514</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0003555</td><td style="text-align: right">0.00183</td><td style="text-align: right">0.005188</td></tr><tr><td style="text-align: right">k[Zn L3-M5 + 13 others, Zn]</td><td style="text-align: right">0.06813</td><td style="text-align: right">0.002081</td><td style="text-align: right">1.411</td><td style="text-align: right">0.06273</td><td style="text-align: right">0.06664</td><td style="text-align: right">0.06842</td><td style="text-align: right">0.0696</td><td style="text-align: right">0.07283</td></tr><tr><td style="text-align: right">k[Ge L3-M5 + 15 others, Ge]</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.00242</td><td style="text-align: right">1.368</td><td style="text-align: right">0.1722</td><td style="text-align: right">0.1778</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.181</td><td style="text-align: right">0.1859</td></tr><tr><td style="text-align: right">k[Al K-L3 + 3 others, Al]</td><td style="text-align: right">0.028</td><td style="text-align: right">0.0007355</td><td style="text-align: right">1.471</td><td style="text-align: right">0.02651</td><td style="text-align: right">0.02755</td><td style="text-align: right">0.02797</td><td style="text-align: right">0.02856</td><td style="text-align: right">0.02993</td></tr><tr><td style="text-align: right">k[Si K-L3 + 3 others, Si]</td><td style="text-align: right">0.02143</td><td style="text-align: right">0.0006718</td><td style="text-align: right">1.339</td><td style="text-align: right">0.01995</td><td style="text-align: right">0.021</td><td style="text-align: right">0.02133</td><td style="text-align: right">0.02193</td><td style="text-align: right">0.02295</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.002626</td><td style="text-align: right">1.557</td><td style="text-align: right">0.115</td><td style="text-align: right">0.1195</td><td style="text-align: right">0.1213</td><td style="text-align: right">0.123</td><td style="text-align: right">0.1298</td></tr><tr><td style="text-align: right">k[Ti K-L3 + 3 others, Ti]</td><td style="text-align: right">0.06433</td><td style="text-align: right">0.001447</td><td style="text-align: right">1.401</td><td style="text-align: right">0.06133</td><td style="text-align: right">0.06334</td><td style="text-align: right">0.06433</td><td style="text-align: right">0.06516</td><td style="text-align: right">0.06773</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.0004635</td><td style="text-align: right">0.0005114</td><td style="text-align: right">0.7346</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0003835</td><td style="text-align: right">0.0007281</td><td style="text-align: right">0.001958</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.003237</td><td style="text-align: right">0.004005</td><td style="text-align: right">0.7915</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.001806</td><td style="text-align: right">0.005287</td><td style="text-align: right">0.01708</td></tr><tr><td style="text-align: right">k[Zn K-L3 + 1 other, Zn]</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.003733</td><td style="text-align: right">1.37</td><td style="text-align: right">0.1038</td><td style="text-align: right">0.109</td><td style="text-align: right">0.111</td><td style="text-align: right">0.1141</td><td style="text-align: right">0.1215</td></tr><tr><td style="text-align: right">k[Zn K-M3 + 3 others, Zn]</td><td style="text-align: right">0.1228</td><td style="text-align: right">0.02056</td><td style="text-align: right">1.31</td><td style="text-align: right">0.05468</td><td style="text-align: right">0.1081</td><td style="text-align: right">0.1216</td><td style="text-align: right">0.1386</td><td style="text-align: right">0.1675</td></tr><tr><td style="text-align: right">k[Ge K-L3 + 1 other, Ge]</td><td style="text-align: right">0.2635</td><td style="text-align: right">0.007333</td><td style="text-align: right">1.395</td><td style="text-align: right">0.2346</td><td style="text-align: right">0.2589</td><td style="text-align: right">0.2641</td><td style="text-align: right">0.2686</td><td style="text-align: right">0.2827</td></tr><tr><td style="text-align: right">k[Ge K-M3 + 5 others, Ge]</td><td style="text-align: right">0.2705</td><td style="text-align: right">0.02089</td><td style="text-align: right">1.097</td><td style="text-align: right">0.2229</td><td style="text-align: right">0.256</td><td style="text-align: right">0.2709</td><td style="text-align: right">0.2832</td><td style="text-align: right">0.3265</td></tr></table><p>Repeat for the 15 measured spectra.</p><pre><code class="language-julia hljs">res= map(unks) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">15-element Vector{FilterFitResult{Float64}}:
 FitResult(ADM-6005a_1)
 FitResult(ADM-6005a_2)
 FitResult(ADM-6005a_3)
 FitResult(ADM-6005a_4)
 FitResult(ADM-6005a_5)
 FitResult(ADM-6005a_6)
 FitResult(ADM-6005a_7)
 FitResult(ADM-6005a_8)
 FitResult(ADM-6005a_9)
 FitResult(ADM-6005a_10)
 FitResult(ADM-6005a_11)
 FitResult(ADM-6005a_12)
 FitResult(ADM-6005a_13)
 FitResult(ADM-6005a_14)
 FitResult(ADM-6005a_15)</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[Ti L3-M5 + 13 others, Ti]</th><th style="text-align: right">Δk[Ti L3-M5 + 13 others, Ti]</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">k[Zn L3-M5 + 13 others, Zn]</th><th style="text-align: right">Δk[Zn L3-M5 + 13 others, Zn]</th><th style="text-align: right">k[Ge L3-M5 + 15 others, Ge]</th><th style="text-align: right">Δk[Ge L3-M5 + 15 others, Ge]</th><th style="text-align: right">k[Al K-L3 + 3 others, Al]</th><th style="text-align: right">Δk[Al K-L3 + 3 others, Al]</th><th style="text-align: right">k[Si K-L3 + 3 others, Si]</th><th style="text-align: right">Δk[Si K-L3 + 3 others, Si]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">Δk[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">k[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">Δk[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">k[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">Δk[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">k[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">Δk[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">k[Ge K-M3 + 5 others, Ge]</th><th style="text-align: right">Δk[Ge K-M3 + 5 others, Ge]</th></tr><tr><td style="text-align: right">ADM-6005a_1</td><td style="text-align: right">0.01964</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.4876</td><td style="text-align: right">0.0006729</td><td style="text-align: right">0.0001275</td><td style="text-align: right">0.0002801</td><td style="text-align: right">0.06814</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.028</td><td style="text-align: right">5.002e-05</td><td style="text-align: right">0.02143</td><td style="text-align: right">5.017e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06433</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002048</td><td style="text-align: right">6.966e-05</td><td style="text-align: right">0.001265</td><td style="text-align: right">0.0005064</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.0002725</td><td style="text-align: right">0.1226</td><td style="text-align: right">0.001569</td><td style="text-align: right">0.2635</td><td style="text-align: right">0.0005255</td><td style="text-align: right">0.2701</td><td style="text-align: right">0.001897</td></tr><tr><td style="text-align: right">ADM-6005a_2</td><td style="text-align: right">0.02053</td><td style="text-align: right">0.001806</td><td style="text-align: right">0.4863</td><td style="text-align: right">0.0006728</td><td style="text-align: right">0</td><td style="text-align: right">0.0002776</td><td style="text-align: right">0.06796</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02793</td><td style="text-align: right">5.002e-05</td><td style="text-align: right">0.02146</td><td style="text-align: right">5.012e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06393</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003342</td><td style="text-align: right">6.935e-05</td><td style="text-align: right">0.001418</td><td style="text-align: right">0.0005071</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.0002728</td><td style="text-align: right">0.1226</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2641</td><td style="text-align: right">0.0005258</td><td style="text-align: right">0.277</td><td style="text-align: right">0.001901</td></tr><tr><td style="text-align: right">ADM-6005a_3</td><td style="text-align: right">0.02108</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.4894</td><td style="text-align: right">0.0006737</td><td style="text-align: right">0.0002538</td><td style="text-align: right">0.0002783</td><td style="text-align: right">0.06801</td><td style="text-align: right">0.0001477</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02805</td><td style="text-align: right">5.003e-05</td><td style="text-align: right">0.02136</td><td style="text-align: right">5.011e-05</td><td style="text-align: right">0.1216</td><td style="text-align: right">0.0001689</td><td style="text-align: right">0.06404</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002986</td><td style="text-align: right">6.974e-05</td><td style="text-align: right">0.0006342</td><td style="text-align: right">0.0005059</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1155</td><td style="text-align: right">0.001567</td><td style="text-align: right">0.2623</td><td style="text-align: right">0.0005252</td><td style="text-align: right">0.2797</td><td style="text-align: right">0.001901</td></tr><tr><td style="text-align: right">ADM-6005a_4</td><td style="text-align: right">0.01931</td><td style="text-align: right">0.001807</td><td style="text-align: right">0.488</td><td style="text-align: right">0.0006737</td><td style="text-align: right">0</td><td style="text-align: right">0.0002786</td><td style="text-align: right">0.06843</td><td style="text-align: right">0.0001479</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.0001771</td><td style="text-align: right">0.02801</td><td style="text-align: right">5.007e-05</td><td style="text-align: right">0.02149</td><td style="text-align: right">5.02e-05</td><td style="text-align: right">0.1211</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003314</td><td style="text-align: right">6.985e-05</td><td style="text-align: right">0.001286</td><td style="text-align: right">0.0005073</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002729</td><td style="text-align: right">0.1204</td><td style="text-align: right">0.001567</td><td style="text-align: right">0.2636</td><td style="text-align: right">0.0005254</td><td style="text-align: right">0.2755</td><td style="text-align: right">0.001903</td></tr><tr><td style="text-align: right">ADM-6005a_5</td><td style="text-align: right">0.01983</td><td style="text-align: right">0.001807</td><td style="text-align: right">0.488</td><td style="text-align: right">0.0006734</td><td style="text-align: right">0</td><td style="text-align: right">0.0002782</td><td style="text-align: right">0.06789</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02816</td><td style="text-align: right">5.007e-05</td><td style="text-align: right">0.02133</td><td style="text-align: right">5.013e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001689</td><td style="text-align: right">0.06406</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002726</td><td style="text-align: right">6.967e-05</td><td style="text-align: right">0.001403</td><td style="text-align: right">0.0005061</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002724</td><td style="text-align: right">0.1207</td><td style="text-align: right">0.001562</td><td style="text-align: right">0.2625</td><td style="text-align: right">0.0005253</td><td style="text-align: right">0.2731</td><td style="text-align: right">0.001898</td></tr><tr><td style="text-align: right">ADM-6005a_6</td><td style="text-align: right">0.02264</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.4892</td><td style="text-align: right">0.000673</td><td style="text-align: right">0</td><td style="text-align: right">0.0002779</td><td style="text-align: right">0.06812</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1792</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02814</td><td style="text-align: right">5.01e-05</td><td style="text-align: right">0.02142</td><td style="text-align: right">5.017e-05</td><td style="text-align: right">0.1209</td><td style="text-align: right">0.0001686</td><td style="text-align: right">0.06397</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002285</td><td style="text-align: right">6.936e-05</td><td style="text-align: right">0.001213</td><td style="text-align: right">0.0005055</td><td style="text-align: right">0.1111</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.122</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.262</td><td style="text-align: right">0.0005253</td><td style="text-align: right">0.2777</td><td style="text-align: right">0.001896</td></tr><tr><td style="text-align: right">ADM-6005a_7</td><td style="text-align: right">0.02164</td><td style="text-align: right">0.001811</td><td style="text-align: right">0.4897</td><td style="text-align: right">0.0006747</td><td style="text-align: right">0</td><td style="text-align: right">0.0002782</td><td style="text-align: right">0.06787</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02795</td><td style="text-align: right">5.004e-05</td><td style="text-align: right">0.02148</td><td style="text-align: right">5.013e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001689</td><td style="text-align: right">0.0642</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0003133</td><td style="text-align: right">6.951e-05</td><td style="text-align: right">0</td><td style="text-align: right">0.0005048</td><td style="text-align: right">0.1111</td><td style="text-align: right">0.0002731</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.001572</td><td style="text-align: right">0.2636</td><td style="text-align: right">0.0005267</td><td style="text-align: right">0.2723</td><td style="text-align: right">0.001897</td></tr><tr><td style="text-align: right">ADM-6005a_8</td><td style="text-align: right">0.01968</td><td style="text-align: right">0.001808</td><td style="text-align: right">0.4884</td><td style="text-align: right">0.0006733</td><td style="text-align: right">9.754e-05</td><td style="text-align: right">0.0002781</td><td style="text-align: right">0.06805</td><td style="text-align: right">0.0001477</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02809</td><td style="text-align: right">5.011e-05</td><td style="text-align: right">0.02154</td><td style="text-align: right">5.02e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06411</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002939</td><td style="text-align: right">6.953e-05</td><td style="text-align: right">0.0003188</td><td style="text-align: right">0.0005084</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002722</td><td style="text-align: right">0.1223</td><td style="text-align: right">0.001571</td><td style="text-align: right">0.264</td><td style="text-align: right">0.0005262</td><td style="text-align: right">0.2774</td><td style="text-align: right">0.001905</td></tr><tr><td style="text-align: right">ADM-6005a_9</td><td style="text-align: right">0.02081</td><td style="text-align: right">0.00181</td><td style="text-align: right">0.4885</td><td style="text-align: right">0.0006735</td><td style="text-align: right">0</td><td style="text-align: right">0.0002785</td><td style="text-align: right">0.06835</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1792</td><td style="text-align: right">0.0001771</td><td style="text-align: right">0.02811</td><td style="text-align: right">5.008e-05</td><td style="text-align: right">0.02152</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.000302</td><td style="text-align: right">6.967e-05</td><td style="text-align: right">0.001483</td><td style="text-align: right">0.0005078</td><td style="text-align: right">0.111</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1181</td><td style="text-align: right">0.00157</td><td style="text-align: right">0.2615</td><td style="text-align: right">0.0005259</td><td style="text-align: right">0.2759</td><td style="text-align: right">0.001897</td></tr><tr><td style="text-align: right">ADM-6005a_10</td><td style="text-align: right">0.02465</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.4877</td><td style="text-align: right">0.0006733</td><td style="text-align: right">0.0001351</td><td style="text-align: right">0.000279</td><td style="text-align: right">0.06788</td><td style="text-align: right">0.0001477</td><td style="text-align: right">0.1798</td><td style="text-align: right">0.0001771</td><td style="text-align: right">0.02813</td><td style="text-align: right">5.007e-05</td><td style="text-align: right">0.02147</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1211</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06386</td><td style="text-align: right">0.0001031</td><td style="text-align: right">0.0001826</td><td style="text-align: right">6.964e-05</td><td style="text-align: right">0.001759</td><td style="text-align: right">0.0005073</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.0002726</td><td style="text-align: right">0.1244</td><td style="text-align: right">0.001571</td><td style="text-align: right">0.2628</td><td style="text-align: right">0.0005256</td><td style="text-align: right">0.2743</td><td style="text-align: right">0.001905</td></tr><tr><td style="text-align: right">ADM-6005a_11</td><td style="text-align: right">0.02014</td><td style="text-align: right">0.001804</td><td style="text-align: right">0.4883</td><td style="text-align: right">0.0006738</td><td style="text-align: right">0.0002345</td><td style="text-align: right">0.0002791</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02803</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.02154</td><td style="text-align: right">5.019e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06397</td><td style="text-align: right">0.0001031</td><td style="text-align: right">0.0004916</td><td style="text-align: right">6.947e-05</td><td style="text-align: right">0.0008535</td><td style="text-align: right">0.0005053</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.0002721</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.001565</td><td style="text-align: right">0.2634</td><td style="text-align: right">0.0005259</td><td style="text-align: right">0.2711</td><td style="text-align: right">0.001892</td></tr><tr><td style="text-align: right">ADM-6005a_12</td><td style="text-align: right">0.02042</td><td style="text-align: right">0.001811</td><td style="text-align: right">0.4899</td><td style="text-align: right">0.0006747</td><td style="text-align: right">0</td><td style="text-align: right">0.0002787</td><td style="text-align: right">0.06789</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.0001771</td><td style="text-align: right">0.02798</td><td style="text-align: right">5.007e-05</td><td style="text-align: right">0.02149</td><td style="text-align: right">5.02e-05</td><td style="text-align: right">0.1213</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06378</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003361</td><td style="text-align: right">6.939e-05</td><td style="text-align: right">0.001099</td><td style="text-align: right">0.0005068</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002729</td><td style="text-align: right">0.1166</td><td style="text-align: right">0.001567</td><td style="text-align: right">0.2625</td><td style="text-align: right">0.0005262</td><td style="text-align: right">0.2726</td><td style="text-align: right">0.001897</td></tr><tr><td style="text-align: right">ADM-6005a_13</td><td style="text-align: right">0.01675</td><td style="text-align: right">0.001812</td><td style="text-align: right">0.4893</td><td style="text-align: right">0.0006745</td><td style="text-align: right">0.0002109</td><td style="text-align: right">0.0002777</td><td style="text-align: right">0.06837</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1794</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02807</td><td style="text-align: right">5.001e-05</td><td style="text-align: right">0.02142</td><td style="text-align: right">5.019e-05</td><td style="text-align: right">0.1216</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06395</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003101</td><td style="text-align: right">6.96e-05</td><td style="text-align: right">0</td><td style="text-align: right">0.0005047</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002727</td><td style="text-align: right">0.1245</td><td style="text-align: right">0.001567</td><td style="text-align: right">0.2633</td><td style="text-align: right">0.0005256</td><td style="text-align: right">0.2786</td><td style="text-align: right">0.001907</td></tr><tr><td style="text-align: right">ADM-6005a_14</td><td style="text-align: right">0.01856</td><td style="text-align: right">0.001809</td><td style="text-align: right">0.4895</td><td style="text-align: right">0.0006741</td><td style="text-align: right">0</td><td style="text-align: right">0.0002776</td><td style="text-align: right">0.06805</td><td style="text-align: right">0.0001477</td><td style="text-align: right">0.1798</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02794</td><td style="text-align: right">5.001e-05</td><td style="text-align: right">0.02152</td><td style="text-align: right">5.015e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001689</td><td style="text-align: right">0.06388</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0003892</td><td style="text-align: right">6.958e-05</td><td style="text-align: right">0.0008041</td><td style="text-align: right">0.0005066</td><td style="text-align: right">0.1112</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1213</td><td style="text-align: right">0.001569</td><td style="text-align: right">0.2629</td><td style="text-align: right">0.0005254</td><td style="text-align: right">0.2756</td><td style="text-align: right">0.001896</td></tr><tr><td style="text-align: right">ADM-6005a_15</td><td style="text-align: right">0.01905</td><td style="text-align: right">0.001808</td><td style="text-align: right">0.4903</td><td style="text-align: right">0.0006739</td><td style="text-align: right">0</td><td style="text-align: right">0.000277</td><td style="text-align: right">0.06802</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1799</td><td style="text-align: right">0.0001772</td><td style="text-align: right">0.02813</td><td style="text-align: right">5.011e-05</td><td style="text-align: right">0.02141</td><td style="text-align: right">5.017e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06409</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002762</td><td style="text-align: right">6.947e-05</td><td style="text-align: right">0.00149</td><td style="text-align: right">0.0005059</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002725</td><td style="text-align: right">0.1209</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2632</td><td style="text-align: right">0.0005258</td><td style="text-align: right">0.2716</td><td style="text-align: right">0.001898</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[Ti L3-M5 + 13 others, Ti]</td><td style="text-align: right">0.02031</td><td style="text-align: right">0.001821</td><td style="text-align: right">1.008</td><td style="text-align: right">0.01675</td><td style="text-align: right">0.01947</td><td style="text-align: right">0.02014</td><td style="text-align: right">0.02094</td><td style="text-align: right">0.02465</td></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.4887</td><td style="text-align: right">0.001071</td><td style="text-align: right">1.589</td><td style="text-align: right">0.4863</td><td style="text-align: right">0.488</td><td style="text-align: right">0.4885</td><td style="text-align: right">0.4894</td><td style="text-align: right">0.4903</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</td><td style="text-align: right">7.062e-05</td><td style="text-align: right">9.75e-05</td><td style="text-align: right">0.3503</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0001313</td><td style="text-align: right">0.0002538</td></tr><tr><td style="text-align: right">k[Zn L3-M5 + 13 others, Zn]</td><td style="text-align: right">0.06805</td><td style="text-align: right">0.0001951</td><td style="text-align: right">1.322</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.06789</td><td style="text-align: right">0.06802</td><td style="text-align: right">0.06813</td><td style="text-align: right">0.06843</td></tr><tr><td style="text-align: right">k[Ge L3-M5 + 15 others, Ge]</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.0002331</td><td style="text-align: right">1.317</td><td style="text-align: right">0.1792</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.1799</td></tr><tr><td style="text-align: right">k[Al K-L3 + 3 others, Al]</td><td style="text-align: right">0.02805</td><td style="text-align: right">7.811e-05</td><td style="text-align: right">1.56</td><td style="text-align: right">0.02793</td><td style="text-align: right">0.02799</td><td style="text-align: right">0.02805</td><td style="text-align: right">0.02812</td><td style="text-align: right">0.02816</td></tr><tr><td style="text-align: right">k[Si K-L3 + 3 others, Si]</td><td style="text-align: right">0.02146</td><td style="text-align: right">6.203e-05</td><td style="text-align: right">1.236</td><td style="text-align: right">0.02133</td><td style="text-align: right">0.02142</td><td style="text-align: right">0.02147</td><td style="text-align: right">0.0215</td><td style="text-align: right">0.02154</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0002119</td><td style="text-align: right">1.255</td><td style="text-align: right">0.1209</td><td style="text-align: right">0.1213</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.1216</td></tr><tr><td style="text-align: right">k[Ti K-L3 + 3 others, Ti]</td><td style="text-align: right">0.06401</td><td style="text-align: right">0.0001365</td><td style="text-align: right">1.322</td><td style="text-align: right">0.06378</td><td style="text-align: right">0.06394</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.06408</td><td style="text-align: right">0.06433</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.0003043</td><td style="text-align: right">7.438e-05</td><td style="text-align: right">1.069</td><td style="text-align: right">0.0001826</td><td style="text-align: right">0.0002744</td><td style="text-align: right">0.000302</td><td style="text-align: right">0.0003328</td><td style="text-align: right">0.0004916</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.001002</td><td style="text-align: right">0.0005511</td><td style="text-align: right">1.088</td><td style="text-align: right">0</td><td style="text-align: right">0.0007191</td><td style="text-align: right">0.001213</td><td style="text-align: right">0.001411</td><td style="text-align: right">0.001759</td></tr><tr><td style="text-align: right">k[Zn K-L3 + 1 other, Zn]</td><td style="text-align: right">0.1114</td><td style="text-align: right">0.0002374</td><td style="text-align: right">0.8712</td><td style="text-align: right">0.111</td><td style="text-align: right">0.1112</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.1117</td></tr><tr><td style="text-align: right">k[Zn K-M3 + 3 others, Zn]</td><td style="text-align: right">0.121</td><td style="text-align: right">0.00254</td><td style="text-align: right">1.62</td><td style="text-align: right">0.1155</td><td style="text-align: right">0.1206</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.1224</td><td style="text-align: right">0.1245</td></tr><tr><td style="text-align: right">k[Ge K-L3 + 1 other, Ge]</td><td style="text-align: right">0.263</td><td style="text-align: right">0.0007443</td><td style="text-align: right">1.416</td><td style="text-align: right">0.2615</td><td style="text-align: right">0.2625</td><td style="text-align: right">0.2632</td><td style="text-align: right">0.2635</td><td style="text-align: right">0.2641</td></tr><tr><td style="text-align: right">k[Ge K-M3 + 5 others, Ge]</td><td style="text-align: right">0.2748</td><td style="text-align: right">0.002941</td><td style="text-align: right">1.549</td><td style="text-align: right">0.2701</td><td style="text-align: right">0.2724</td><td style="text-align: right">0.2755</td><td style="text-align: right">0.2772</td><td style="text-align: right">0.2797</td></tr></table><pre><code class="language-julia hljs">@btime fit_spectrum(unks[1], frs)</code></pre><pre><code class="nohighlight hljs">410.900 μs (1043 allocations: 611.44 KiB)
FitResult(ADM-6005a_1)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../XRFspectra/">« Fitting XRF Spectra</a><a class="docs-footer-nextpage" href="../continuummodel/">Modeling the Continuum »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 27 June 2023 12:20">Tuesday 27 June 2023</span>. Using Julia version 1.9.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
