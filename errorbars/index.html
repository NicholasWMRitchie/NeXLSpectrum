<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lovely Error Bars · NeXLSpectrum.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
<script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js" type="text/javascript" defer="defer"></script>
<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
</head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="NeXLSpectrum.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">NeXLSpectrum.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../spectrum/">Spectrum Methods</a></li><li><a class="tocitem" href="../k412refs/">Fitting K412 (simple API)</a></li><li><a class="tocitem" href="../K412fit/">Fitting K412 (flexible API)</a></li><li><a class="tocitem" href="../K412quick/">Fitting K412 (quick fit)</a></li><li><a class="tocitem" href="../XRFspectra/">Fitting XRF Spectra</a></li><li class="is-active"><a class="tocitem" href>Lovely Error Bars</a></li><li><a class="tocitem" href="../continuummodel/">Modeling the Continuum</a></li><li><a class="tocitem" href="../methods/">Methods</a></li><li><a class="tocitem" href="../precompile/">Precompilation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Lovely Error Bars</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lovely Error Bars</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/master/docs/src/errorbars.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h3 id="How-good-are-the-fit-uncertainty-estimates?"><a class="docs-heading-anchor" href="#How-good-are-the-fit-uncertainty-estimates?">How good are the fit uncertainty estimates?</a><a id="How-good-are-the-fit-uncertainty-estimates?-1"></a><a class="docs-heading-anchor-permalink" href="#How-good-are-the-fit-uncertainty-estimates?" title="Permalink"></a></h3><p>This document looks at two different sets of measured spectra to evaluate how well, the estimated fit uncertainties match the observed uncertainties.  We are using two materials known to be highly homogeneous - K412 and ADM-6006a glasses.  To produce a set of spectra that differ only in count statistics, we will subdivide a spectrum into 100 spectra with an effective live-time of 0.01 of the original spectrum livetime.  We expect that we should be able to compare the &quot;fit-predicted&quot; uncertainties with the &quot;observed distribution&quot; of measured values.</p><p>To be clear:</p><ul><li>&quot;fit-predicted&quot; - Comes from the covariance matrix output from the linear least squares fit</li><li>&quot;observed distribution&quot; - Calculated as the standard-deviation of the 100 fit values.</li></ul><p>We want the ratio of the (observed distribution) / (fit predicted) to be unity or close.  We will call this ratio the &quot;heterogeneity&quot; (or &quot;hetero&quot; in the fourth column of the <code>describe(....)</code> table.)</p><p>We then repeat the process on the multiple measured unknown spectra. (4 for K412 and 15 for ADM-6005a)  We expect the heterogeneity to be one or larger - larger than unity when the sample is not perfectly homogeneous.</p><pre><code class="language-julia hljs">using NeXLSpectrum              # Provides spectrum reading and fitting tools
using NeXLMatrixCorrection      # Provides `quant` to convert k-ratios to mass fraction.
using DataFrames                # Tables
using Latexify
using BenchmarkTools</code></pre><h6 id="K412"><a class="docs-heading-anchor" href="#K412">K412</a><a id="K412-1"></a><a class="docs-heading-anchor-permalink" href="#K412" title="Permalink"></a></h6><p>Load the spectra, define the fit model and apply it.</p><pre><code class="language-julia hljs">path = joinpath(@__DIR__,&quot;K412 spectra&quot;)
unks = map(0:4) do i 
  loadspectrum(joinpath(path, &quot;III-E K412[$i][4].msa&quot;))
end
det = matching(unks[1], 132.0, 10)
frs = references( [
  reference(n&quot;Al&quot;, joinpath(path, &quot;Al2O3 std.msa&quot;), mat&quot;Al2O3&quot;),
  reference(n&quot;Mg&quot;, joinpath(path, &quot;MgO std.msa&quot;), mat&quot;MgO&quot;),
  reference(n&quot;Fe&quot;, joinpath(path, &quot;Fe std.msa&quot;), mat&quot;Fe&quot;),
  reference(n&quot;Si&quot;, joinpath(path, &quot;SiO2 std.msa&quot;), mat&quot;SiO2&quot;),
  reference(n&quot;O&quot;, joinpath(path, &quot;SiO2 std.msa&quot;), mat&quot;SiO2&quot;),
  reference(n&quot;Ca&quot;, joinpath(path, &quot;CaF2 std.msa&quot;) ,mat&quot;CaF2&quot;)
], det)
# frs is now a FilteredReference[] used to fit the unknowns.

# Split the counts in unks[1] into 100 randomized spectra which will sum to unks[1] then fit them
res = map(subdivide(unks[1], 100)) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">100-element Vector{FilterFitResult}:
 Sub[III-E K412[0][all],1 of 100]
 Sub[III-E K412[0][all],2 of 100]
 Sub[III-E K412[0][all],3 of 100]
 Sub[III-E K412[0][all],4 of 100]
 Sub[III-E K412[0][all],5 of 100]
 Sub[III-E K412[0][all],6 of 100]
 Sub[III-E K412[0][all],7 of 100]
 Sub[III-E K412[0][all],8 of 100]
 Sub[III-E K412[0][all],9 of 100]
 Sub[III-E K412[0][all],10 of 100]
 ⋮
 Sub[III-E K412[0][all],92 of 100]
 Sub[III-E K412[0][all],93 of 100]
 Sub[III-E K412[0][all],94 of 100]
 Sub[III-E K412[0][all],95 of 100]
 Sub[III-E K412[0][all],96 of 100]
 Sub[III-E K412[0][all],97 of 100]
 Sub[III-E K412[0][all],98 of 100]
 Sub[III-E K412[0][all],99 of 100]
 Sub[III-E K412[0][all],100 of 100]</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">k[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">Δk[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">k[Al K-L3 + 2 others, Al2O3]</th><th style="text-align: right">Δk[Al K-L3 + 2 others, Al2O3]</th><th style="text-align: right">k[Si K-L3 + 2 others, SiO2]</th><th style="text-align: right">Δk[Si K-L3 + 2 others, SiO2]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],1 of 100]</td><td style="text-align: right">0.6534</td><td style="text-align: right">0.008134</td><td style="text-align: right">0.04131</td><td style="text-align: right">0.004321</td><td style="text-align: right">0.1469</td><td style="text-align: right">0.001833</td><td style="text-align: right">0.0669</td><td style="text-align: right">0.00159</td><td style="text-align: right">0.36</td><td style="text-align: right">0.00291</td><td style="text-align: right">0.1921</td><td style="text-align: right">0.002328</td><td style="text-align: right">0.06632</td><td style="text-align: right">0.001605</td><td style="text-align: right">0.05992</td><td style="text-align: right">0.006651</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],2 of 100]</td><td style="text-align: right">0.6691</td><td style="text-align: right">0.008191</td><td style="text-align: right">0.04751</td><td style="text-align: right">0.004485</td><td style="text-align: right">0.1496</td><td style="text-align: right">0.001846</td><td style="text-align: right">0.0679</td><td style="text-align: right">0.001581</td><td style="text-align: right">0.3503</td><td style="text-align: right">0.002886</td><td style="text-align: right">0.1927</td><td style="text-align: right">0.002329</td><td style="text-align: right">0.06709</td><td style="text-align: right">0.001586</td><td style="text-align: right">0.05863</td><td style="text-align: right">0.00654</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],3 of 100]</td><td style="text-align: right">0.6566</td><td style="text-align: right">0.008151</td><td style="text-align: right">0.04284</td><td style="text-align: right">0.004375</td><td style="text-align: right">0.1465</td><td style="text-align: right">0.001842</td><td style="text-align: right">0.06652</td><td style="text-align: right">0.001586</td><td style="text-align: right">0.3494</td><td style="text-align: right">0.002885</td><td style="text-align: right">0.1883</td><td style="text-align: right">0.002315</td><td style="text-align: right">0.06547</td><td style="text-align: right">0.001586</td><td style="text-align: right">0.05552</td><td style="text-align: right">0.006778</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],4 of 100]</td><td style="text-align: right">0.6527</td><td style="text-align: right">0.008113</td><td style="text-align: right">0.03728</td><td style="text-align: right">0.004346</td><td style="text-align: right">0.1465</td><td style="text-align: right">0.001829</td><td style="text-align: right">0.06577</td><td style="text-align: right">0.001575</td><td style="text-align: right">0.3482</td><td style="text-align: right">0.002887</td><td style="text-align: right">0.1936</td><td style="text-align: right">0.002312</td><td style="text-align: right">0.0652</td><td style="text-align: right">0.001594</td><td style="text-align: right">0.074</td><td style="text-align: right">0.00684</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],5 of 100]</td><td style="text-align: right">0.6653</td><td style="text-align: right">0.008172</td><td style="text-align: right">0.04221</td><td style="text-align: right">0.004368</td><td style="text-align: right">0.1487</td><td style="text-align: right">0.001841</td><td style="text-align: right">0.06722</td><td style="text-align: right">0.001599</td><td style="text-align: right">0.348</td><td style="text-align: right">0.002882</td><td style="text-align: right">0.1942</td><td style="text-align: right">0.002324</td><td style="text-align: right">0.06691</td><td style="text-align: right">0.001592</td><td style="text-align: right">0.05917</td><td style="text-align: right">0.006807</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],6 of 100]</td><td style="text-align: right">0.6459</td><td style="text-align: right">0.008078</td><td style="text-align: right">0.04109</td><td style="text-align: right">0.004476</td><td style="text-align: right">0.1477</td><td style="text-align: right">0.001833</td><td style="text-align: right">0.06793</td><td style="text-align: right">0.001601</td><td style="text-align: right">0.3438</td><td style="text-align: right">0.002877</td><td style="text-align: right">0.1915</td><td style="text-align: right">0.002321</td><td style="text-align: right">0.06774</td><td style="text-align: right">0.001595</td><td style="text-align: right">0.06018</td><td style="text-align: right">0.006651</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],7 of 100]</td><td style="text-align: right">0.666</td><td style="text-align: right">0.008189</td><td style="text-align: right">0.03877</td><td style="text-align: right">0.004271</td><td style="text-align: right">0.1495</td><td style="text-align: right">0.001835</td><td style="text-align: right">0.06588</td><td style="text-align: right">0.00158</td><td style="text-align: right">0.3496</td><td style="text-align: right">0.002885</td><td style="text-align: right">0.1928</td><td style="text-align: right">0.002319</td><td style="text-align: right">0.06714</td><td style="text-align: right">0.001594</td><td style="text-align: right">0.06367</td><td style="text-align: right">0.00697</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],8 of 100]</td><td style="text-align: right">0.6511</td><td style="text-align: right">0.008102</td><td style="text-align: right">0.03797</td><td style="text-align: right">0.004321</td><td style="text-align: right">0.1492</td><td style="text-align: right">0.001831</td><td style="text-align: right">0.0651</td><td style="text-align: right">0.001579</td><td style="text-align: right">0.3479</td><td style="text-align: right">0.002885</td><td style="text-align: right">0.1967</td><td style="text-align: right">0.002326</td><td style="text-align: right">0.06548</td><td style="text-align: right">0.001587</td><td style="text-align: right">0.06765</td><td style="text-align: right">0.006726</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],9 of 100]</td><td style="text-align: right">0.6681</td><td style="text-align: right">0.008157</td><td style="text-align: right">0.04152</td><td style="text-align: right">0.004325</td><td style="text-align: right">0.1473</td><td style="text-align: right">0.00183</td><td style="text-align: right">0.06873</td><td style="text-align: right">0.001583</td><td style="text-align: right">0.3477</td><td style="text-align: right">0.002887</td><td style="text-align: right">0.1981</td><td style="text-align: right">0.002332</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.001608</td><td style="text-align: right">0.04943</td><td style="text-align: right">0.006541</td></tr><tr><td style="text-align: right">Sub[III-E K412[0][all],10 of 100]</td><td style="text-align: right">0.6528</td><td style="text-align: right">0.008129</td><td style="text-align: right">0.03767</td><td style="text-align: right">0.004309</td><td style="text-align: right">0.1443</td><td style="text-align: right">0.001813</td><td style="text-align: right">0.06794</td><td style="text-align: right">0.001588</td><td style="text-align: right">0.3526</td><td style="text-align: right">0.002903</td><td style="text-align: right">0.1913</td><td style="text-align: right">0.002323</td><td style="text-align: right">0.06477</td><td style="text-align: right">0.001586</td><td style="text-align: right">0.08405</td><td style="text-align: right">0.006965</td></tr></table><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.6556</td><td style="text-align: right">0.008433</td><td style="text-align: right">1.037</td><td style="text-align: right">0.6373</td><td style="text-align: right">0.6496</td><td style="text-align: right">0.6555</td><td style="text-align: right">0.6619</td><td style="text-align: right">0.6756</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</td><td style="text-align: right">0.04193</td><td style="text-align: right">0.003651</td><td style="text-align: right">0.8334</td><td style="text-align: right">0.02982</td><td style="text-align: right">0.03966</td><td style="text-align: right">0.04183</td><td style="text-align: right">0.04451</td><td style="text-align: right">0.05129</td></tr><tr><td style="text-align: right">k[Mg K-L3 + 1 other, MgO]</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.001912</td><td style="text-align: right">1.043</td><td style="text-align: right">0.143</td><td style="text-align: right">0.1467</td><td style="text-align: right">0.1477</td><td style="text-align: right">0.1486</td><td style="text-align: right">0.1539</td></tr><tr><td style="text-align: right">k[Al K-L3 + 2 others, Al2O3]</td><td style="text-align: right">0.06698</td><td style="text-align: right">0.001474</td><td style="text-align: right">0.927</td><td style="text-align: right">0.06354</td><td style="text-align: right">0.06607</td><td style="text-align: right">0.06693</td><td style="text-align: right">0.06791</td><td style="text-align: right">0.07128</td></tr><tr><td style="text-align: right">k[Si K-L3 + 2 others, SiO2]</td><td style="text-align: right">0.3508</td><td style="text-align: right">0.00325</td><td style="text-align: right">1.124</td><td style="text-align: right">0.3432</td><td style="text-align: right">0.3488</td><td style="text-align: right">0.3507</td><td style="text-align: right">0.3532</td><td style="text-align: right">0.36</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.002384</td><td style="text-align: right">1.025</td><td style="text-align: right">0.188</td><td style="text-align: right">0.1907</td><td style="text-align: right">0.1924</td><td style="text-align: right">0.1938</td><td style="text-align: right">0.1981</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.06684</td><td style="text-align: right">0.001765</td><td style="text-align: right">1.108</td><td style="text-align: right">0.06217</td><td style="text-align: right">0.06561</td><td style="text-align: right">0.06689</td><td style="text-align: right">0.06819</td><td style="text-align: right">0.07101</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.06692</td><td style="text-align: right">0.006231</td><td style="text-align: right">0.9275</td><td style="text-align: right">0.04943</td><td style="text-align: right">0.06241</td><td style="text-align: right">0.06687</td><td style="text-align: right">0.07108</td><td style="text-align: right">0.08405</td></tr></table><p>Repeat the fit for the 4 measured unknowns.</p><pre><code class="language-julia hljs">res= map(unks) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">5-element Vector{FilterFitResult}:
 III-E K412[0][all]
 III-E K412[1][all]
 III-E K412[2][all]
 III-E K412[3][all]
 III-E K412[4][all]</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">k[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">Δk[Mg K-L3 + 1 other, MgO]</th><th style="text-align: right">k[Al K-L3 + 2 others, Al2O3]</th><th style="text-align: right">Δk[Al K-L3 + 2 others, Al2O3]</th><th style="text-align: right">k[Si K-L3 + 2 others, SiO2]</th><th style="text-align: right">Δk[Si K-L3 + 2 others, SiO2]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th></tr><tr><td style="text-align: right">III-E K412[0][all]</td><td style="text-align: right">0.6556</td><td style="text-align: right">0.0008134</td><td style="text-align: right">0.04191</td><td style="text-align: right">0.0004382</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.0001834</td><td style="text-align: right">0.06698</td><td style="text-align: right">0.000159</td><td style="text-align: right">0.3508</td><td style="text-align: right">0.000289</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002326</td><td style="text-align: right">0.06683</td><td style="text-align: right">0.0001593</td><td style="text-align: right">0.06684</td><td style="text-align: right">0.0006722</td></tr><tr><td style="text-align: right">III-E K412[1][all]</td><td style="text-align: right">0.6574</td><td style="text-align: right">0.0008141</td><td style="text-align: right">0.04157</td><td style="text-align: right">0.0004372</td><td style="text-align: right">0.1475</td><td style="text-align: right">0.0001835</td><td style="text-align: right">0.06674</td><td style="text-align: right">0.000159</td><td style="text-align: right">0.35</td><td style="text-align: right">0.0002889</td><td style="text-align: right">0.1916</td><td style="text-align: right">0.0002324</td><td style="text-align: right">0.06708</td><td style="text-align: right">0.0001595</td><td style="text-align: right">0.06738</td><td style="text-align: right">0.0006721</td></tr><tr><td style="text-align: right">III-E K412[2][all]</td><td style="text-align: right">0.658</td><td style="text-align: right">0.0008157</td><td style="text-align: right">0.04192</td><td style="text-align: right">0.0004381</td><td style="text-align: right">0.1479</td><td style="text-align: right">0.0001838</td><td style="text-align: right">0.06708</td><td style="text-align: right">0.0001594</td><td style="text-align: right">0.3513</td><td style="text-align: right">0.0002897</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002329</td><td style="text-align: right">0.06688</td><td style="text-align: right">0.0001596</td><td style="text-align: right">0.06704</td><td style="text-align: right">0.0006737</td></tr><tr><td style="text-align: right">III-E K412[3][all]</td><td style="text-align: right">0.6624</td><td style="text-align: right">0.0008188</td><td style="text-align: right">0.04146</td><td style="text-align: right">0.0004379</td><td style="text-align: right">0.1481</td><td style="text-align: right">0.0001841</td><td style="text-align: right">0.06715</td><td style="text-align: right">0.0001595</td><td style="text-align: right">0.352</td><td style="text-align: right">0.0002901</td><td style="text-align: right">0.1925</td><td style="text-align: right">0.0002333</td><td style="text-align: right">0.06682</td><td style="text-align: right">0.0001598</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.0006746</td></tr><tr><td style="text-align: right">III-E K412[4][all]</td><td style="text-align: right">0.6608</td><td style="text-align: right">0.0008182</td><td style="text-align: right">0.04082</td><td style="text-align: right">0.0004383</td><td style="text-align: right">0.1482</td><td style="text-align: right">0.0001841</td><td style="text-align: right">0.06728</td><td style="text-align: right">0.0001597</td><td style="text-align: right">0.3519</td><td style="text-align: right">0.0002901</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.0002333</td><td style="text-align: right">0.06694</td><td style="text-align: right">0.0001598</td><td style="text-align: right">0.06648</td><td style="text-align: right">0.0006739</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.6588</td><td style="text-align: right">0.002724</td><td style="text-align: right">3.338</td><td style="text-align: right">0.6556</td><td style="text-align: right">0.6574</td><td style="text-align: right">0.658</td><td style="text-align: right">0.6608</td><td style="text-align: right">0.6624</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</td><td style="text-align: right">0.04153</td><td style="text-align: right">0.0004496</td><td style="text-align: right">1.027</td><td style="text-align: right">0.04082</td><td style="text-align: right">0.04146</td><td style="text-align: right">0.04157</td><td style="text-align: right">0.04191</td><td style="text-align: right">0.04192</td></tr><tr><td style="text-align: right">k[Mg K-L3 + 1 other, MgO]</td><td style="text-align: right">0.1479</td><td style="text-align: right">0.0003027</td><td style="text-align: right">1.647</td><td style="text-align: right">0.1475</td><td style="text-align: right">0.1476</td><td style="text-align: right">0.1479</td><td style="text-align: right">0.1481</td><td style="text-align: right">0.1482</td></tr><tr><td style="text-align: right">k[Al K-L3 + 2 others, Al2O3]</td><td style="text-align: right">0.06705</td><td style="text-align: right">0.000202</td><td style="text-align: right">1.268</td><td style="text-align: right">0.06674</td><td style="text-align: right">0.06698</td><td style="text-align: right">0.06708</td><td style="text-align: right">0.06715</td><td style="text-align: right">0.06728</td></tr><tr><td style="text-align: right">k[Si K-L3 + 2 others, SiO2]</td><td style="text-align: right">0.3512</td><td style="text-align: right">0.0008298</td><td style="text-align: right">2.866</td><td style="text-align: right">0.35</td><td style="text-align: right">0.3508</td><td style="text-align: right">0.3513</td><td style="text-align: right">0.3519</td><td style="text-align: right">0.352</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1921</td><td style="text-align: right">0.000318</td><td style="text-align: right">1.365</td><td style="text-align: right">0.1916</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1922</td><td style="text-align: right">0.1925</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.06691</td><td style="text-align: right">0.0001063</td><td style="text-align: right">0.6661</td><td style="text-align: right">0.06682</td><td style="text-align: right">0.06683</td><td style="text-align: right">0.06688</td><td style="text-align: right">0.06694</td><td style="text-align: right">0.06708</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.06711</td><td style="text-align: right">0.0005071</td><td style="text-align: right">0.7531</td><td style="text-align: right">0.06648</td><td style="text-align: right">0.06684</td><td style="text-align: right">0.06704</td><td style="text-align: right">0.06738</td><td style="text-align: right">0.0678</td></tr></table><pre><code class="language-julia hljs">@btime fit_spectrum(unks[1], frs)</code></pre><pre><code class="nohighlight hljs">640.300 μs (1466 allocations: 377.86 KiB)
III-E K412[0][all]</code></pre><h6 id="AMM-6005a"><a class="docs-heading-anchor" href="#AMM-6005a">AMM-6005a</a><a id="AMM-6005a-1"></a><a class="docs-heading-anchor-permalink" href="#AMM-6005a" title="Permalink"></a></h6><p>Repeat using the ADM glass.  Fe is not present in ADM-6005a but we fit it to see what a null result looks like.</p><pre><code class="language-julia hljs">path = normpath(joinpath(@__DIR__, &quot;..&quot;,&quot;test&quot;,&quot;ADM6005a spectra&quot;))
unks = map(i-&gt;loadspectrum(joinpath(path,&quot;ADM-6005a_$i.msa&quot;)),1:15)
al, caf2, fe, ge, si, sio2, ti, zn = map(f-&gt;loadspectrum(joinpath(path,&quot;$f.msa&quot;)), (&quot;Al std&quot;, &quot;CaF2 std&quot;, &quot;Fe std&quot;, &quot;Ge std&quot;, &quot;Si std&quot;, &quot;SiO2 std&quot;, &quot;Ti trimmed&quot;,&quot;Zn std&quot;))

det = matching(unks[1], 132.0, 10)

frs = references( [
  reference(n&quot;Al&quot;, al, mat&quot;Al&quot; ), #
  reference(n&quot;Ca&quot;, caf2, mat&quot;CaF2&quot; ),   #
  reference(n&quot;Fe&quot;, fe, mat&quot;Fe&quot; ),    #
  reference(n&quot;Ge&quot;, ge, mat&quot;Ge&quot; ),    #
  reference(n&quot;Si&quot;, si, mat&quot;Si&quot; ),  #
  reference(n&quot;O&quot;, sio2, mat&quot;SiO2&quot; ),  #
  reference(n&quot;Ti&quot;, ti, mat&quot;Ti&quot; ),
  reference(n&quot;Zn&quot;, zn, mat&quot;Zn&quot; ) 
], det)

ss = 
res= map(subdivide(unks[1], 100)) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">100-element Vector{FilterFitResult}:
 Sub[ADM-6005a_1,1 of 100]
 Sub[ADM-6005a_1,2 of 100]
 Sub[ADM-6005a_1,3 of 100]
 Sub[ADM-6005a_1,4 of 100]
 Sub[ADM-6005a_1,5 of 100]
 Sub[ADM-6005a_1,6 of 100]
 Sub[ADM-6005a_1,7 of 100]
 Sub[ADM-6005a_1,8 of 100]
 Sub[ADM-6005a_1,9 of 100]
 Sub[ADM-6005a_1,10 of 100]
 ⋮
 Sub[ADM-6005a_1,92 of 100]
 Sub[ADM-6005a_1,93 of 100]
 Sub[ADM-6005a_1,94 of 100]
 Sub[ADM-6005a_1,95 of 100]
 Sub[ADM-6005a_1,96 of 100]
 Sub[ADM-6005a_1,97 of 100]
 Sub[ADM-6005a_1,98 of 100]
 Sub[ADM-6005a_1,99 of 100]
 Sub[ADM-6005a_1,100 of 100]</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[Ti L3-M1 + 11 others, Ti]</th><th style="text-align: right">Δk[Ti L3-M1 + 11 others, Ti]</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">k[Zn L3-M5 + 13 others, Zn]</th><th style="text-align: right">Δk[Zn L3-M5 + 13 others, Zn]</th><th style="text-align: right">k[Ge L3-M5 + 14 others, Ge]</th><th style="text-align: right">Δk[Ge L3-M5 + 14 others, Ge]</th><th style="text-align: right">k[Al K-L3 + 2 others, Al]</th><th style="text-align: right">Δk[Al K-L3 + 2 others, Al]</th><th style="text-align: right">k[Si K-L3 + 2 others, Si]</th><th style="text-align: right">Δk[Si K-L3 + 2 others, Si]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">Δk[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">k[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">Δk[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">k[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">Δk[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">k[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">Δk[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">k[Ge K-M3 + 4 others, Ge]</th><th style="text-align: right">Δk[Ge K-M3 + 4 others, Ge]</th></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,1 of 100]</td><td style="text-align: right">0.01701</td><td style="text-align: right">0.01823</td><td style="text-align: right">0.4764</td><td style="text-align: right">0.006706</td><td style="text-align: right">0</td><td style="text-align: right">0.05243</td><td style="text-align: right">0.07044</td><td style="text-align: right">0.001484</td><td style="text-align: right">0.1817</td><td style="text-align: right">0.001774</td><td style="text-align: right">0.02669</td><td style="text-align: right">0.0004935</td><td style="text-align: right">0.02094</td><td style="text-align: right">0.0005008</td><td style="text-align: right">0.1224</td><td style="text-align: right">0.001702</td><td style="text-align: right">0.06535</td><td style="text-align: right">0.001031</td><td style="text-align: right">0</td><td style="text-align: right">0.02649</td><td style="text-align: right">0</td><td style="text-align: right">0.071</td><td style="text-align: right">0.1189</td><td style="text-align: right">0.002756</td><td style="text-align: right">0.1241</td><td style="text-align: right">0.01599</td><td style="text-align: right">0.2679</td><td style="text-align: right">0.005309</td><td style="text-align: right">0.2855</td><td style="text-align: right">0.01949</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,2 of 100]</td><td style="text-align: right">0.007295</td><td style="text-align: right">0.01842</td><td style="text-align: right">0.5039</td><td style="text-align: right">0.00684</td><td style="text-align: right">0</td><td style="text-align: right">0.0535</td><td style="text-align: right">0.06888</td><td style="text-align: right">0.001467</td><td style="text-align: right">0.1773</td><td style="text-align: right">0.001755</td><td style="text-align: right">0.02778</td><td style="text-align: right">0.0005028</td><td style="text-align: right">0.0221</td><td style="text-align: right">0.0005013</td><td style="text-align: right">0.1246</td><td style="text-align: right">0.001707</td><td style="text-align: right">0.06382</td><td style="text-align: right">0.001035</td><td style="text-align: right">0</td><td style="text-align: right">0.02623</td><td style="text-align: right">0.004561</td><td style="text-align: right">0.005065</td><td style="text-align: right">0.1128</td><td style="text-align: right">0.002782</td><td style="text-align: right">0.1302</td><td style="text-align: right">0.0154</td><td style="text-align: right">0.2569</td><td style="text-align: right">0.005264</td><td style="text-align: right">0.2379</td><td style="text-align: right">0.0185</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,3 of 100]</td><td style="text-align: right">0.0461</td><td style="text-align: right">0.0179</td><td style="text-align: right">0.503</td><td style="text-align: right">0.006739</td><td style="text-align: right">0.001277</td><td style="text-align: right">0.002923</td><td style="text-align: right">0.07231</td><td style="text-align: right">0.001495</td><td style="text-align: right">0.1808</td><td style="text-align: right">0.00177</td><td style="text-align: right">0.02833</td><td style="text-align: right">0.0004983</td><td style="text-align: right">0.0219</td><td style="text-align: right">0.0004966</td><td style="text-align: right">0.1192</td><td style="text-align: right">0.001684</td><td style="text-align: right">0.06282</td><td style="text-align: right">0.001026</td><td style="text-align: right">0.0002522</td><td style="text-align: right">0.0007025</td><td style="text-align: right">0</td><td style="text-align: right">0.07029</td><td style="text-align: right">0.1095</td><td style="text-align: right">0.002715</td><td style="text-align: right">0.1183</td><td style="text-align: right">0.01552</td><td style="text-align: right">0.2755</td><td style="text-align: right">0.005256</td><td style="text-align: right">0.3053</td><td style="text-align: right">0.01921</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,4 of 100]</td><td style="text-align: right">0.03801</td><td style="text-align: right">0.0183</td><td style="text-align: right">0.4872</td><td style="text-align: right">0.006693</td><td style="text-align: right">0</td><td style="text-align: right">0.05272</td><td style="text-align: right">0.06886</td><td style="text-align: right">0.001466</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.001766</td><td style="text-align: right">0.02874</td><td style="text-align: right">0.000497</td><td style="text-align: right">0.01988</td><td style="text-align: right">0.0004908</td><td style="text-align: right">0.1154</td><td style="text-align: right">0.001671</td><td style="text-align: right">0.06216</td><td style="text-align: right">0.001034</td><td style="text-align: right">0.0007694</td><td style="text-align: right">0.0007115</td><td style="text-align: right">0</td><td style="text-align: right">0.07007</td><td style="text-align: right">0.108</td><td style="text-align: right">0.002706</td><td style="text-align: right">0.1694</td><td style="text-align: right">0.01555</td><td style="text-align: right">0.2679</td><td style="text-align: right">0.005249</td><td style="text-align: right">0.2625</td><td style="text-align: right">0.01892</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,5 of 100]</td><td style="text-align: right">0.008826</td><td style="text-align: right">0.01825</td><td style="text-align: right">0.4777</td><td style="text-align: right">0.006741</td><td style="text-align: right">0.0006582</td><td style="text-align: right">0.002771</td><td style="text-align: right">0.06612</td><td style="text-align: right">0.001478</td><td style="text-align: right">0.182</td><td style="text-align: right">0.001778</td><td style="text-align: right">0.0291</td><td style="text-align: right">0.0005044</td><td style="text-align: right">0.02148</td><td style="text-align: right">0.0005008</td><td style="text-align: right">0.1193</td><td style="text-align: right">0.001682</td><td style="text-align: right">0.06443</td><td style="text-align: right">0.001021</td><td style="text-align: right">0.0008609</td><td style="text-align: right">0.0006874</td><td style="text-align: right">0.005105</td><td style="text-align: right">0.004986</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.002753</td><td style="text-align: right">0.1189</td><td style="text-align: right">0.01564</td><td style="text-align: right">0.2568</td><td style="text-align: right">0.005239</td><td style="text-align: right">0.3135</td><td style="text-align: right">0.01835</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,6 of 100]</td><td style="text-align: right">0.0349</td><td style="text-align: right">0.01767</td><td style="text-align: right">0.4971</td><td style="text-align: right">0.006699</td><td style="text-align: right">0.0007166</td><td style="text-align: right">0.002692</td><td style="text-align: right">0.06934</td><td style="text-align: right">0.001484</td><td style="text-align: right">0.18</td><td style="text-align: right">0.001771</td><td style="text-align: right">0.02853</td><td style="text-align: right">0.0005004</td><td style="text-align: right">0.02135</td><td style="text-align: right">0.0005063</td><td style="text-align: right">0.1221</td><td style="text-align: right">0.00167</td><td style="text-align: right">0.06523</td><td style="text-align: right">0.001042</td><td style="text-align: right">0</td><td style="text-align: right">0.02621</td><td style="text-align: right">0</td><td style="text-align: right">0.07059</td><td style="text-align: right">0.1137</td><td style="text-align: right">0.00275</td><td style="text-align: right">0.1078</td><td style="text-align: right">0.01586</td><td style="text-align: right">0.2529</td><td style="text-align: right">0.005231</td><td style="text-align: right">0.2821</td><td style="text-align: right">0.01943</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,7 of 100]</td><td style="text-align: right">0.04437</td><td style="text-align: right">0.01889</td><td style="text-align: right">0.4827</td><td style="text-align: right">0.006726</td><td style="text-align: right">0</td><td style="text-align: right">0.05358</td><td style="text-align: right">0.06994</td><td style="text-align: right">0.001492</td><td style="text-align: right">0.1767</td><td style="text-align: right">0.001772</td><td style="text-align: right">0.02786</td><td style="text-align: right">0.0005011</td><td style="text-align: right">0.02155</td><td style="text-align: right">0.0005015</td><td style="text-align: right">0.1236</td><td style="text-align: right">0.0017</td><td style="text-align: right">0.06319</td><td style="text-align: right">0.001037</td><td style="text-align: right">0.001452</td><td style="text-align: right">0.0007065</td><td style="text-align: right">0</td><td style="text-align: right">0.07127</td><td style="text-align: right">0.1101</td><td style="text-align: right">0.002701</td><td style="text-align: right">0.1165</td><td style="text-align: right">0.01535</td><td style="text-align: right">0.2541</td><td style="text-align: right">0.005167</td><td style="text-align: right">0.24</td><td style="text-align: right">0.01866</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,8 of 100]</td><td style="text-align: right">0.01744</td><td style="text-align: right">0.01777</td><td style="text-align: right">0.5011</td><td style="text-align: right">0.006798</td><td style="text-align: right">0.00435</td><td style="text-align: right">0.002853</td><td style="text-align: right">0.06573</td><td style="text-align: right">0.001467</td><td style="text-align: right">0.18</td><td style="text-align: right">0.001767</td><td style="text-align: right">0.02897</td><td style="text-align: right">0.0005053</td><td style="text-align: right">0.02106</td><td style="text-align: right">0.0004972</td><td style="text-align: right">0.1202</td><td style="text-align: right">0.001686</td><td style="text-align: right">0.06295</td><td style="text-align: right">0.001018</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.0006964</td><td style="text-align: right">0</td><td style="text-align: right">0.07175</td><td style="text-align: right">0.1071</td><td style="text-align: right">0.002707</td><td style="text-align: right">0.09793</td><td style="text-align: right">0.0158</td><td style="text-align: right">0.2553</td><td style="text-align: right">0.005294</td><td style="text-align: right">0.2657</td><td style="text-align: right">0.01883</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,9 of 100]</td><td style="text-align: right">0.02472</td><td style="text-align: right">0.01849</td><td style="text-align: right">0.493</td><td style="text-align: right">0.006735</td><td style="text-align: right">0.00156</td><td style="text-align: right">0.002765</td><td style="text-align: right">0.06869</td><td style="text-align: right">0.001471</td><td style="text-align: right">0.1852</td><td style="text-align: right">0.00178</td><td style="text-align: right">0.02721</td><td style="text-align: right">0.0004926</td><td style="text-align: right">0.02046</td><td style="text-align: right">0.0004944</td><td style="text-align: right">0.1218</td><td style="text-align: right">0.00172</td><td style="text-align: right">0.06443</td><td style="text-align: right">0.001025</td><td style="text-align: right">0</td><td style="text-align: right">0.02632</td><td style="text-align: right">0</td><td style="text-align: right">0.07114</td><td style="text-align: right">0.1121</td><td style="text-align: right">0.002725</td><td style="text-align: right">0.1397</td><td style="text-align: right">0.01581</td><td style="text-align: right">0.2658</td><td style="text-align: right">0.005323</td><td style="text-align: right">0.2766</td><td style="text-align: right">0.01893</td></tr><tr><td style="text-align: right">Sub[ADM-6005a_1,10 of 100]</td><td style="text-align: right">0.0325</td><td style="text-align: right">0.01821</td><td style="text-align: right">0.4701</td><td style="text-align: right">0.006705</td><td style="text-align: right">0.005211</td><td style="text-align: right">0.002789</td><td style="text-align: right">0.06983</td><td style="text-align: right">0.001471</td><td style="text-align: right">0.1809</td><td style="text-align: right">0.00178</td><td style="text-align: right">0.02772</td><td style="text-align: right">0.0005025</td><td style="text-align: right">0.02066</td><td style="text-align: right">0.0004993</td><td style="text-align: right">0.1226</td><td style="text-align: right">0.001689</td><td style="text-align: right">0.06529</td><td style="text-align: right">0.001036</td><td style="text-align: right">0.0008409</td><td style="text-align: right">0.0007157</td><td style="text-align: right">0</td><td style="text-align: right">0.0718</td><td style="text-align: right">0.1075</td><td style="text-align: right">0.002689</td><td style="text-align: right">0.1303</td><td style="text-align: right">0.01555</td><td style="text-align: right">0.257</td><td style="text-align: right">0.005212</td><td style="text-align: right">0.2321</td><td style="text-align: right">0.01861</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[Ti L3-M1 + 11 others, Ti]</td><td style="text-align: right">0.02066</td><td style="text-align: right">0.01471</td><td style="text-align: right">0.4767</td><td style="text-align: right">0</td><td style="text-align: right">0.008241</td><td style="text-align: right">0.01977</td><td style="text-align: right">0.03197</td><td style="text-align: right">0.05383</td></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.4877</td><td style="text-align: right">0.008839</td><td style="text-align: right">1.32</td><td style="text-align: right">0.4657</td><td style="text-align: right">0.4816</td><td style="text-align: right">0.4873</td><td style="text-align: right">0.4937</td><td style="text-align: right">0.507</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</td><td style="text-align: right">0.001129</td><td style="text-align: right">0.001706</td><td style="text-align: right">0.0637</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0002514</td><td style="text-align: right">0.001574</td><td style="text-align: right">0.007961</td></tr><tr><td style="text-align: right">k[Zn L3-M5 + 13 others, Zn]</td><td style="text-align: right">0.06813</td><td style="text-align: right">0.002022</td><td style="text-align: right">1.371</td><td style="text-align: right">0.06388</td><td style="text-align: right">0.06673</td><td style="text-align: right">0.06847</td><td style="text-align: right">0.06952</td><td style="text-align: right">0.07275</td></tr><tr><td style="text-align: right">k[Ge L3-M5 + 14 others, Ge]</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.002439</td><td style="text-align: right">1.379</td><td style="text-align: right">0.1724</td><td style="text-align: right">0.1775</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.1809</td><td style="text-align: right">0.1852</td></tr><tr><td style="text-align: right">k[Al K-L3 + 2 others, Al]</td><td style="text-align: right">0.02801</td><td style="text-align: right">0.0007716</td><td style="text-align: right">1.543</td><td style="text-align: right">0.02603</td><td style="text-align: right">0.02739</td><td style="text-align: right">0.028</td><td style="text-align: right">0.02849</td><td style="text-align: right">0.0307</td></tr><tr><td style="text-align: right">k[Si K-L3 + 2 others, Si]</td><td style="text-align: right">0.02143</td><td style="text-align: right">0.0007168</td><td style="text-align: right">1.429</td><td style="text-align: right">0.01988</td><td style="text-align: right">0.02094</td><td style="text-align: right">0.02138</td><td style="text-align: right">0.0219</td><td style="text-align: right">0.02329</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.002356</td><td style="text-align: right">1.397</td><td style="text-align: right">0.1151</td><td style="text-align: right">0.12</td><td style="text-align: right">0.1216</td><td style="text-align: right">0.1228</td><td style="text-align: right">0.1273</td></tr><tr><td style="text-align: right">k[Ti K-L3 + 3 others, Ti]</td><td style="text-align: right">0.06433</td><td style="text-align: right">0.001411</td><td style="text-align: right">1.366</td><td style="text-align: right">0.06139</td><td style="text-align: right">0.06328</td><td style="text-align: right">0.06442</td><td style="text-align: right">0.06536</td><td style="text-align: right">0.06784</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.0004457</td><td style="text-align: right">0.0005476</td><td style="text-align: right">0.05001</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0002275</td><td style="text-align: right">0.0007929</td><td style="text-align: right">0.002241</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.002994</td><td style="text-align: right">0.003948</td><td style="text-align: right">0.1206</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.001136</td><td style="text-align: right">0.00509</td><td style="text-align: right">0.01834</td></tr><tr><td style="text-align: right">k[Zn K-L3 + 1 other, Zn]</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.003449</td><td style="text-align: right">1.266</td><td style="text-align: right">0.1045</td><td style="text-align: right">0.1094</td><td style="text-align: right">0.1119</td><td style="text-align: right">0.1145</td><td style="text-align: right">0.121</td></tr><tr><td style="text-align: right">k[Zn K-M3 + 3 others, Zn]</td><td style="text-align: right">0.1243</td><td style="text-align: right">0.01776</td><td style="text-align: right">1.131</td><td style="text-align: right">0.06273</td><td style="text-align: right">0.1141</td><td style="text-align: right">0.1245</td><td style="text-align: right">0.1341</td><td style="text-align: right">0.1694</td></tr><tr><td style="text-align: right">k[Ge K-L3 + 1 other, Ge]</td><td style="text-align: right">0.2634</td><td style="text-align: right">0.007015</td><td style="text-align: right">1.335</td><td style="text-align: right">0.2513</td><td style="text-align: right">0.2572</td><td style="text-align: right">0.263</td><td style="text-align: right">0.2677</td><td style="text-align: right">0.2808</td></tr><tr><td style="text-align: right">k[Ge K-M3 + 4 others, Ge]</td><td style="text-align: right">0.2701</td><td style="text-align: right">0.02653</td><td style="text-align: right">1.395</td><td style="text-align: right">0.1664</td><td style="text-align: right">0.2524</td><td style="text-align: right">0.2699</td><td style="text-align: right">0.2879</td><td style="text-align: right">0.3275</td></tr></table><p>Repeat for the 15 measured spectra.</p><pre><code class="language-julia hljs">res= map(unks) do s
  fit_spectrum(s, frs)
end</code></pre><pre><code class="nohighlight hljs">15-element Vector{FilterFitResult}:
 ADM-6005a_1
 ADM-6005a_2
 ADM-6005a_3
 ADM-6005a_4
 ADM-6005a_5
 ADM-6005a_6
 ADM-6005a_7
 ADM-6005a_8
 ADM-6005a_9
 ADM-6005a_10
 ADM-6005a_11
 ADM-6005a_12
 ADM-6005a_13
 ADM-6005a_14
 ADM-6005a_15</code></pre><table><tr><th style="text-align: right">Spectra</th><th style="text-align: right">k[Ti L3-M1 + 11 others, Ti]</th><th style="text-align: right">Δk[Ti L3-M1 + 11 others, Ti]</th><th style="text-align: right">k[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">Δk[O K-L3 + 1 other, SiO2]</th><th style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">Δk[Fe L3-M5 + 13 others, Fe]</th><th style="text-align: right">k[Zn L3-M5 + 13 others, Zn]</th><th style="text-align: right">Δk[Zn L3-M5 + 13 others, Zn]</th><th style="text-align: right">k[Ge L3-M5 + 14 others, Ge]</th><th style="text-align: right">Δk[Ge L3-M5 + 14 others, Ge]</th><th style="text-align: right">k[Al K-L3 + 2 others, Al]</th><th style="text-align: right">Δk[Al K-L3 + 2 others, Al]</th><th style="text-align: right">k[Si K-L3 + 2 others, Si]</th><th style="text-align: right">Δk[Si K-L3 + 2 others, Si]</th><th style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">Δk[Ca K-L3 + 3 others, CaF2]</th><th style="text-align: right">k[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">Δk[Ti K-L3 + 3 others, Ti]</th><th style="text-align: right">k[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">Δk[Fe K-L3 + 1 other, Fe]</th><th style="text-align: right">k[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">Δk[Fe K-M3 + 3 others, Fe]</th><th style="text-align: right">k[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">Δk[Zn K-L3 + 1 other, Zn]</th><th style="text-align: right">k[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">Δk[Zn K-M3 + 3 others, Zn]</th><th style="text-align: right">k[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">Δk[Ge K-L3 + 1 other, Ge]</th><th style="text-align: right">k[Ge K-M3 + 4 others, Ge]</th><th style="text-align: right">Δk[Ge K-M3 + 4 others, Ge]</th></tr><tr><td style="text-align: right">ADM-6005a_1</td><td style="text-align: right">0.01961</td><td style="text-align: right">0.001806</td><td style="text-align: right">0.4876</td><td style="text-align: right">0.0006731</td><td style="text-align: right">0.0001192</td><td style="text-align: right">0.0002801</td><td style="text-align: right">0.06814</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02801</td><td style="text-align: right">5.001e-05</td><td style="text-align: right">0.02143</td><td style="text-align: right">5.016e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06433</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002048</td><td style="text-align: right">6.966e-05</td><td style="text-align: right">0.001265</td><td style="text-align: right">0.0005064</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.0002725</td><td style="text-align: right">0.1242</td><td style="text-align: right">0.00157</td><td style="text-align: right">0.2634</td><td style="text-align: right">0.0005252</td><td style="text-align: right">0.2697</td><td style="text-align: right">0.001894</td></tr><tr><td style="text-align: right">ADM-6005a_2</td><td style="text-align: right">0.02049</td><td style="text-align: right">0.001807</td><td style="text-align: right">0.4863</td><td style="text-align: right">0.000673</td><td style="text-align: right">0</td><td style="text-align: right">0.01666</td><td style="text-align: right">0.06796</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02794</td><td style="text-align: right">5.001e-05</td><td style="text-align: right">0.02146</td><td style="text-align: right">5.01e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06393</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003342</td><td style="text-align: right">6.935e-05</td><td style="text-align: right">0.001418</td><td style="text-align: right">0.0005071</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.0002728</td><td style="text-align: right">0.1242</td><td style="text-align: right">0.001569</td><td style="text-align: right">0.264</td><td style="text-align: right">0.0005255</td><td style="text-align: right">0.2766</td><td style="text-align: right">0.001898</td></tr><tr><td style="text-align: right">ADM-6005a_3</td><td style="text-align: right">0.02104</td><td style="text-align: right">0.001806</td><td style="text-align: right">0.4894</td><td style="text-align: right">0.0006739</td><td style="text-align: right">0.0002456</td><td style="text-align: right">0.0002783</td><td style="text-align: right">0.06801</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02806</td><td style="text-align: right">5.002e-05</td><td style="text-align: right">0.02137</td><td style="text-align: right">5.01e-05</td><td style="text-align: right">0.1216</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06404</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002986</td><td style="text-align: right">6.974e-05</td><td style="text-align: right">0.0006342</td><td style="text-align: right">0.0005059</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1171</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2622</td><td style="text-align: right">0.0005249</td><td style="text-align: right">0.2792</td><td style="text-align: right">0.001898</td></tr><tr><td style="text-align: right">ADM-6005a_4</td><td style="text-align: right">0.01925</td><td style="text-align: right">0.001807</td><td style="text-align: right">0.488</td><td style="text-align: right">0.0006739</td><td style="text-align: right">0</td><td style="text-align: right">0.01669</td><td style="text-align: right">0.06843</td><td style="text-align: right">0.0001479</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02801</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.02149</td><td style="text-align: right">5.019e-05</td><td style="text-align: right">0.1211</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003314</td><td style="text-align: right">6.985e-05</td><td style="text-align: right">0.001286</td><td style="text-align: right">0.0005073</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002729</td><td style="text-align: right">0.1219</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2635</td><td style="text-align: right">0.0005251</td><td style="text-align: right">0.2751</td><td style="text-align: right">0.0019</td></tr><tr><td style="text-align: right">ADM-6005a_5</td><td style="text-align: right">0.01979</td><td style="text-align: right">0.001807</td><td style="text-align: right">0.488</td><td style="text-align: right">0.0006736</td><td style="text-align: right">0</td><td style="text-align: right">0.01668</td><td style="text-align: right">0.06789</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02816</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.02133</td><td style="text-align: right">5.012e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001689</td><td style="text-align: right">0.06406</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002726</td><td style="text-align: right">6.967e-05</td><td style="text-align: right">0.001403</td><td style="text-align: right">0.000506</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002724</td><td style="text-align: right">0.1223</td><td style="text-align: right">0.001563</td><td style="text-align: right">0.2624</td><td style="text-align: right">0.000525</td><td style="text-align: right">0.2727</td><td style="text-align: right">0.001895</td></tr><tr><td style="text-align: right">ADM-6005a_6</td><td style="text-align: right">0.02261</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.4892</td><td style="text-align: right">0.0006731</td><td style="text-align: right">0</td><td style="text-align: right">0.01667</td><td style="text-align: right">0.06812</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1792</td><td style="text-align: right">0.0001769</td><td style="text-align: right">0.02815</td><td style="text-align: right">5.009e-05</td><td style="text-align: right">0.02143</td><td style="text-align: right">5.016e-05</td><td style="text-align: right">0.1209</td><td style="text-align: right">0.0001686</td><td style="text-align: right">0.06397</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0002285</td><td style="text-align: right">6.936e-05</td><td style="text-align: right">0.001213</td><td style="text-align: right">0.0005055</td><td style="text-align: right">0.1111</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1236</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2619</td><td style="text-align: right">0.000525</td><td style="text-align: right">0.2772</td><td style="text-align: right">0.001893</td></tr><tr><td style="text-align: right">ADM-6005a_7</td><td style="text-align: right">0.02161</td><td style="text-align: right">0.001812</td><td style="text-align: right">0.4897</td><td style="text-align: right">0.0006748</td><td style="text-align: right">0</td><td style="text-align: right">0.01668</td><td style="text-align: right">0.06787</td><td style="text-align: right">0.0001475</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02795</td><td style="text-align: right">5.003e-05</td><td style="text-align: right">0.02148</td><td style="text-align: right">5.012e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.0642</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0003133</td><td style="text-align: right">6.951e-05</td><td style="text-align: right">0</td><td style="text-align: right">0.02247</td><td style="text-align: right">0.1111</td><td style="text-align: right">0.0002731</td><td style="text-align: right">0.123</td><td style="text-align: right">0.001573</td><td style="text-align: right">0.2635</td><td style="text-align: right">0.0005264</td><td style="text-align: right">0.2719</td><td style="text-align: right">0.001894</td></tr><tr><td style="text-align: right">ADM-6005a_8</td><td style="text-align: right">0.01965</td><td style="text-align: right">0.001808</td><td style="text-align: right">0.4884</td><td style="text-align: right">0.0006735</td><td style="text-align: right">8.947e-05</td><td style="text-align: right">0.0002781</td><td style="text-align: right">0.06805</td><td style="text-align: right">0.0001477</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02809</td><td style="text-align: right">5.01e-05</td><td style="text-align: right">0.02154</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06411</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002939</td><td style="text-align: right">6.953e-05</td><td style="text-align: right">0.0003189</td><td style="text-align: right">0.0005084</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002722</td><td style="text-align: right">0.1239</td><td style="text-align: right">0.001571</td><td style="text-align: right">0.2639</td><td style="text-align: right">0.0005259</td><td style="text-align: right">0.2769</td><td style="text-align: right">0.001902</td></tr><tr><td style="text-align: right">ADM-6005a_9</td><td style="text-align: right">0.02078</td><td style="text-align: right">0.00181</td><td style="text-align: right">0.4885</td><td style="text-align: right">0.0006736</td><td style="text-align: right">0</td><td style="text-align: right">0.01669</td><td style="text-align: right">0.06835</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1792</td><td style="text-align: right">0.0001771</td><td style="text-align: right">0.02812</td><td style="text-align: right">5.007e-05</td><td style="text-align: right">0.02152</td><td style="text-align: right">5.016e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.000302</td><td style="text-align: right">6.967e-05</td><td style="text-align: right">0.001483</td><td style="text-align: right">0.0005078</td><td style="text-align: right">0.111</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1197</td><td style="text-align: right">0.001571</td><td style="text-align: right">0.2614</td><td style="text-align: right">0.0005256</td><td style="text-align: right">0.2755</td><td style="text-align: right">0.001894</td></tr><tr><td style="text-align: right">ADM-6005a_10</td><td style="text-align: right">0.02461</td><td style="text-align: right">0.001806</td><td style="text-align: right">0.4877</td><td style="text-align: right">0.0006734</td><td style="text-align: right">0.0001257</td><td style="text-align: right">0.000279</td><td style="text-align: right">0.06788</td><td style="text-align: right">0.0001477</td><td style="text-align: right">0.1798</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02814</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.02148</td><td style="text-align: right">5.016e-05</td><td style="text-align: right">0.1211</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06386</td><td style="text-align: right">0.0001031</td><td style="text-align: right">0.0001826</td><td style="text-align: right">6.964e-05</td><td style="text-align: right">0.001759</td><td style="text-align: right">0.0005073</td><td style="text-align: right">0.1117</td><td style="text-align: right">0.0002726</td><td style="text-align: right">0.126</td><td style="text-align: right">0.001572</td><td style="text-align: right">0.2627</td><td style="text-align: right">0.0005253</td><td style="text-align: right">0.2739</td><td style="text-align: right">0.001901</td></tr><tr><td style="text-align: right">ADM-6005a_11</td><td style="text-align: right">0.02009</td><td style="text-align: right">0.001805</td><td style="text-align: right">0.4883</td><td style="text-align: right">0.000674</td><td style="text-align: right">0.000226</td><td style="text-align: right">0.0002791</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02804</td><td style="text-align: right">5.005e-05</td><td style="text-align: right">0.02155</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06397</td><td style="text-align: right">0.0001031</td><td style="text-align: right">0.0004916</td><td style="text-align: right">6.947e-05</td><td style="text-align: right">0.0008535</td><td style="text-align: right">0.0005053</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.0002721</td><td style="text-align: right">0.1231</td><td style="text-align: right">0.001566</td><td style="text-align: right">0.2633</td><td style="text-align: right">0.0005256</td><td style="text-align: right">0.2706</td><td style="text-align: right">0.001889</td></tr><tr><td style="text-align: right">ADM-6005a_12</td><td style="text-align: right">0.02039</td><td style="text-align: right">0.001812</td><td style="text-align: right">0.4899</td><td style="text-align: right">0.0006749</td><td style="text-align: right">0</td><td style="text-align: right">0.01669</td><td style="text-align: right">0.06789</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.0001771</td><td style="text-align: right">0.02799</td><td style="text-align: right">5.006e-05</td><td style="text-align: right">0.02149</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1213</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06378</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003361</td><td style="text-align: right">6.939e-05</td><td style="text-align: right">0.001099</td><td style="text-align: right">0.0005068</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002729</td><td style="text-align: right">0.1182</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2624</td><td style="text-align: right">0.0005259</td><td style="text-align: right">0.2721</td><td style="text-align: right">0.001894</td></tr><tr><td style="text-align: right">ADM-6005a_13</td><td style="text-align: right">0.0167</td><td style="text-align: right">0.001813</td><td style="text-align: right">0.4893</td><td style="text-align: right">0.0006747</td><td style="text-align: right">0.0002034</td><td style="text-align: right">0.0002777</td><td style="text-align: right">0.06837</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1794</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02807</td><td style="text-align: right">5e-05</td><td style="text-align: right">0.02143</td><td style="text-align: right">5.018e-05</td><td style="text-align: right">0.1216</td><td style="text-align: right">0.0001687</td><td style="text-align: right">0.06395</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0003101</td><td style="text-align: right">6.96e-05</td><td style="text-align: right">0</td><td style="text-align: right">0.02247</td><td style="text-align: right">0.1113</td><td style="text-align: right">0.0002727</td><td style="text-align: right">0.126</td><td style="text-align: right">0.001568</td><td style="text-align: right">0.2632</td><td style="text-align: right">0.0005253</td><td style="text-align: right">0.2782</td><td style="text-align: right">0.001903</td></tr><tr><td style="text-align: right">ADM-6005a_14</td><td style="text-align: right">0.01852</td><td style="text-align: right">0.00181</td><td style="text-align: right">0.4895</td><td style="text-align: right">0.0006742</td><td style="text-align: right">0</td><td style="text-align: right">0.01666</td><td style="text-align: right">0.06805</td><td style="text-align: right">0.0001478</td><td style="text-align: right">0.1798</td><td style="text-align: right">0.000177</td><td style="text-align: right">0.02794</td><td style="text-align: right">5e-05</td><td style="text-align: right">0.02152</td><td style="text-align: right">5.013e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001689</td><td style="text-align: right">0.06388</td><td style="text-align: right">0.0001033</td><td style="text-align: right">0.0003892</td><td style="text-align: right">6.958e-05</td><td style="text-align: right">0.0008041</td><td style="text-align: right">0.0005066</td><td style="text-align: right">0.1112</td><td style="text-align: right">0.0002723</td><td style="text-align: right">0.1229</td><td style="text-align: right">0.001569</td><td style="text-align: right">0.2628</td><td style="text-align: right">0.0005251</td><td style="text-align: right">0.2751</td><td style="text-align: right">0.001893</td></tr><tr><td style="text-align: right">ADM-6005a_15</td><td style="text-align: right">0.01902</td><td style="text-align: right">0.001809</td><td style="text-align: right">0.4903</td><td style="text-align: right">0.0006741</td><td style="text-align: right">0</td><td style="text-align: right">0.01664</td><td style="text-align: right">0.06802</td><td style="text-align: right">0.0001476</td><td style="text-align: right">0.1799</td><td style="text-align: right">0.0001772</td><td style="text-align: right">0.02814</td><td style="text-align: right">5.01e-05</td><td style="text-align: right">0.02141</td><td style="text-align: right">5.016e-05</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.0001688</td><td style="text-align: right">0.06409</td><td style="text-align: right">0.0001032</td><td style="text-align: right">0.0002762</td><td style="text-align: right">6.947e-05</td><td style="text-align: right">0.00149</td><td style="text-align: right">0.0005059</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.0002725</td><td style="text-align: right">0.1225</td><td style="text-align: right">0.001569</td><td style="text-align: right">0.2632</td><td style="text-align: right">0.0005255</td><td style="text-align: right">0.2711</td><td style="text-align: right">0.001895</td></tr></table><p>Summary statistics.</p><table><tr><th style="text-align: right">variable</th><th style="text-align: right">mean</th><th style="text-align: right">std</th><th style="text-align: right">hetero</th><th style="text-align: right">min</th><th style="text-align: right">q25</th><th style="text-align: right">median</th><th style="text-align: right">q75</th><th style="text-align: right">max</th></tr><tr><td style="text-align: right">k[Ti L3-M1 + 11 others, Ti]</td><td style="text-align: right">0.02028</td><td style="text-align: right">0.001823</td><td style="text-align: right">1.008</td><td style="text-align: right">0.0167</td><td style="text-align: right">0.01943</td><td style="text-align: right">0.02009</td><td style="text-align: right">0.02091</td><td style="text-align: right">0.02461</td></tr><tr><td style="text-align: right">k[O K-L3 + 1 other, SiO2]</td><td style="text-align: right">0.4887</td><td style="text-align: right">0.001071</td><td style="text-align: right">1.589</td><td style="text-align: right">0.4863</td><td style="text-align: right">0.488</td><td style="text-align: right">0.4885</td><td style="text-align: right">0.4894</td><td style="text-align: right">0.4903</td></tr><tr><td style="text-align: right">k[Fe L3-M5 + 13 others, Fe]</td><td style="text-align: right">6.729e-05</td><td style="text-align: right">9.368e-05</td><td style="text-align: right">0.009261</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0</td><td style="text-align: right">0.0001225</td><td style="text-align: right">0.0002456</td></tr><tr><td style="text-align: right">k[Zn L3-M5 + 13 others, Zn]</td><td style="text-align: right">0.06806</td><td style="text-align: right">0.0001951</td><td style="text-align: right">1.321</td><td style="text-align: right">0.0678</td><td style="text-align: right">0.06789</td><td style="text-align: right">0.06802</td><td style="text-align: right">0.06813</td><td style="text-align: right">0.06843</td></tr><tr><td style="text-align: right">k[Ge L3-M5 + 14 others, Ge]</td><td style="text-align: right">0.1795</td><td style="text-align: right">0.0002331</td><td style="text-align: right">1.317</td><td style="text-align: right">0.1792</td><td style="text-align: right">0.1793</td><td style="text-align: right">0.1796</td><td style="text-align: right">0.1797</td><td style="text-align: right">0.1799</td></tr><tr><td style="text-align: right">k[Al K-L3 + 2 others, Al]</td><td style="text-align: right">0.02805</td><td style="text-align: right">7.814e-05</td><td style="text-align: right">1.561</td><td style="text-align: right">0.02794</td><td style="text-align: right">0.028</td><td style="text-align: right">0.02806</td><td style="text-align: right">0.02813</td><td style="text-align: right">0.02816</td></tr><tr><td style="text-align: right">k[Si K-L3 + 2 others, Si]</td><td style="text-align: right">0.02146</td><td style="text-align: right">6.204e-05</td><td style="text-align: right">1.237</td><td style="text-align: right">0.02133</td><td style="text-align: right">0.02143</td><td style="text-align: right">0.02148</td><td style="text-align: right">0.02151</td><td style="text-align: right">0.02155</td></tr><tr><td style="text-align: right">k[Ca K-L3 + 3 others, CaF2]</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.0002119</td><td style="text-align: right">1.255</td><td style="text-align: right">0.1209</td><td style="text-align: right">0.1213</td><td style="text-align: right">0.1214</td><td style="text-align: right">0.1215</td><td style="text-align: right">0.1216</td></tr><tr><td style="text-align: right">k[Ti K-L3 + 3 others, Ti]</td><td style="text-align: right">0.06401</td><td style="text-align: right">0.0001365</td><td style="text-align: right">1.322</td><td style="text-align: right">0.06378</td><td style="text-align: right">0.06394</td><td style="text-align: right">0.06402</td><td style="text-align: right">0.06408</td><td style="text-align: right">0.06433</td></tr><tr><td style="text-align: right">k[Fe K-L3 + 1 other, Fe]</td><td style="text-align: right">0.0003043</td><td style="text-align: right">7.438e-05</td><td style="text-align: right">1.069</td><td style="text-align: right">0.0001826</td><td style="text-align: right">0.0002744</td><td style="text-align: right">0.000302</td><td style="text-align: right">0.0003328</td><td style="text-align: right">0.0004916</td></tr><tr><td style="text-align: right">k[Fe K-M3 + 3 others, Fe]</td><td style="text-align: right">0.001002</td><td style="text-align: right">0.0005511</td><td style="text-align: right">0.1604</td><td style="text-align: right">0</td><td style="text-align: right">0.0007191</td><td style="text-align: right">0.001213</td><td style="text-align: right">0.001411</td><td style="text-align: right">0.001759</td></tr><tr><td style="text-align: right">k[Zn K-L3 + 1 other, Zn]</td><td style="text-align: right">0.1114</td><td style="text-align: right">0.0002374</td><td style="text-align: right">0.8712</td><td style="text-align: right">0.111</td><td style="text-align: right">0.1112</td><td style="text-align: right">0.1115</td><td style="text-align: right">0.1116</td><td style="text-align: right">0.1117</td></tr><tr><td style="text-align: right">k[Zn K-M3 + 3 others, Zn]</td><td style="text-align: right">0.1226</td><td style="text-align: right">0.00254</td><td style="text-align: right">1.619</td><td style="text-align: right">0.1171</td><td style="text-align: right">0.1221</td><td style="text-align: right">0.123</td><td style="text-align: right">0.124</td><td style="text-align: right">0.126</td></tr><tr><td style="text-align: right">k[Ge K-L3 + 1 other, Ge]</td><td style="text-align: right">0.2629</td><td style="text-align: right">0.0007433</td><td style="text-align: right">1.415</td><td style="text-align: right">0.2614</td><td style="text-align: right">0.2624</td><td style="text-align: right">0.2632</td><td style="text-align: right">0.2634</td><td style="text-align: right">0.264</td></tr><tr><td style="text-align: right">k[Ge K-M3 + 4 others, Ge]</td><td style="text-align: right">0.2744</td><td style="text-align: right">0.002936</td><td style="text-align: right">1.548</td><td style="text-align: right">0.2697</td><td style="text-align: right">0.272</td><td style="text-align: right">0.2751</td><td style="text-align: right">0.2768</td><td style="text-align: right">0.2792</td></tr></table><pre><code class="language-julia hljs">@btime fit_spectrum(unks[1], frs)</code></pre><pre><code class="nohighlight hljs">1.056 ms (2899 allocations: 843.64 KiB)
ADM-6005a_1</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../XRFspectra/">« Fitting XRF Spectra</a><a class="docs-footer-nextpage" href="../continuummodel/">Modeling the Continuum »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Thursday 30 December 2021 12:19">Thursday 30 December 2021</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
