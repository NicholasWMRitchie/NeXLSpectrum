<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectrum Methods · NeXLSpectrum.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
<script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js" type="text/javascript" defer="defer"></script>
<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
</head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">NeXLSpectrum.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Spectrum Methods</a><ul class="internal"><li><a class="tocitem" href="#Working-with-Spectrum-objects"><span>Working with Spectrum objects</span></a></li><li class="toplevel"><a class="tocitem" href="#Acccessing-Properties"><span>Acccessing Properties</span></a></li><li class="toplevel"><a class="tocitem" href="#Displaying-Spectrum-Data"><span>Displaying Spectrum Data</span></a></li><li class="toplevel"><a class="tocitem" href="#Energy-Scale-Functions"><span>Energy Scale Functions</span></a></li><li class="toplevel"><a class="tocitem" href="#Extracting-the-Counts-Data"><span>Extracting the Counts Data</span></a></li><li class="toplevel"><a class="tocitem" href="#Defining-Detectors"><span>Defining Detectors</span></a></li><li class="toplevel"><a class="tocitem" href="#Statistical-Sub-Sampling"><span>Statistical Sub-Sampling</span></a></li><li class="toplevel"><a class="tocitem" href="#Processing-Channel-Data"><span>Processing Channel Data</span></a></li><li class="toplevel"><a class="tocitem" href="#Miscellaneous-Functions"><span>Miscellaneous Functions</span></a></li></ul></li><li><a class="tocitem" href="../K412fit/">Fitting K412</a></li><li><a class="tocitem" href="../K412quick/">Fitting K412 (quick fit)</a></li><li><a class="tocitem" href="../XRFspectra/">Fitting XRF Spectra</a></li><li><a class="tocitem" href="../errorbars/">Lovely Error Bars</a></li><li><a class="tocitem" href="../continuummodel/">Modeling the Continuum</a></li><li><a class="tocitem" href="../methods/">Methods</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Spectrum Methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectrum Methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/master/docs/src/spectrum.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="![](NeXL_sm.png)Spectrum"><a class="docs-heading-anchor" href="#![](NeXL_sm.png)Spectrum"><img src="../NeXL_sm.png" alt/>Spectrum</a><a id="![](NeXL_sm.png)Spectrum-1"></a><a class="docs-heading-anchor-permalink" href="#![](NeXL_sm.png)Spectrum" title="Permalink"></a></h1><h2 id="Working-with-Spectrum-objects"><a class="docs-heading-anchor" href="#Working-with-Spectrum-objects">Working with Spectrum objects</a><a id="Working-with-Spectrum-objects-1"></a><a class="docs-heading-anchor-permalink" href="#Working-with-Spectrum-objects" title="Permalink"></a></h2><p>The <code>Spectrum</code> type represents a single spectrum with associated properties. The channel data is indexed like a <code>Vector</code>.  The property data is indexed using <code>Symbol</code> objects.  A set of spectrum properties are defined in the library and the user can create additional ones.</p><p>In addition to the <code>Vector</code>-like properties, the <code>Spectrum</code> associates energy bins with each channel.  The energy bins are continuous, non-overlapping and monotonic.  Functions like <code>energy(...)</code> maps channel index to energies and <code>channel(...)</code> to make energies to channel index.  </p><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.Spectrum" href="#NeXLSpectrum.Spectrum"><code>NeXLSpectrum.Spectrum</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Spectrum{T&lt;:Real} &lt;: AbstractVector{T}

Spectrum(energy::EnergyScale, data::Vector{&lt;:Real}, props::Dict{Symbol,Any})</code></pre><p>Construct a structure to hold spectrum data (energy scale, counts and metadata).</p><p>See <a href="../methods/#NeXLSpectrum.EnergyScale"><code>NeXLSpectrum.EnergyScale</code></a> or <a href="../methods/#NeXLSpectrum.LinearEnergyScale"><code>NeXLSpectrum.LinearEnergyScale</code></a></p><p>Example:</p><pre><code class="language-none">julia&gt; spec = Spectrum(LinearEnergyScale(0.0,10.0),
                 collect(1:1024),
                 Dict{Symbol,Any}(:BeamEnergy=&gt;10.0e3, :LiveTime=&gt;30.0))
                                                                              ** 1024.0
                                                                       *********
                                                               *****************
                                                        ************************
                                                 *******************************
                                          **************************************
                                   *********************************************
                            ****************************************************
                     ***********************************************************
              ******************************************************************
       *************************************************************************
******************************************************************************** 10.0 keV
Spectrum[3062][10.0 keV, Unknown, 525000.0 counts]</code></pre><p><code>Spectrum</code> implements indexing using various different mechanisms.  If <code>spec</code> is a <code>Spectrum</code> then</p><pre><code class="language-none">spec[123] # will return the number of counts in channel 123
spec[123:222] # will return a Vector of counts from channel 123:222
spec[134.] # will return the number of counts in the channel at energy 134.0 eV
spec[134.0:270.0] # will return a Vector of counts for channels with energies between 134.0 eV and 270.0 eV
spec[:Comment] # will return the property named :Comment</code></pre><p>Metadata is identified by a symbol. These Symbols are used within NeXLSpectrum.</p><pre><code class="language-none">:BeamEnergy    # In eV
:Elevation     # In radians
:TakeOffAngle  # In radians (Detector position)
:Azimuthal     # In radians (Detector position)
:WorkingDistance # In cm
:LiveTime      # In seconds
:RealTime      # In seconds
:ProbeCurrent  # In nano-amps
:Name          # A string
:Owner         # A string
:StagePosition # A Dict{Symbol,Real} with entries :X, :Y, :Z, :R, :T, B: in cm and degrees
:Comment       # A string
:Composition   # A Material (known composition, not measured)
:Elements      # A collection of elements in the material
:ReferenceROIS # A collection of reference ROIs (as Vector{ReferenceROI})
:Detector      # A Detector like a BasicEDS or another EDSDetector
:Filename      # Source filename
:Coating       # A Film or Film[] (eg. 10 nm of C|Au etc.)
:AcquisitionTime # Date and time of acquisition (DateTime struct)
:Signature     # Dict{Element,Real} with the &quot;particle signature&quot;</code></pre><p>Less common items:</p><pre><code class="language-none">:ImageMag	   # Magnification (assuming a 3.5&quot; image) of the first image
:ImageZoom     # Additional zoom for second image in a two image TIFF
:Operator      # Analyst in ASPEX TIFF files
:Image1, :Image2 ... # Images associated with the spectrum
:BrukerThroughtput # Nominal throughtput setting on a Bruker detector
:DetectorSerialNumber # EDS detector serial number
:DetectorModel # Vendor model name
:DetectorThickness # Thickness of detector active area
:DeadLayerThickness # Thickness of Si dead layer on the entrance surface of the detector
:Window        # Window construction details
:DetectorSolidAngle # Collection solid angle of the X-ray detector
:ChamberPressure # Vacuum presure in the sample chamber
:ChamberAtmosphere # Nominally the composition of the residual gas in the chamber</code></pre><p>XRF related items:</p><pre><code class="language-none">:BeamEnergy  # Accelarating voltage within X-ray tube (eV)
:XRFTubeAnode    # Element from which the X-ray tube is constructed
:ProbeCurrent  # Electron current in the X-ray tube
:XRFTubeIncidentAngle # Incident angle of electron beam in tube
:XRFTubeTakeOffAngle # Take-off angle from tube
:XRFExcitationAngle # Angle of incidence of the X-ray beam on the sample
:XRFDetectionAngle # Angle of the detector relative to the sample
:XRFExcitationPathLength # Distance from X-ray source to sample
:XRFDetectionPathLength # Distance from the sample to the X-ray detector
:XRFSampleTilt    #  Additional tilt of the sample
:XRFTubeWindow   # Construction of the tube window</code></pre><p>Not all spectra will define all properties.  Algorithms can define the <code>NeXLCore.minproperties(ty::Type)</code> method to specify which properties are required by an algorithm of <code>ty::Type</code>.  Then <code>hasminrequired</code> and <code>requiredbutmissing</code> methods will determine whether a <code>Spectrum</code> or <code>Dict{Symbol,Any}</code> is suitable for an algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L8-L100">source</a></section></article><h1 id="Acccessing-Properties"><a class="docs-heading-anchor" href="#Acccessing-Properties">Acccessing Properties</a><a id="Acccessing-Properties-1"></a><a class="docs-heading-anchor-permalink" href="#Acccessing-Properties" title="Permalink"></a></h1><p>Most properties are accessed using <code>spec[:Symbol]</code> notation.  Some combined or special properties have special methods.</p><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.dose" href="#NeXLSpectrum.dose"><code>NeXLSpectrum.dose</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">dose(spec::Spectrum, def=missing)
dose(spec::Spectrum)</code></pre><p>The probe dose in nano-amp seconds</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L265-L270">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLCore.elms-Tuple{Spectrum}" href="#NeXLCore.elms-Tuple{Spectrum}"><code>NeXLCore.elms</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">elms(spec::Spectrum, withcoating = false, def=missing)</code></pre><p>Returns a list of the elements associated with this spectrum. <code>withcoating</code> determines whether the coating elements are also added.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L244-L249">source</a></section></article><h1 id="Displaying-Spectrum-Data"><a class="docs-heading-anchor" href="#Displaying-Spectrum-Data">Displaying Spectrum Data</a><a id="Displaying-Spectrum-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Displaying-Spectrum-Data" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="NeXLUncertainties.asa" href="#NeXLUncertainties.asa"><code>NeXLUncertainties.asa</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">NeXLUncertainties.asa(::Type{DataFrame}, spec::Spectrum; properties::Bool = false)</code></pre><p>Converts the spectrum energy and counts data into a DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L189-L193">source</a></section><section><div><pre><code class="language-none">NeXLUncertainties.asa(::Type{DataFrame}, spec::AbstractVector{Spectrum})::DataFrame</code></pre><p>Returns a DataFrame that summarizes the list of spectra.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L595-L599">source</a></section><section><div><pre><code class="language-none">NeXLUncertainties.asa(::Type{DataFrame}, spec::AbstractDict{Element, Spectrum})::DataFrame</code></pre><p>Returns a DataFrame that summarizes a dictionary of standard spectra.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L626-L630">source</a></section><section><div><pre><code class="language-none">NeXLUncertainties.asa(::Type{DataFrame}, ffrs::AbstractVector{&lt;:FitResult}; charOnly = true, withUnc = false, pivot = false)</code></pre><p>Return generic <code>FitResult</code> as a DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/fitresult.jl#L62-L66">source</a></section><section><div><pre><code class="language-none">NeXLUncertainties.asa(::Type{DataFrame}, ffr::FilterFitResult)::DataFrame</code></pre><p>Tabulate details about each region-of-interest in the &#39;FilterFitResult&#39; in a &#39;DataFrame&#39;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/fitresult.jl#L172-L176">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.keys" href="#Base.keys"><code>Base.keys</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Base.keys(spec::Spectrum)</code></pre><p>Return the defined properties as a set of <code>Symbol</code>s.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L230-L234">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.haskey" href="#Base.haskey"><code>Base.haskey</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Base.haskey(spec::Spectrum, sym::Symbol)</code></pre><p>Is the specified key defined?</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L237-L241">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Gadfly.plot" href="#Gadfly.plot"><code>Gadfly.plot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">plot(
    specs::Union{Spectrum...,AbstractVector{Spectrum{&lt;:Real}}};
    klms=[],
    edges=[],
	escapes=[],
	coincidences=[],
    autoklms = false,
    xmin=0.0,
    xmax=missing,
    norm=:None,
    yscale=1.05,
    ytransform = identity,
	style=NeXLSpectrumStyle,
	palette=NeXLPalette
)::Plot</code></pre><p>Required:</p><pre><code class="language-none">specs::AbstractVector{Spectrum};</code></pre><p>Named:</p><pre><code class="language-none">klms = [ Element &amp;| CharXRay ]
edges = [ Element &amp;| AtomicSubShell ]
escapes = [ CharXRay ],
coincidences = [ CharXRay ]
autoklms = false # Add KLMs based on elements in spectra
xmin = 0.0 # Min energy (eV)
xmax = missing # Max energy (eV) (defaults to max(:BeamEnergy))
norm = NoScaling() | ScaleDoseWidth() | ScaleDose() | ScaleSum() | ScaleROISum() | ScalePeak() | (&lt;: SpectrumScaling)()
yscale = 1.05 # Fraction of max intensity for ymax over [max(lld,xmin):xmax]
ytransform = identity | log10 | sqrt | ??? # How to transform the counts data before plotting
style=NeXLSpectrumStyle (or another Gadfly.style)
palette = NeXLPalette | Colorant[ ... ] # Colors for spectra...
customlayers = Gadfly.Layer[] # Allows additional plot layers to be added</code></pre><p>Plot a multiple spectra on a single plot using Gadfly.</p><pre><code class="language-none">Gadfly.plot(
  ffr::FilterFitResult,
  roi::Union{Missing,UnitRange{Int}} = missing;
  palette = NeXLPalette,
  style = NeXLSpectrumStyle, xmax=missing)</code></pre><p>Plot the spectrum, residual and k-ratios using Gadfly.</p><pre><code class="language-none">Gadfly.plot(fr::FilteredReference)</code></pre><p>Plot a filtered reference spectrum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/gadflysupport.jl#L20-L70">source</a></section></article><h1 id="Energy-Scale-Functions"><a class="docs-heading-anchor" href="#Energy-Scale-Functions">Energy Scale Functions</a><a id="Energy-Scale-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-Scale-Functions" title="Permalink"></a></h1><p>These functions handle mapping channel index to energies and vice versa.</p><article class="docstring"><header><a class="docstring-binding" id="NeXLCore.energy" href="#NeXLCore.energy"><code>NeXLCore.energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">NeXLCore.energy(ch::Integer, sc::EnergyScale)
NeXLCore.energy(ch::Int, spec::Spectrum)
NeXLCore.energy(ch::Int, det::EDSDetector)</code></pre><p>Returns the energy (in eV) for the low energy side of the bin representing the ch-th channel.</p><p>Example:</p><pre><code class="language-none">les = LinearEnergyScale(3.0, 10.1)
energy(101,lsc) == 10.1*101 + 3.0
energy(101,lsc) - energy(100,lsc) == 10.1
pes = PolyEnergyScale([ 3.0, 10.1, 0.001])
energy(101,pes) ==  3.0 + 10.0*101 + 0.001*101^2</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/detector.jl#L53-L69">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.channel" href="#NeXLSpectrum.channel"><code>NeXLSpectrum.channel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">channel(eV::AbstractFloat, sc::EnergyScale)
channel(eV::Float64, spec::Spectrum)
channel(eV::Float64, det::EDSDetector)

Returns the integer index of the channel for the specified energy X-ray (in eV).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/detector.jl#L42-L48">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.rangeofenergies" href="#NeXLSpectrum.rangeofenergies"><code>NeXLSpectrum.rangeofenergies</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">rangeofenergies(spec::Spectrum, ch)</code></pre><p>Returns the low and high energy extremes for the channels <code>ch</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L145-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.channelwidth" href="#NeXLSpectrum.channelwidth"><code>NeXLSpectrum.channelwidth</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">channelwidth(ch::Int, spec::Spectrum)::Float64</code></pre><p>Returns the width of the <code>ch</code> channel in eV.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L286-L290">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.energyscale" href="#NeXLSpectrum.energyscale"><code>NeXLSpectrum.energyscale</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">energyscale(es::EnergyScale, channels)
energyscale(det::EDSDetector)</code></pre><p>Computes the energy associated with a range of channel indexes and returns it as an Array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/detector.jl#L106-L112">source</a></section><section><div><pre><code class="language-none">energyscale(spec::Spectrum)</code></pre><p>Returns an array with the bin-by-bin energies</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L413-L417">source</a></section></article><h1 id="Extracting-the-Counts-Data"><a class="docs-heading-anchor" href="#Extracting-the-Counts-Data">Extracting the Counts Data</a><a id="Extracting-the-Counts-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Extracting-the-Counts-Data" title="Permalink"></a></h1><p>The channel data in a <code>Spectrum</code> object <code>spec</code> can be get/set using standard <code>Array</code> indexing techniques.</p><pre><code class="language-none">&gt; spec[123]
&gt; spec[123:345]
&gt; spec[1234.0] # Channel containing energy 1234.0 eV
&gt; spec[123] = 99</code></pre><p>Alternatively, the <code>counts(...)</code> method can be used.</p><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.counts" href="#NeXLSpectrum.counts"><code>NeXLSpectrum.counts</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">counts(spec::Spectrum, numType::Type{T}, applyLLD=false)::Vector{T} where {T&lt;:Number}
counts(spec::Spectrum, channels::AbstractUnitRange{&lt;:Integer}, numType::Type{T}, applyLLD=false)::Vector{T} where {T&lt;:Number}</code></pre><p>Creates a copy of the spectrum counts data as the specified Number type. If the spectrum has a :Detector property then the detector&#39;s lld (low-level discriminator) and applyLLD=true then the lld is applied to the result by setting all channels less-than-or-equal to det.lld to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L295-L302">source</a></section></article><p><code>counts(...)</code> can apply the :LLD property to zero counts below a specified channel.</p><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.lld" href="#NeXLSpectrum.lld"><code>NeXLSpectrum.lld</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">lld(det::EDSDetector)</code></pre><p>Low level detection limit in channels.  Channels at or below this value will be zeroed when the lld is applied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/detector.jl#L283-L287">source</a></section><section><div><pre><code class="language-none">lld(spec::Spectrum)</code></pre><p>Gets the low-level discriminator associated with this spectrum if there is one.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L325-L329">source</a></section></article><h1 id="Defining-Detectors"><a class="docs-heading-anchor" href="#Defining-Detectors">Defining Detectors</a><a id="Defining-Detectors-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-Detectors" title="Permalink"></a></h1><p>Build a detector to match the data in a <code>Spectrum</code>.</p><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.simpleEDS" href="#NeXLSpectrum.simpleEDS"><code>NeXLSpectrum.simpleEDS</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">simpleEDS(chCount::Integer, width::Float64, offset::Float64, fwhmatmnka::Float64, lld::Int = channel(150.0 eV))</code></pre><p>Construct simple model of an EDS detector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/detector.jl#L440-L444">source</a></section><section><div><pre><code class="language-none">simpleEDS(spec::Spectrum, fwhmatmnka::Float64)</code></pre><p>Build a <code>EDSDetector</code> object for this spectrum with the specified FWHM at Mn Kα.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L420-L424">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.matching" href="#NeXLSpectrum.matching"><code>NeXLSpectrum.matching</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">matching(spec::Spectrum, resMnKa::Float64, lld::Int=1)::BasicEDS</code></pre><p>Build an EDSDetector to match the channel count and energy scale in this spectrum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L215-L219">source</a></section></article><h1 id="Statistical-Sub-Sampling"><a class="docs-heading-anchor" href="#Statistical-Sub-Sampling">Statistical Sub-Sampling</a><a id="Statistical-Sub-Sampling-1"></a><a class="docs-heading-anchor-permalink" href="#Statistical-Sub-Sampling" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.subdivide" href="#NeXLSpectrum.subdivide"><code>NeXLSpectrum.subdivide</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">subdivide(spec::Spectrum, n::Int)::Vector{Spectrum}</code></pre><p>Splits the event data in one spectrum into n spectra by assigning each event to a pseudo-random choice of one of the n result spectra.  Produces n spectra that act as though the original spectrum was collected in n time intervals of LiveTime/n.  This is quite slow because it needs to call rand() for each count in the spectrum (not just each channel).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L452-L460">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.subsample" href="#NeXLSpectrum.subsample"><code>NeXLSpectrum.subsample</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">subsample(spec::Spectrum, frac::Float64)</code></pre><p>Subsample the counts data in a spectrum according to a statistically valid algorithm.  Returns <code>spec</code> if frac&gt;=1.0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L428-L433">source</a></section></article><h1 id="Processing-Channel-Data"><a class="docs-heading-anchor" href="#Processing-Channel-Data">Processing Channel Data</a><a id="Processing-Channel-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Processing-Channel-Data" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.kratio" href="#NeXLSpectrum.kratio"><code>NeXLSpectrum.kratio</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">kratio(unk::Spectrum, std::Spectrum, back1::AbstractUnitRange{&lt;:Integer}, peak::AbstractUnitRange{&lt;:Integer}, back2::AbstractUnitRange{&lt;:Integer})::UncertainValue
kratio(unk::Spectrum, std::Spectrum, back1::StepRangeLen{Float64}, peak::StepRangeLen{Float64}, back2::StepRangeLen{Float64})::UncertainValue</code></pre><p>The k-ratio of unk relative to std corrected for dose.  Requires that <code>unk</code> and <code>std</code> have the properties <code>:LiveTime</code> and <code>:ProbeCurrent</code> defined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L393-L399">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.integrate" href="#NeXLSpectrum.integrate"><code>NeXLSpectrum.integrate</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">integrate(spec::Spectrum, channels::AbstractUnitRange{&lt;:Integer})
integrate(spec::Spectrum, energyRange::StepRangeLen{Float64})</code></pre><p>Sums all the counts in the specified channels.  No background correction.</p><pre><code class="language-none">integrate(spec::Spectrum, back1::AbstractUnitRange{&lt;:Integer}, peak::AbstractUnitRange{&lt;:Integer}, back2::AbstractUnitRange{&lt;:Integer})::UncertainValue
integrate(spec::Spectrum, back1::StepRangeLen{Float64}, peak::StepRangeLen{Float64}, back2::StepRangeLen{Float64})::UncertainValue</code></pre><p>Sums all the counts in the specified channels with background correction using the background intervals.</p><pre><code class="language-none">integrate(spec::Spectrum)</code></pre><p>Total integral of all counts from the LLD to the beam energy</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L348-L363">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.estimatebackground" href="#NeXLSpectrum.estimatebackground"><code>NeXLSpectrum.estimatebackground</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">estimatebackground(data::AbstractArray{Float64}, channel::Int, width::Int=5, order::Int=2)</code></pre><p>Returns the tangent to the a quadratic fit to the counts data centered at channel with width</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L484-L488">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.modelBackground" href="#NeXLSpectrum.modelBackground"><code>NeXLSpectrum.modelBackground</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">modelBackground(spec::Spectrum, chs::AbstractUnitRange{&lt;:Integer}, ash::AtomicSubShell)</code></pre><p>spec: A spectrum containing a peak centered on chs chs:  A range of channels containing a peak ash:  The edge (as an AtomicSubShell)</p><p>A simple model for modeling the background under a characteristic x-ray peak. The model fits a line to low and high energy background regions around firsr(chs) and last(chs). If the low energy line extended out to the edge energy is larger than the high energy line at the same energy, then a negative going edge is fit between the two. Otherwise a line is fit between the low energy side and the high energy side. This model only works when there are no peak interference over the range chs.</p><pre><code class="language-none">modelBackground(spec::Spectrum, chs::AbstractUnitRange{&lt;:Integer})
modelBackground(spec::Spectrum, chs::AbstractUnitRange{&lt;:Integer}, ash::AtomicSubShell)</code></pre><p><code>spec</code>: A spectrum containing a peak centered on chs <code>chs</code>:  A range of channels containing a peak <code>ash</code>:  The largest edge within the range of channels <code>chs</code> associated with the characteristic peak</p><p>A simple model for modeling the background under a characteristic x-ray peak. The model fits a line between the  low and high energy background regions around first(chs) and last(chs). This model only works when there are no peak interference over the range chs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L499-L524">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.extractcharacteristic" href="#NeXLSpectrum.extractcharacteristic"><code>NeXLSpectrum.extractcharacteristic</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">extractcharacteristic(spec::Spectrum, lowBack::AbstractUnitRange{&lt;:Integer}, highBack::AbstractUnitRange{&lt;:Integer})::Vector{Float64}</code></pre><p>Extract the characteristic intensity for the peak located within chs with an edge at ash.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L551-L555">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.peak" href="#NeXLSpectrum.peak"><code>NeXLSpectrum.peak</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">peak(spec::Spectrum, chs::AbstractUnitRange{&lt;:Integer}, ash::AtomicSubShell)::Float64</code></pre><p>Estimates the peak intensity for the characteristic X-ray in the specified range of channels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L561-L565">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.background" href="#NeXLSpectrum.background"><code>NeXLSpectrum.background</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">background(spec::Spectrum, chs::AbstractUnitRange{&lt;:Integer}, ash::AtomicSubShell)::Float64</code></pre><p>Estimates the background intensity for the characteristic X-ray in the specified range of channels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L568-L572">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.peaktobackground" href="#NeXLSpectrum.peaktobackground"><code>NeXLSpectrum.peaktobackground</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">peaktobackground(spec::Spectrum, chs::AbstractUnitRange{&lt;:Integer}, ash::AtomicSubShell)::Float64</code></pre><p>Estimates the peak-to-background ratio for the characteristic X-ray intensity in the specified range of channels which encompass the specified AtomicSubShell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L576-L581">source</a></section><section><div><pre><code class="language-none">peaktobackground(ffr::FilterFitResult, backwidth::Float64=10.0)::Float64</code></pre><p>The peak-to-background ratio as determined from the raw and residual spectra integrated over the fit region-of-interest and scaled to <code>backwidth</code> eV of continuum (nominally 10 eV).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/fitresult.jl#L159-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.estkratio" href="#NeXLSpectrum.estkratio"><code>NeXLSpectrum.estkratio</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">estkratio(unk::Spectrum, std::Spectrum, chs::AbstractUnitRange{&lt;:Integer})</code></pre><p>Estimates the k-ratio from niave models of peak and background intensity.  Only works if the peak is not interfered.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L587-L591">source</a></section></article><h1 id="Miscellaneous-Functions"><a class="docs-heading-anchor" href="#Miscellaneous-Functions">Miscellaneous Functions</a><a id="Miscellaneous-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Miscellaneous-Functions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.details" href="#NeXLSpectrum.details"><code>NeXLSpectrum.details</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">details(io, spec::Spectrum)
details(spec::Spectrum)</code></pre><p>Outputs a description of the data in the spectrum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L665-L670">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.commonproperties" href="#NeXLSpectrum.commonproperties"><code>NeXLSpectrum.commonproperties</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">commonproperties(specs::AbstractArray{Spectrum})
commonproperties(props1::Dict{Symbol,Any}, props2::Dict{Symbol,Any})</code></pre><p>Return the properties that are held in common by all the spectra.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L719-L724">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="NeXLSpectrum.maxspectrum" href="#NeXLSpectrum.maxspectrum"><code>NeXLSpectrum.maxspectrum</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">maxspectrum(specs::AbstractArray{Spectrum{T}})::Spectrum{T} where T&lt;:Real</code></pre><p>Compute the max-pixel spectrum for the specified spectra.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L743-L747">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.findmax" href="#Base.findmax"><code>Base.findmax</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">Base.findmax(spec::Spectrum, chs::AbstractRange{&lt;:Integer})
Base.findmax(spec::Spectrum)</code></pre><p>Returns the (maximum intensity, channel index) over the specified range of channels</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/usnistgov/NeXLSpectrum.jl/blob/76444fc60730f802afc0aa7caeebccb616256027/src/spectrum.jl#L332-L337">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../K412fit/">Fitting K412 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 28 July 2020 14:59">Tuesday 28 July 2020</span>. Using Julia version 1.5.0-rc2.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
